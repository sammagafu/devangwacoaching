import{d as M,y as R,b4 as q,r as T,c as F,o as f,X as P,w as c,b as s,a as e,t as m,g as E,f as l,c0 as oe,aJ as ae,aK as le,V as J,W as A,bE as ce,h as j,O as Y,i as k,bA as re,U as H,J as L,$ as O,m as I,F as N,H as W,q as S,E as X,c1 as ie,c2 as de,L as ue,A as V,Y as me,D,e as _e,n as C}from"./index-N9CDaHOP.js";/* empty css                    */import{_ as be}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CRgGAbI0.js";import{s as z,ap as fe,c as pe,av as G,aw as K,f as he,Z as ve,_ as ge,V as we,N as ye}from"./index-DdoyQ2gK.js";import"./DropDown.vue_vue_type_script_setup_true_lang-CvqxUwdC.js";import"./ProfileDropdown.vue_vue_type_script_setup_true_lang-MiOOsD2a.js";import"./change-casing-BoyW-fpY.js";import"./01-DeMBLNXD.js";import"./MobileNavbarToggler-Bj1WYEMd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./MenuItemWithChildren.vue_vue_type_script_setup_true_lang-9IhJN-Gy.js";import"./menu-items-1Og9OzUr.js";import"./index-DwNiKAmd.js";import"./logo-light-sT18Thxh.js";import"./08-DzHvQlEd.js";import"./02-u1oGLGhS.js";import"./05-BauEG9gJ.js";import"./03-6nKUgUxe.js";const ke={class:"d-sm-flex align-items-center"},$e={class:"ms-0 ms-sm-2 mt-2 mt-sm-0"},xe={class:"mb-0"},Ue={href:"#"},Ce={class:"text-body small"},Se={class:"dropdown text-end"},Be=["id"],Ee=["aria-labelledby"],Le={class:"d-flex justify-content-between align-items-center mb-3"},De={class:"d-flex align-items-center"},Fe={class:"icon-md bg-success bg-opacity-10 text-success rounded-circle flex-shrink-0 flex-centered"},je=e("h6",{class:"mb-0 ms-2 fw-light"},"Role",-1),Me={class:"mb-0 fw-bold"},Ve={class:"d-flex justify-content-between align-items-center mb-3"},Re={class:"d-flex align-items-center"},Te={class:"icon-md bg-purple bg-opacity-10 text-purple rounded-circle flex-shrink-0"},Ie=e("h6",{class:"mb-0 ms-2 fw-light"},"Status",-1),Ne={class:"mb-0 fw-bold"},qe={class:"overflow-hidden"},Pe=e("h6",{class:"mb-0"},"Courses Enrolled",-1),Je={class:"text-body small"},Ae={class:"d-sm-flex justify-content-between align-items-center"},Ye={class:"mb-2 mb-sm-0 icons-center"},He=e("span",{class:"text-body me-1"},"Join at:",-1),Oe={class:"text-end text-primary-hover"},We=M({__name:"StudentCard",props:{item:{type:Object,required:!0}},setup(o){const d=R.useToast(),p=q(),_=a=>a.is_superuser?"Admin":a.is_staff?"Staff":"Student",$=a=>{p.push({name:"admin.user.edit",params:{id:a}})},r=async a=>{if(confirm("Are you sure you want to delete this user?"))try{await L.delete(`auth/users/${a}/`),d.success("User deleted successfully!"),defineEmits(["user-deleted"])("user-deleted",a)}catch(t){console.error("Failed to delete user:",t),d.error("Failed to delete user")}},h=a=>{d.info(`Messaging user ${a} (Not implemented)`)},x=async(a,t)=>{try{await L.patch(`auth/users/${a}/`,{is_active:!t}),d.success(`User ${t?"blocked":"unblocked"} successfully!`),defineEmits(["user-updated"])("user-updated",{userId:a,is_active:!t})}catch(u){console.error(`Failed to ${t?"block":"unblock"} user:`,u),d.error(`Failed to ${t?"block":"unblock"} user`)}},w=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return(a,t)=>{const u=T("font-awesome-icon"),v=J,U=A,i=H,n=P,b=Y;return f(),F(n,{"no-body":"",class:"bg-transparent border h-100"},{default:c(()=>[s(v,{class:"bg-transparent border-bottom d-flex justify-content-between"},{default:c(()=>[e("div",ke,[e("div",$e,[e("h5",xe,[e("a",Ue,m(o.item.full_name||o.item.email),1)]),e("span",Ce,[s(u,{icon:l(z),class:"fa-fw mt-1"},null,8,["icon"]),E(" "+m(o.item.location||"Unknown"),1)])])]),e("div",Se,[e("a",{href:"#",class:"btn btn-sm btn-light btn-round small mb-0",role:"button",id:`dropdownShare${o.item.id}`,"data-bs-toggle":"dropdown","aria-expanded":"false"},[s(l(oe),{class:"fa-fw"})],8,Be),e("ul",{class:"dropdown-menu dropdown-w-sm dropdown-menu-end min-w-auto shadow rounded","aria-labelledby":`dropdownShare${o.item.id}`},[e("li",null,[e("a",{class:"dropdown-item icons-center",onClick:t[0]||(t[0]=g=>$(o.item.id))},[s(l(ae),{class:"fa-fw me-2"}),E("Edit ")])]),e("li",null,[e("a",{class:"dropdown-item icons-center",onClick:t[1]||(t[1]=g=>r(o.item.id))},[s(l(le),{class:"fa-fw me-2"}),E("Remove ")])])],8,Ee)])]),_:1}),s(U,null,{default:c(()=>[e("div",Le,[e("div",De,[e("div",Fe,[s(u,{icon:l(fe),class:"fa-fw"},null,8,["icon"])]),je]),e("span",Me,m(_(o.item)),1)]),e("div",Ve,[e("div",Re,[e("div",Te,[s(u,{icon:l(pe),class:"fa-fw"},null,8,["icon"])]),Ie]),e("span",Ne,m(o.item.is_active?"Active":"Inactive"),1)]),e("div",qe,[Pe,e("span",Je,m(o.item.enrolled_courses||0),1)])]),_:1}),s(i,{class:"bg-transparent border-top"},{default:c(()=>[e("div",Ae,[e("h6",Ye,[s(l(ce),{class:"fa-fw text-orange me-2"}),He,E(" "+m(w(o.item.date_joined)),1)]),e("div",Oe,[j((f(),k("a",{href:"#",class:"btn btn-link text-body p-0 mb-0 me-2 icons-center",onClick:t[2]||(t[2]=g=>h(o.item.id))},[s(l(re))])),[[b,"Message",void 0,{hover:!0,top:!0}]]),j((f(),k("a",{href:"#",class:"btn btn-link text-body p-0 mb-0",onClick:t[3]||(t[3]=g=>x(o.item.id,o.item.is_active))},[s(u,{icon:o.item.is_active?l(G):l(K)},null,8,["icon"])])),[[b,o.item.is_active?"Block":"Unblock",void 0,{hover:!0,top:!0}]])])])]),_:1})]),_:1})}}}),Xe=M({__name:"StudentGrid",props:{usersList:{type:Array,required:!0}},emits:["user-deleted","user-updated"],setup(o){const d=_=>{defineEmits(["user-deleted"])("user-deleted",_)},p=_=>{defineEmits(["user-updated"])("user-updated",_)};return(_,$)=>{const r=W,h=O;return f(),F(h,{class:"g-4"},{default:c(()=>[(f(!0),k(N,null,I(o.usersList,(x,w)=>(f(),F(r,{md:"6",xxl:"4",key:w},{default:c(()=>[s(We,{item:x,onUserDeleted:d,onUserUpdated:p},null,8,["item"])]),_:2},1024))),128))]),_:1})}}}),ze={class:"table-responsive border-0 mb-0"},Ge={class:"table table-dark-gray align-middle p-4 mb-0 table-hover"},Ke=e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"border-0 rounded-start"},"User"),e("th",{scope:"col",class:"border-0"},"Join Date"),e("th",{scope:"col",class:"border-0"},"Role"),e("th",{scope:"col",class:"border-0"},"Status"),e("th",{scope:"col",class:"border-0"},"Courses Enrolled"),e("th",{scope:"col",class:"border-0 rounded-end"},"Action")])],-1),Qe={class:"d-flex align-items-center position-relative"},Ze={class:"mb-0 ms-3"},et={class:"mb-0"},tt={href:"#",class:"stretched-link"},st={class:"text-body small"},nt=["onClick"],ot=["onClick"],at=M({__name:"StudentList",setup(o){const d=R.useToast(),p=q(),_=S([]);X(async()=>{await $()});const $=async()=>{try{const t=await L.get("auth/users/");_.value=t.data,d.success("Users loaded successfully!")}catch(t){console.error("Failed to fetch users:",t),d.error("Failed to fetch users")}},r=t=>t.is_superuser?"Admin":t.is_staff?"Staff":"Student",h=t=>{p.push({name:"admin.user.detail",params:{id:t}})},x=t=>{d.info(`Messaging user ${t} (Not implemented)`)},w=async(t,u)=>{try{await L.patch(`auth/users/${t}/`,{is_active:!u});const v=_.value.find(U=>U.id===t);v&&(v.is_active=!u),d.success(`User ${u?"blocked":"unblocked"} successfully!`),defineEmits(["user-updated"])("user-updated",{userId:t,is_active:!u})}catch(v){console.error(`Failed to ${u?"block":"unblock"} user:`,v),d.error(`Failed to ${u?"block":"unblock"} user`)}},a=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return(t,u)=>{const v=T("font-awesome-icon"),U=ue,i=Y;return f(),k("div",ze,[e("table",Ge,[Ke,e("tbody",null,[(f(!0),k(N,null,I(_.value,(n,b)=>(f(),k("tr",{key:b},[e("td",null,[e("div",Qe,[e("div",Ze,[e("h6",et,[e("a",tt,m(n.full_name||n.email),1)]),e("span",st,[s(v,{icon:l(z),class:"fa-fw mt-1"},null,8,["icon"]),E(" "+m(n.location||"Unknown"),1)])])])]),e("td",null,m(a(n.date_joined)),1),e("td",null,m(r(n)),1),e("td",null,m(n.is_active?"Active":"Inactive"),1),e("td",null,m(n.enrolled_courses||0),1),e("td",null,[j((f(),k("a",{href:"#",class:"btn btn-light btn-round me-2 mb-1 mb-md-0",onClick:g=>h(n.id)},[s(l(ie))],8,nt)),[[i,"View",void 0,{hover:!0,top:!0}]]),j((f(),k("a",{href:"#",class:"btn btn-light btn-round me-2 mb-1 mb-md-0",onClick:g=>x(n.id)},[s(l(de))],8,ot)),[[i,"Message",void 0,{hover:!0,top:!0}]]),s(U,{variant:"light",class:"btn-round mb-0","v-b-tooltip":n.is_active?"Block":"Unblock",onClick:g=>w(n.id,n.is_active)},{default:c(()=>[s(v,{icon:n.is_active?l(G):l(K)},null,8,["icon"])]),_:2},1032,["v-b-tooltip","onClick"])])]))),128))])])])}}}),lt=e("h1",{class:"h3 mb-2 mb-sm-0"},"Students",-1),ct={class:"bg-transparent p-2 position-absolute top-50 end-0 translate-middle-y border-0 text-primary-hover text-reset",type:"submit"},rt={class:"list-inline mb-0 nav nav-pills nav-pill-dark-soft border-0 justify-content-end",id:"pills-tab",role:"tablist"},it={class:"nav-item"},dt={class:"nav-item"},ut={class:"tab-content"},mt={class:"d-sm-flex justify-content-sm-between align-items-sm-center"},_t={class:"mb-0 text-center text-sm-start"},bt={class:"d-flex justify-content-center mb-0","aria-label":"navigation"},ft={class:"pagination pagination-sm pagination-primary-soft mb-0 pb-0 px-0"},pt=["onClick"],Rt=M({__name:"index",setup(o){const d=R.useToast(),p=S(!1),_=S([]),$=S(""),r=S(1),h=S(8),x=async()=>{try{const i=await L.get("auth/users/");_.value=i.data,d.success("Users loaded successfully!")}catch(i){console.error("Failed to fetch users:",i),d.error("Failed to fetch users")}},w=V(()=>{if(!$.value)return _.value;const i=$.value.toLowerCase();return _.value.filter(n=>{var b;return((b=n.full_name)==null?void 0:b.toLowerCase().includes(i))||n.email.toLowerCase().includes(i)})}),a=V(()=>Math.ceil(w.value.length/h.value)),t=V(()=>{const i=(r.value-1)*h.value,n=i+h.value;return w.value.slice(i,n)}),u=()=>{r.value=1},v=()=>{r.value=1},U=({userId:i,is_active:n})=>{const b=_.value.find(g=>g.id===i);b&&(b.is_active=n)};return X(()=>{x()}),(i,n)=>{const b=W,g=O,Q=_e,B=T("font-awesome-icon"),Z=me,ee=J,te=A,se=H,ne=P;return f(),F(be,null,{default:c(()=>[s(g,null,{default:c(()=>[s(b,{cols:"12"},{default:c(()=>[lt]),_:1})]),_:1}),s(ne,{"no-body":"",class:"bg-transparent"},{default:c(()=>[s(ee,{class:"bg-transparent border-bottom px-0"},{default:c(()=>[s(g,{class:"g-3 align-items-center justify-content-between"},{default:c(()=>[s(b,{md:"8"},{default:c(()=>[s(Z,{class:"rounded position-relative",onSubmit:D(u,["prevent"])},{default:c(()=>[s(Q,{class:"bg-transparent",type:"search",placeholder:"Search by name or email",modelValue:$.value,"onUpdate:modelValue":n[0]||(n[0]=y=>$.value=y),onInput:v},null,8,["modelValue"]),e("button",ct,[s(B,{icon:l(he),class:"fs-6"},null,8,["icon"])])]),_:1})]),_:1}),s(b,{md:"3"},{default:c(()=>[e("ul",rt,[e("li",it,[e("a",{href:"#nav-preview-tab-1",class:C(["nav-link mb-0 me-2",!p.value&&"active"]),"data-bs-toggle":"tab",onClick:n[1]||(n[1]=y=>p.value=!1)},[s(B,{icon:l(ve),class:"fa-fw"},null,8,["icon"])],2)]),e("li",dt,[e("a",{href:"#nav-html-tab-1",class:C(["nav-link mb-0",p.value&&"active"]),"data-bs-toggle":"tab",onClick:n[2]||(n[2]=y=>p.value=!0)},[s(B,{icon:l(ge),class:"fa-fw"},null,8,["icon"])],2)])])]),_:1})]),_:1})]),_:1}),s(te,{class:"px-0"},{default:c(()=>[e("div",ut,[e("div",{class:C(["tab-pane fade",!p.value&&"show active"]),id:"nav-preview-tab-1"},[s(Xe,{"users-list":t.value,onUserDeleted:x,onUserUpdated:U},null,8,["users-list"])],2),e("div",{class:C(["tab-pane fade",p.value&&"show active"]),id:"nav-html-tab-1"},[s(at,{onUserUpdated:U})],2)])]),_:1}),s(se,{class:"bg-transparent pt-0 px-0"},{default:c(()=>[e("div",mt,[e("p",_t," Showing "+m((r.value-1)*h.value+1)+" to "+m(Math.min(r.value*h.value,w.value.length))+" of "+m(w.value.length)+" entries ",1),e("nav",bt,[e("ul",ft,[e("li",{class:C(["page-item mb-0",{disabled:r.value===1}])},[e("a",{class:"page-link",href:"#",onClick:n[3]||(n[3]=D(y=>r.value--,["prevent"])),tabindex:"-1"},[s(B,{icon:l(we)},null,8,["icon"])])],2),(f(!0),k(N,null,I(a.value,y=>(f(),k("li",{class:C(["page-item mb-0",{active:y===r.value}]),key:y},[e("a",{class:"page-link",href:"#",onClick:D(ht=>r.value=y,["prevent"])},m(y),9,pt)],2))),128)),e("li",{class:C(["page-item mb-0",{disabled:r.value===a.value}])},[e("a",{class:"page-link",href:"#",onClick:n[4]||(n[4]=D(y=>r.value++,["prevent"]))},[s(B,{icon:l(ye)},null,8,["icon"])])],2)])])])]),_:1})]),_:1})]),_:1})}}});export{Rt as default};
