import{b4 as M,i as V,o as _,a as e,F as B,m as P,t as b,c as w,x as S,b as t,w as s,g as h,L as U,H as Y,X as G,V as I,W as O,U as R,$ as W,y as X,q as f,ar as re,e as Q,at as ie,D as z,Y as Z,J as N,A as D,E as ce,r as ue,f as q,n as $,aE as de}from"./index-N9CDaHOP.js";/* empty css                    */import{_ as me}from"./StudentLayout.vue_vue_type_script_setup_true_lang-nICzxTwo.js";import{f as pe,_ as _e,Z as ve,V as fe,N as be}from"./index-DdoyQ2gK.js";import"./menu-items-1Og9OzUr.js";import"./index-DwNiKAmd.js";import"./TopBar8.vue_vue_type_script_setup_true_lang-CjTKH_W-.js";import"./StickyHeader.vue_vue_type_script_setup_true_lang-CZa3rg2A.js";import"./ProfileDropdown.vue_vue_type_script_setup_true_lang-MiOOsD2a.js";import"./DropDown.vue_vue_type_script_setup_true_lang-CvqxUwdC.js";import"./change-casing-BoyW-fpY.js";import"./01-DeMBLNXD.js";import"./ShopCart.vue_vue_type_script_setup_true_lang-CqdS6fSh.js";import"./ChoicesSelect.vue_vue_type_script_setup_true_lang-DiCDSqEv.js";import"./02-CA1hCPq5.js";import"./04-D66rD-0h.js";import"./AdvanceMenu.vue_vue_type_script_setup_true_lang-CDVthnuR.js";import"./constants-DJzGRNcz.js";import"./index.vue_vue_type_script_setup_true_lang-Dq_y5vYq.js";import"./LogoBox.vue_vue_type_script_setup_true_lang-wpPX1rPk.js";import"./MobileNavbarToggler-Bj1WYEMd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./menu-C3R5rgoV.js";import"./Footer7.vue_vue_type_script_setup_true_lang-c4vRZI93.js";import"./index-DLdkP7uh.js";import"./logo-light-sT18Thxh.js";import"./04-DIykCGoU.js";import"./09-BzxBVZmI.js";const ge={class:"table-responsive border-0 mb-0"},he={class:"table table-dark-gray align-middle p-4 mb-0 table-hover"},ye=e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"border-0 rounded-start"},"Name"),e("th",{scope:"col",class:"border-0"},"Description"),e("th",{scope:"col",class:"border-0"},"Followers"),e("th",{scope:"col",class:"border-0"},"Threads"),e("th",{scope:"col",class:"border-0 rounded-end"},"Actions")])],-1),Ce={__name:"CategoryTable",props:{categories:{type:Array,required:!0},user:{type:Object,default:null}},emits:["join","leave"],setup(g){const d=g;M();const m=o=>!o.followers||!d.user?!1:o.followers.some(p=>p.user.id===d.user.id);return(o,p)=>{const u=U;return _(),V("div",ge,[e("table",he,[ye,e("tbody",null,[(_(!0),V(B,null,P(g.categories,a=>(_(),V("tr",{key:a.id},[e("td",null,b(a.name),1),e("td",null,b(a.description),1),e("td",null,b(a.follower_count),1),e("td",null,b(a.threads.length),1),e("td",null,[g.user&&!m(a)?(_(),w(u,{key:0,variant:"outline-primary",size:"sm",onClick:i=>o.$emit("join",a.slug)},{default:s(()=>[h(" Join ")]),_:2},1032,["onClick"])):S("",!0),g.user&&m(a)?(_(),w(u,{key:1,variant:"outline-danger",size:"sm",onClick:i=>o.$emit("leave",a.slug)},{default:s(()=>[h(" Leave ")]),_:2},1032,["onClick"])):S("",!0),t(u,{variant:"primary",size:"sm",class:"ms-2",onClick:i=>o.$router.push({name:"student.community.threads",params:{slug:a.slug}})},{default:s(()=>[h(" View Threads ")]),_:2},1032,["onClick"])])]))),128))])])])}}},we={class:"mb-0"},ke=e("strong",null,"Followers:",-1),$e=e("br",null,null,-1),Ve=e("strong",null,"Threads:",-1),xe={__name:"CategoryGrid",props:{categories:{type:Array,required:!0},user:{type:Object,default:null}},emits:["join","leave"],setup(g){const d=g;M();const m=o=>!o.followers||!d.user?!1:o.followers.some(p=>p.user.id===d.user.id);return(o,p)=>{const u=I,a=O,i=U,k=R,C=G,x=Y,c=W;return _(),w(c,{class:"g-4"},{default:s(()=>[(_(!0),V(B,null,P(g.categories,l=>(_(),w(x,{md:"6",xxl:"4",key:l.id},{default:s(()=>[t(C,{"no-body":"",class:"bg-transparent border h-100"},{default:s(()=>[t(u,{class:"bg-transparent border-bottom"},{default:s(()=>[e("h5",null,b(l.name),1)]),_:2},1024),t(a,null,{default:s(()=>[e("p",null,b(l.description),1),e("p",we,[ke,h(" "+b(l.follower_count)+" ",1),$e,Ve,h(" "+b(l.threads.length),1)])]),_:2},1024),t(k,{class:"bg-transparent border-top"},{default:s(()=>[g.user&&!m(l)?(_(),w(i,{key:0,variant:"outline-primary",size:"sm",onClick:y=>o.$emit("join",l.slug)},{default:s(()=>[h(" Join ")]),_:2},1032,["onClick"])):S("",!0),g.user&&m(l)?(_(),w(i,{key:1,variant:"outline-danger",size:"sm",onClick:y=>o.$emit("leave",l.slug)},{default:s(()=>[h(" Leave ")]),_:2},1032,["onClick"])):S("",!0),t(i,{variant:"primary",size:"sm",class:"ms-2",onClick:y=>o.$router.push({name:"student.community.threads",params:{slug:l.slug}})},{default:s(()=>[h(" View Threads ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})}}},Fe={__name:"CreateCategory",emits:["category-created"],setup(g,{emit:d}){const m=X.useToast(),o=f(""),p=f(""),u=f(""),a=f(""),i=f(!1),k=d,C=()=>{u.value="",a.value="";let c=!0;return o.value.trim()||(u.value="Category name is required",c=!1),p.value.trim()||(a.value="Description is required",c=!1),c},x=async()=>{if(C()){i.value=!0;try{await N.post("community/categories/",{name:o.value,description:p.value}),m.success("Category created successfully!"),k("category-created"),o.value="",p.value=""}catch(c){console.error("Failed to create category:",c),c.response&&c.response.data?(c.response.data.name&&(u.value=c.response.data.name[0]),c.response.data.description&&(a.value=c.response.data.description[0])):m.error("Failed to create category")}finally{i.value=!1}}};return(c,l)=>{const y=Q,F=re,T=ie,A=U,J=Z;return _(),w(J,{onSubmit:z(x,["prevent"])},{default:s(()=>[t(F,{label:"Category Name","label-for":"name","invalid-feedback":u.value},{default:s(()=>[t(y,{id:"name",modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=j=>o.value=j),placeholder:"Enter category name",required:"",state:u.value?!1:null},null,8,["modelValue","state"])]),_:1},8,["invalid-feedback"]),t(F,{label:"Description","label-for":"description","invalid-feedback":a.value},{default:s(()=>[t(T,{id:"description",modelValue:p.value,"onUpdate:modelValue":l[1]||(l[1]=j=>p.value=j),placeholder:"Enter category description",rows:"3",required:"",state:a.value?!1:null},null,8,["modelValue","state"])]),_:1},8,["invalid-feedback"]),t(A,{type:"submit",variant:"primary",disabled:i.value},{default:s(()=>[h("Create Category")]),_:1},8,["disabled"])]),_:1})}}},je=e("h1",{class:"h3 mb-2 mb-sm-0"},"Community Categories",-1),Le={class:"bg-transparent p-2 position-absolute top-50 end-0 translate-middle-y border-0 text-primary-hover text-reset",type:"submit"},qe={class:"list-inline mb-0 nav nav-pills nav-pill-dark-soft border-0 justify-content-end",id:"pills-tab",role:"tablist"},ze={class:"nav-item"},Ne={class:"nav-item"},Te={class:"tab-content"},Ee={class:"d-sm-flex justify-content-sm-between align-items-sm-center"},Se={class:"mb-0 text-center text-sm-start"},Ue={class:"d-flex justify-content-center mb-0","aria-label":"navigation"},Ae={class:"pagination pagination-sm pagination-primary-soft mb-0 pb-0 px-0"},Je=["onClick"],_t={__name:"Index",setup(g){const d=X.useToast();M();const m=f(!1),o=f(!1),p=f([]),u=f(""),a=f(1),i=f(10),k=f(null),C=async()=>{try{const r=await N.get("community/categories/",{params:{page:a.value,page_size:i.value}});p.value=r.data.results,d.success("Categories loaded successfully!")}catch(r){console.error("Failed to fetch categories:",r),d.error("Failed to fetch categories")}},x=async()=>{try{const r=await N.get("auth/users/me/");k.value=r.data}catch(r){console.error("Failed to fetch user:",r),d.error("Failed to fetch user data")}},c=async r=>{try{await N.post(`community/categories/${r}/join/`),d.success("Joined community successfully!"),await C()}catch(n){console.error("Failed to join community:",n),d.error("Failed to join community")}},l=async r=>{try{await N.post(`community/categories/${r}/leave/`),d.success("Left community successfully!"),await C()}catch(n){console.error("Failed to leave community:",n),d.error("Failed to leave community")}},y=D(()=>{if(!u.value)return p.value;const r=u.value.toLowerCase();return p.value.filter(n=>n.name.toLowerCase().includes(r)||n.description.toLowerCase().includes(r))}),F=D(()=>Math.ceil(y.value.length/i.value)),T=D(()=>{const r=(a.value-1)*i.value,n=r+i.value;return y.value.slice(r,n)}),A=()=>{a.value=1},J=()=>{a.value=1},j=()=>{o.value=!1};return ce(()=>{C(),x()}),(r,n)=>{const K=U,E=Y,H=W,ee=Q,L=ue("font-awesome-icon"),te=Z,ae=I,se=O,oe=R,ne=G,le=de;return _(),w(me,null,{default:s(()=>[t(E,{xl:"9"},{default:s(()=>[t(H,{class:"mb-3"},{default:s(()=>[t(E,{cols:"12",class:"d-sm-flex justify-content-between align-items-center"},{default:s(()=>[je,t(K,{variant:"primary",onClick:n[0]||(n[0]=v=>o.value=!0)},{default:s(()=>[h("Create New Category")]),_:1})]),_:1})]),_:1}),t(ne,{"no-body":"",class:"bg-transparent"},{default:s(()=>[t(ae,{class:"bg-transparent border-bottom px-0"},{default:s(()=>[t(H,{class:"g-3 align-items-center justify-content-between"},{default:s(()=>[t(E,{md:"8"},{default:s(()=>[t(te,{class:"rounded position-relative",onSubmit:z(A,["prevent"])},{default:s(()=>[t(ee,{class:"bg-transparent",type:"search",placeholder:"Search by name",modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=v=>u.value=v),onInput:J},null,8,["modelValue"]),e("button",Le,[t(L,{icon:q(pe),class:"fs-6"},null,8,["icon"])])]),_:1})]),_:1}),t(E,{md:"3"},{default:s(()=>[e("ul",qe,[e("li",ze,[e("a",{href:"#nav-list-tab",class:$(["nav-link mb-0 me-2",!m.value&&"active"]),"data-bs-toggle":"tab",onClick:n[2]||(n[2]=v=>m.value=!1)},[t(L,{icon:q(_e),class:"fa-fw"},null,8,["icon"])],2)]),e("li",Ne,[e("a",{href:"#nav-grid-tab",class:$(["nav-link mb-0",m.value&&"active"]),"data-bs-toggle":"tab",onClick:n[3]||(n[3]=v=>m.value=!0)},[t(L,{icon:q(ve),class:"fa-fw"},null,8,["icon"])],2)])])]),_:1})]),_:1})]),_:1}),t(se,{class:"px-0"},{default:s(()=>[e("div",Te,[e("div",{class:$(["tab-pane fade",!m.value&&"show active"]),id:"nav-list-tab"},[t(Ce,{categories:T.value,user:k.value,onJoin:c,onLeave:l},null,8,["categories","user"])],2),e("div",{class:$(["tab-pane fade",m.value&&"show active"]),id:"nav-grid-tab"},[t(xe,{categories:T.value,user:k.value,onJoin:c,onLeave:l},null,8,["categories","user"])],2)])]),_:1}),t(oe,{class:"bg-transparent pt-0 px-0"},{default:s(()=>[e("div",Ee,[e("p",Se," Showing "+b((a.value-1)*i.value+1)+" to "+b(Math.min(a.value*i.value,y.value.length))+" of "+b(y.value.length)+" entries ",1),e("nav",Ue,[e("ul",Ae,[e("li",{class:$(["page-item mb-0",{disabled:a.value===1}])},[e("a",{class:"page-link",href:"#",onClick:n[4]||(n[4]=z(v=>a.value--,["prevent"]))},[t(L,{icon:q(fe)},null,8,["icon"])])],2),(_(!0),V(B,null,P(F.value,v=>(_(),V("li",{class:$(["page-item mb-0",{active:v===a.value}]),key:v},[e("a",{class:"page-link",href:"#",onClick:z(De=>a.value=v,["prevent"])},b(v),9,Je)],2))),128)),e("li",{class:$(["page-item mb-0",{disabled:a.value===F.value}])},[e("a",{class:"page-link",href:"#",onClick:n[5]||(n[5]=z(v=>a.value++,["prevent"]))},[t(L,{icon:q(be)},null,8,["icon"])])],2)])])])]),_:1})]),_:1}),t(le,{modelValue:o.value,"onUpdate:modelValue":n[6]||(n[6]=v=>o.value=v),title:"Create New Category",onHidden:j},{default:s(()=>[t(Fe,{onCategoryCreated:C})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}};export{_t as default};
