import{_ as V}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CRgGAbI0.js";import{y as E,q as m,E as N,J as k,A as $,i as l,o as r,b as i,w as d,V as A,a as e,W as B,F as g,m as M,t as _,L as F,g as L,X as T,aE as W,c as q}from"./index-N9CDaHOP.js";/* empty css                    */import"./DropDown.vue_vue_type_script_setup_true_lang-CvqxUwdC.js";import"./ProfileDropdown.vue_vue_type_script_setup_true_lang-MiOOsD2a.js";import"./change-casing-BoyW-fpY.js";import"./01-DeMBLNXD.js";import"./MobileNavbarToggler-Bj1WYEMd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./MenuItemWithChildren.vue_vue_type_script_setup_true_lang-9IhJN-Gy.js";import"./menu-items-1Og9OzUr.js";import"./index-DdoyQ2gK.js";import"./index-DwNiKAmd.js";import"./logo-light-sT18Thxh.js";import"./08-DzHvQlEd.js";import"./02-u1oGLGhS.js";import"./05-BauEG9gJ.js";import"./03-6nKUgUxe.js";const D=e("h5",null,"Communities",-1),R={class:"table-responsive border-0 rounded-3 mb-0"},X={class:"table table-dark-gray align-middle p-4 mb-0 table-hover"},j=e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"border-0 rounded-start"},"Name"),e("th",{scope:"col",class:"border-0"},"Description"),e("th",{scope:"col",class:"border-0"},"Members"),e("th",{scope:"col",class:"border-0 rounded-end"},"Actions")])],-1),J={key:0},S=e("td",{colspan:"4",class:"text-center"},"Loading...",-1),U=[S],z={key:1},G=e("td",{colspan:"4",class:"text-center"},"No communities found",-1),H=[G],I={__name:"CommunityList",setup(x){const v=E.useToast(),p=m([]),y=m([]),b=m(!1),h=m(!1),u=m(null);N(async()=>{b.value=!0;try{const s=await k.get("community/categories/");console.log("Categories response:",s.data),p.value=s.data.results||s.data;const a=await k.get("community/threads/");console.log("Threads response:",a.data),y.value=a.data.results||a.data,console.log("Categories with members:",f.value)}catch(s){console.error("Failed to fetch data:",s),v.error("Failed to fetch communities or threads")}finally{b.value=!1}});const f=$(()=>p.value.map(s=>{const a=y.value.filter(t=>t.category&&t.category.id===s.id),n=new Map;return a.forEach(t=>{t.starter&&!n.has(t.starter.id)&&n.set(t.starter.id,t.starter),t.replies&&t.replies.forEach(c=>{c.author&&!n.has(c.author.id)&&n.set(c.author.id,c.author)})}),{category:s,members:Array.from(n.values())}}));return(s,a)=>{const n=A,t=F,c=B,C=T,w=W;return r(),l(g,null,[i(C,{"no-body":"",class:"bg-transparent border"},{default:d(()=>[i(n,{class:"bg-light border-bottom"},{default:d(()=>[D]),_:1}),i(c,null,{default:d(()=>[e("div",R,[e("table",X,[j,e("tbody",null,[b.value?(r(),l("tr",J,U)):f.value.length?(r(!0),l(g,{key:2},M(f.value,o=>(r(),l("tr",{key:o.category.id},[e("td",null,_(o.category.name),1),e("td",null,_(o.category.description),1),e("td",null,_(o.members.length),1),e("td",null,[i(t,{onClick:O=>{h.value=!0,u.value=o},class:"btn btn-sm btn-info"},{default:d(()=>[L("View Members")]),_:2},1032,["onClick"])])]))),128)):(r(),l("tr",z,H))])])])]),_:1})]),_:1}),i(w,{modelValue:h.value,"onUpdate:modelValue":a[0]||(a[0]=o=>h.value=o),title:"Members of "+(u.value?u.value.category.name:"")},{default:d(()=>[e("ul",null,[(r(!0),l(g,null,M(u.value?u.value.members:[],o=>(r(),l("li",{key:o.id},_(o.full_name),1))),128))])]),_:1},8,["modelValue","title"])],64)}}},K=e("h1",null,"Admin Communities",-1),pe={__name:"index",setup(x){return(v,p)=>(r(),q(V,null,{default:d(()=>[K,i(I)]),_:1}))}};export{pe as default};
