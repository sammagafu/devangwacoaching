import{y as T,q as p,E as j,c as k,o as h,w as l,b as e,X as z,V as J,a as r,W as Y,Y as G,D as M,x as W,H as X,f,cg as $,bY as q,ar as H,e as O,at as K,g as _,r as Q,ch as Z,R as ee,i as x,m as ae,F as le,L as te,J as F,t as oe}from"./index-BKxaJmes.js";/* empty css                    */import{_ as se}from"./StudentLayout.vue_vue_type_script_setup_true_lang-CbXq5A_q.js";import{a as re}from"./07-9It8PR0c.js";import{f as ne,a as ie}from"./index-DP6gMcTi.js";import{k as ue}from"./index-DdoyQ2gK.js";import"./menu-items-CfbG37ai.js";import"./index-DwNiKAmd.js";import"./TopBar8.vue_vue_type_script_setup_true_lang-D157KbNp.js";import"./LogoBox.vue_vue_type_script_setup_true_lang-DtsTVlc2.js";import"./StickyHeader.vue_vue_type_script_setup_true_lang-Bd8hrDfw.js";import"./ProfileDropdown.vue_vue_type_script_setup_true_lang-DwdOghs1.js";import"./DropDown.vue_vue_type_script_setup_true_lang-DCXrtorV.js";import"./change-casing-BoyW-fpY.js";import"./01-DeMBLNXD.js";import"./MobileNavbarToggler-CAzdXCW6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ShopCart.vue_vue_type_script_setup_true_lang-Dp2SNiK4.js";import"./ChoicesSelect.vue_vue_type_script_setup_true_lang-B5ypeToF.js";import"./02-CA1hCPq5.js";import"./04-D66rD-0h.js";import"./Footer7.vue_vue_type_script_setup_true_lang-CgPe67WN.js";import"./constants-Bu7G09dq.js";import"./logo-light-sT18Thxh.js";import"./04-DIykCGoU.js";import"./09-BzxBVZmI.js";const de=r("h3",{class:"card-header-title mb-0"},"Edit Profile",-1),me=r("label",{class:"form-label"},"Profile picture",-1),ce={class:"d-flex align-items-center"},pe={class:"position-relative me-4",for:"uploadfile-1",title:"Replace this pic"},fe={class:"avatar avatar-xl"},ve=["src"],_e=r("label",{class:"btn btn-primary-soft mb-0",for:"uploadfile-1"},"Change",-1),be=r("div",{class:"form-text"},"Brief description for your profile.",-1),ge={class:"mb-3"},he={class:"mb-3"},we={class:"mb-3"},Ve={class:"mb-3"},ye={class:"d-sm-flex justify-content-end"},Oe={__name:"index",setup(ke){const v=T.useToast(),n=p({}),o=p({}),i=p({}),b=p([]),w=p(!1),u=p(null),E=async()=>{try{const t=await F.get("auth/profile/");n.value=t.data.user,o.value=t.data.user_details||{}}catch(t){console.error("Failed to fetch profile:",t),v.error("Failed to fetch profile data")}},U=t=>{const a=t.target.files[0];if(a){console.log("Selected file:",{name:a.name,type:a.type,size:a.size}),u.value=a;const g=new FileReader;g.onload=V=>{o.value.avatar=V.target.result},g.readAsDataURL(a)}else console.warn("No file selected"),v.warning("No file selected for avatar")},N=()=>{u.value=null,o.value.avatar=null,console.log("Avatar removed")},B=()=>{var a;i.value={};let t=!0;return(a=n.value.full_name)!=null&&a.trim()||(i.value.full_name="Full name is required",t=!1),n.value.phonenumber&&!/^\+?\d{10,15}$/.test(n.value.phonenumber)&&(i.value.phonenumber="Invalid phone number",t=!1),o.value.bio&&o.value.bio.length>500&&(i.value.bio="Bio must be 500 characters or less",t=!1),u.value&&!["image/png","image/jpeg"].includes(u.value.type)&&(i.value.avatar="Avatar must be a PNG or JPEG image",t=!1),t},C=async()=>{if(B()){w.value=!0,b.value=[];try{const t=new FormData;t.append("user",JSON.stringify({full_name:n.value.full_name,phonenumber:n.value.phonenumber})),t.append("user_details",JSON.stringify({bio:o.value.bio,twitter:o.value.twitter,facebook:o.value.facebook,instagram:o.value.instagram,website:o.value.website})),u.value?(console.log("Appending avatar:",{name:u.value.name,type:u.value.type,size:u.value.size}),t.append("avatar",u.value)):console.warn("No avatar file selected for upload"),console.log("FormData entries:",[...t.entries()]);const a=await F.put("auth/profile/",t,{headers:{"Content-Type":"multipart/form-data"}});n.value=a.data.user,o.value=a.data.user_details,u.value=null,v.success("Profile updated successfully!")}catch(t){console.error("Failed to update profile:",t),t.response&&t.response.data?(i.value={...t.response.data.user||{},...t.response.data.user_details||{},avatar:t.response.data.avatar||i.value.avatar},b.value=t.response.data.non_field_errors||[],v.error("Failed to update profile: Check form errors")):v.error("Failed to update profile")}finally{w.value=!1}}};return j(()=>{E()}),(t,a)=>{const g=J,V=q,m=X,c=O,d=H,P=K,y=Q("font-awesome-icon"),R=ee,S=te,A=G,D=Y,L=z;return h(),k(se,null,{default:l(()=>[e(m,{xl:"9"},{default:l(()=>[e(L,{"no-body":"",class:"bg-transparent border rounded-3"},{default:l(()=>[e(g,{class:"bg-transparent border-bottom"},{default:l(()=>[de]),_:1}),e(D,null,{default:l(()=>[e(A,{class:"row g-4",onSubmit:M(C,["prevent"])},{default:l(()=>[e(m,{cols:"12",class:"justify-content-center align-items-center"},{default:l(()=>[me,r("div",ce,[r("label",pe,[r("span",fe,[r("img",{id:"uploadfile-1-preview",class:"avatar-img rounded-circle border border-white border-3 shadow",src:o.value.avatar||f(re),alt:""},null,8,ve)]),r("button",{type:"button",class:"uploadremove flex-centered",onClick:N},[e(f($),{class:"text-white"})])]),_e,e(V,{class:"d-none",id:"uploadfile-1",onChange:U,accept:"image/png,image/jpeg"})])]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(d,{label:"Full name","invalid-feedback":i.value.full_name},{default:l(()=>[e(c,{modelValue:n.value.full_name,"onUpdate:modelValue":a[0]||(a[0]=s=>n.value.full_name=s),placeholder:"Enter full name",state:i.value.full_name?!1:null},null,8,["modelValue","state"])]),_:1},8,["invalid-feedback"])]),_:1}),e(m,{md:"6"},{default:l(()=>[e(d,{label:"Email"},{default:l(()=>[e(c,{modelValue:n.value.email,"onUpdate:modelValue":a[1]||(a[1]=s=>n.value.email=s),type:"email",placeholder:"Enter email",disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{md:"6"},{default:l(()=>[e(d,{label:"Phone number","invalid-feedback":i.value.phonenumber},{default:l(()=>[e(c,{modelValue:n.value.phonenumber,"onUpdate:modelValue":a[2]||(a[2]=s=>n.value.phonenumber=s),placeholder:"Enter phone number",state:i.value.phonenumber?!1:null},null,8,["modelValue","state"])]),_:1},8,["invalid-feedback"])]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(d,{label:"Bio","invalid-feedback":i.value.bio},{default:l(()=>[e(P,{modelValue:o.value.bio,"onUpdate:modelValue":a[3]||(a[3]=s=>o.value.bio=s),placeholder:"Add a bio...",rows:"3","max-rows":"6",state:i.value.bio?!1:null},null,8,["modelValue","state"]),be]),_:1},8,["invalid-feedback"])]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(d,{label:"Social Media Profiles"},{default:l(()=>[r("div",ge,[e(d,null,{label:l(()=>[e(y,{icon:f(ne),class:"text-facebook me-1"},null,8,["icon"]),_(" Facebook ")]),default:l(()=>[e(c,{modelValue:o.value.facebook,"onUpdate:modelValue":a[4]||(a[4]=s=>o.value.facebook=s),placeholder:"Enter Facebook URL"},null,8,["modelValue"])]),_:1})]),r("div",he,[e(d,null,{label:l(()=>[e(f(Z),{class:"text-twitter me-1"}),_(" Twitter ")]),default:l(()=>[e(c,{modelValue:o.value.twitter,"onUpdate:modelValue":a[5]||(a[5]=s=>o.value.twitter=s),placeholder:"Enter Twitter URL"},null,8,["modelValue"])]),_:1})]),r("div",we,[e(d,null,{label:l(()=>[e(y,{icon:f(ie),class:"text-instagram me-1"},null,8,["icon"]),_(" Instagram ")]),default:l(()=>[e(c,{modelValue:o.value.instagram,"onUpdate:modelValue":a[6]||(a[6]=s=>o.value.instagram=s),placeholder:"Enter Instagram URL"},null,8,["modelValue"])]),_:1})]),r("div",Ve,[e(d,null,{label:l(()=>[e(y,{icon:f(ue),class:"text-primary me-1"},null,8,["icon"]),_(" Website ")]),default:l(()=>[e(c,{modelValue:o.value.website,"onUpdate:modelValue":a[7]||(a[7]=s=>o.value.website=s),placeholder:"Enter website URL"},null,8,["modelValue"])]),_:1})])]),_:1})]),_:1}),b.value.length?(h(),k(m,{key:0,cols:"12"},{default:l(()=>[e(R,{show:"",variant:"danger"},{default:l(()=>[r("ul",null,[(h(!0),x(le,null,ae(b.value,(s,I)=>(h(),x("li",{key:I},oe(s),1))),128))])]),_:1})]),_:1})):W("",!0),r("div",ye,[e(S,{type:"submit",variant:"primary",class:"mb-0",disabled:w.value},{default:l(()=>[_("Save changes")]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Oe as default};
