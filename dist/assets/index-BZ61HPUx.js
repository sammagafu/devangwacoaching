import{d as P,I as U,i as _,o as m,a as n,b as a,$ as C,w as o,H as w,ar as N,x as v,e as j,n as g,t as f,at as M,L as q,g as h,q as $,f as F,c as S,y as O,E as J,s as G,C as Y,X as A,V as H,W,Y as X,D as Z,b4 as K,J as Q}from"./index-N9CDaHOP.js";/* empty css                    */import{_ as x}from"./ChoicesSelect.vue_vue_type_script_setup_true_lang-DiCDSqEv.js";import{g as ee}from"./gallery-Cdr3p6R3.js";import{_ as te}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CRgGAbI0.js";import{S as ae}from"./bs-stepper-B0pARQqw.js";import{p as ne}from"./04-DIykCGoU.js";import"./DropDown.vue_vue_type_script_setup_true_lang-CvqxUwdC.js";import"./ProfileDropdown.vue_vue_type_script_setup_true_lang-MiOOsD2a.js";import"./change-casing-BoyW-fpY.js";import"./01-DeMBLNXD.js";import"./MobileNavbarToggler-Bj1WYEMd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./MenuItemWithChildren.vue_vue_type_script_setup_true_lang-9IhJN-Gy.js";import"./menu-items-1Og9OzUr.js";import"./index-DdoyQ2gK.js";import"./index-DwNiKAmd.js";import"./logo-light-sT18Thxh.js";import"./08-DzHvQlEd.js";import"./02-u1oGLGhS.js";import"./05-BauEG9gJ.js";import"./03-6nKUgUxe.js";const oe={id:"step-1",role:"tabpanel",class:"content fade","aria-labelledby":"steppertrigger1"},se=n("h4",null,"Event Details",-1),le=n("hr",null,null,-1),re={key:0,class:"invalid-feedback"},ie={key:0,class:"invalid-feedback"},de=n("option",{value:""},"Select event type",-1),pe=n("option",{value:"online"},"Online",-1),ue=n("option",{value:"on_premises"},"On Premises",-1),ce={key:0,class:"invalid-feedback"},me={class:"d-flex justify-content-end mt-3"},ve=P({__name:"EventStep1",props:{formData:{},nextPage:{type:Function},errors:{}},setup(V){const b=V;return U(()=>b.formData,e=>{console.log("EventStep1 formData changed:",e)},{deep:!0}),(e,l)=>{const s=j,i=N,t=w,d=M,y=q,u=C;return m(),_("div",oe,[se,le,a(u,{class:"g-4"},{default:o(()=>[a(t,{cols:"12"},{default:o(()=>[a(i,{label:"Event Title *"},{default:o(()=>[a(s,{type:"text",placeholder:"Enter event title",modelValue:e.formData.title,"onUpdate:modelValue":l[0]||(l[0]=k=>e.formData.title=k),class:g({"is-invalid":e.errors.title})},null,8,["modelValue","class"]),e.errors.title?(m(),_("div",re,f(e.errors.title),1)):v("",!0)]),_:1})]),_:1}),a(t,{cols:"12"},{default:o(()=>[a(i,{label:"Description *"},{default:o(()=>[a(d,{placeholder:"Enter event description",rows:"4",modelValue:e.formData.description,"onUpdate:modelValue":l[1]||(l[1]=k=>e.formData.description=k),class:g({"is-invalid":e.errors.description})},null,8,["modelValue","class"]),e.errors.description?(m(),_("div",ie,f(e.errors.description),1)):v("",!0)]),_:1})]),_:1}),a(t,{md:"6"},{default:o(()=>[a(i,{label:"Event Type *"},{default:o(()=>[a(x,{id:"event-type",class:g(["border-0 z-index-9 bg-transparent",{"is-invalid":e.errors.event_type}]),modelValue:e.formData.event_type,"onUpdate:modelValue":l[2]||(l[2]=k=>e.formData.event_type=k)},{default:o(()=>[de,pe,ue]),_:1},8,["modelValue","class"]),e.errors.event_type?(m(),_("div",ce,f(e.errors.event_type),1)):v("",!0)]),_:1})]),_:1}),n("div",me,[a(y,{variant:"primary",class:"next-btn mb-0",onClick:e.nextPage},{default:o(()=>[h("Next")]),_:1},8,["onClick"])])]),_:1})])}}}),_e={id:"step-2",role:"tabpanel",class:"content fade","aria-labelledby":"steppertrigger2"},fe=n("h4",null,"Event Media",-1),be=n("hr",null,null,-1),ge={class:"text-center justify-content-center align-items-center p-4 p-sm-5 border border-2 border-dashed position-relative rounded-3"},ye=["src"],ke={class:"my-2"},he=n("p",{class:"small mb-0 mt-2"},[n("b",null,"Note:"),h(" Only JPG, JPEG, and PNG. Suggested dimensions are 1920px * 1080px. ")],-1),De={key:0,class:"mt-2"},Ve={key:1,class:"text-danger mt-2"},Ee={class:"d-sm-flex justify-content-end mt-2"},$e={class:"d-flex justify-content-between mt-3"},Se=P({__name:"EventStep2",props:{formData:{},nextPage:{type:Function},previousPage:{type:Function},errors:{}},setup(V){const b=$(null),e=V,l=s=>{const i=s.target;i.files&&i.files.length>0&&(e.formData.cover=i.files[0],console.log("Image uploaded:",e.formData.cover.name))};return U(()=>e.formData.cover,s=>{console.log("EventStep2 cover changed:",s?s.name:null)}),(s,i)=>{const t=q,d=w,y=C;return m(),_("div",_e,[fe,be,a(y,null,{default:o(()=>[a(d,{cols:"12"},{default:o(()=>[n("div",ge,[n("img",{src:F(ee),class:"h-50px",alt:""},null,8,ye),n("div",null,[n("h6",ke,[h(" Upload event cover image here, or "),n("a",{href:"#!",class:"text-primary",onClick:i[0]||(i[0]=u=>s.$refs.fileInput.click())},"Browse")]),n("input",{type:"file",ref_key:"fileInput",ref:b,style:{display:"none"},accept:"image/gif, image/jpeg, image/png",onChange:l},null,544),he,s.formData.cover?(m(),_("div",De,[n("span",null,"Selected: "+f(s.formData.cover.name),1)])):v("",!0),s.errors.cover?(m(),_("div",Ve,f(s.errors.cover),1)):v("",!0)])]),n("div",Ee,[s.formData.cover?(m(),S(t,{key:0,type:"button",variant:"danger-soft",size:"sm",class:"mb-3",onClick:i[1]||(i[1]=u=>s.formData.cover=null)},{default:o(()=>[h(" Remove Image ")]),_:1})):v("",!0)])]),_:1}),n("div",$e,[a(t,{variant:"secondary",class:"prev-btn mb-0",onClick:s.previousPage},{default:o(()=>[h("Previous")]),_:1},8,["onClick"]),a(t,{variant:"primary",class:"next-btn mb-0",onClick:s.nextPage},{default:o(()=>[h("Next")]),_:1},8,["onClick"])])]),_:1})])}}}),Pe={id:"step-3",role:"tabpanel",class:"content fade","aria-labelledby":"steppertrigger3"},Ce=n("h4",null,"Dates and Pricing",-1),we=n("hr",null,null,-1),Ue={key:0,class:"invalid-feedback"},qe={key:0,class:"invalid-feedback"},Ne={key:0,class:"invalid-feedback"},je={key:0,class:"invalid-feedback"},Fe={key:0,class:"invalid-feedback"},ze={key:0,class:"invalid-feedback"},Te={class:"d-flex justify-content-between mt-3"},Ie=P({__name:"EventStep3",props:{formData:{},previousPage:{type:Function},errors:{}},setup(V){const b=V;return U(()=>b.formData,e=>{console.log("EventStep3 formData changed:",e)},{deep:!0}),(e,l)=>{const s=j,i=N,t=w,d=q,y=C;return m(),_("div",Pe,[Ce,we,a(y,{class:"g-4"},{default:o(()=>[a(t,{md:"6"},{default:o(()=>[a(i,{label:"Start Time *"},{default:o(()=>[a(s,{type:"datetime-local",modelValue:e.formData.start_time,"onUpdate:modelValue":l[0]||(l[0]=u=>e.formData.start_time=u),class:g({"is-invalid":e.errors.start_time})},null,8,["modelValue","class"]),e.errors.start_time?(m(),_("div",Ue,f(e.errors.start_time),1)):v("",!0)]),_:1})]),_:1}),a(t,{md:"6"},{default:o(()=>[a(i,{label:"End Time *"},{default:o(()=>[a(s,{type:"datetime-local",modelValue:e.formData.end_time,"onUpdate:modelValue":l[1]||(l[1]=u=>e.formData.end_time=u),class:g({"is-invalid":e.errors.end_time})},null,8,["modelValue","class"]),e.errors.end_time?(m(),_("div",qe,f(e.errors.end_time),1)):v("",!0)]),_:1})]),_:1}),a(t,{md:"6"},{default:o(()=>[a(i,{label:"Registration Deadline *"},{default:o(()=>[a(s,{type:"datetime-local",modelValue:e.formData.registration_deadline,"onUpdate:modelValue":l[2]||(l[2]=u=>e.formData.registration_deadline=u),class:g({"is-invalid":e.errors.registration_deadline})},null,8,["modelValue","class"]),e.errors.registration_deadline?(m(),_("div",Ne,f(e.errors.registration_deadline),1)):v("",!0)]),_:1})]),_:1}),a(t,{md:"6"},{default:o(()=>[a(i,{label:"Discount Deadline"},{default:o(()=>[a(s,{type:"datetime-local",modelValue:e.formData.discount_deadline,"onUpdate:modelValue":l[3]||(l[3]=u=>e.formData.discount_deadline=u)},null,8,["modelValue"])]),_:1})]),_:1}),e.formData.event_type==="on_premises"?(m(),S(t,{key:0,md:"6"},{default:o(()=>[a(i,{label:"Location *"},{default:o(()=>[a(s,{type:"text",placeholder:"Enter event location",modelValue:e.formData.location,"onUpdate:modelValue":l[4]||(l[4]=u=>e.formData.location=u),class:g({"is-invalid":e.errors.location})},null,8,["modelValue","class"]),e.errors.location?(m(),_("div",je,f(e.errors.location),1)):v("",!0)]),_:1})]),_:1})):v("",!0),e.formData.event_type==="online"?(m(),S(t,{key:1,md:"6"},{default:o(()=>[a(i,{label:"Event Link *"},{default:o(()=>[a(s,{type:"url",placeholder:"Enter event link (e.g., https://zoom.us/j/123456)",modelValue:e.formData.link,"onUpdate:modelValue":l[5]||(l[5]=u=>e.formData.link=u),class:g({"is-invalid":e.errors.link})},null,8,["modelValue","class"]),e.errors.link?(m(),_("div",Fe,f(e.errors.link),1)):v("",!0)]),_:1})]),_:1})):v("",!0),a(t,{md:"6"},{default:o(()=>[a(i,{label:"Price (TZS) *"},{default:o(()=>[a(s,{type:"number",placeholder:"Enter event price",modelValue:e.formData.price,"onUpdate:modelValue":l[6]||(l[6]=u=>e.formData.price=u),class:g({"is-invalid":e.errors.price})},null,8,["modelValue","class"]),e.errors.price?(m(),_("div",ze,f(e.errors.price),1)):v("",!0)]),_:1})]),_:1}),a(t,{md:"6"},{default:o(()=>[a(i,{label:"Discount Percentage (%)"},{default:o(()=>[a(s,{type:"number",placeholder:"Enter discount percentage",modelValue:e.formData.discount_percentage,"onUpdate:modelValue":l[7]||(l[7]=u=>e.formData.discount_percentage=u),min:"0",max:"100"},null,8,["modelValue"])]),_:1})]),_:1}),n("div",Te,[a(d,{variant:"secondary",class:"prev-btn mb-0",onClick:e.previousPage},{default:o(()=>[h("Previous")]),_:1},8,["onClick"]),a(d,{type:"submit",variant:"success",class:"mb-0"},{default:o(()=>[h("Create Event")]),_:1})])]),_:1})])}}}),Le=n("h1",{class:"text-white"},"Create a New Event",-1),Re=n("p",{class:"text-white mb-0"},"Fill in the details below to create your event.",-1),Be=n("div",{class:"bs-stepper-header",role:"tablist"},[n("div",{class:"step","data-target":"#step-1"},[n("div",{class:"d-grid text-center align-items-center"},[n("button",{type:"button",class:"btn btn-link step-trigger mb-0",role:"tab",id:"steppertrigger1","aria-controls":"step-1"},[n("span",{class:"bs-stepper-circle"},"1")]),n("h6",{class:"bs-stepper-label d-none d-md-block"},"Event Details")])]),n("div",{class:"line"}),n("div",{class:"step","data-target":"#step-2"},[n("div",{class:"d-grid text-center align-items-center"},[n("button",{type:"button",class:"btn btn-link step-trigger mb-0",role:"tab",id:"steppertrigger2","aria-controls":"step-2"},[n("span",{class:"bs-stepper-circle"},"2")]),n("h6",{class:"bs-stepper-label d-none d-md-block"},"Event Media")])]),n("div",{class:"line"}),n("div",{class:"step","data-target":"#step-3"},[n("div",{class:"d-grid text-center align-items-center"},[n("button",{type:"button",class:"btn btn-link step-trigger mb-0",role:"tab",id:"steppertrigger3","aria-controls":"step-3"},[n("span",{class:"bs-stepper-circle"},"3")]),n("h6",{class:"bs-stepper-label d-none d-md-block"},"Dates and Pricing")])])],-1),Me={class:"bs-stepper-content"},pt=P({__name:"index",setup(V){const b=O.useToast(),e=K(),l=$(null);let s=$();const i=$(!1),t=$({title:"",description:"",event_type:"",cover:null,start_time:"",end_time:"",registration_deadline:"",discount_deadline:"",location:"",link:"",price:null,discount_percentage:null,enable_discount:!1,tags:[]}),d=$({title:"",description:"",event_type:"",cover:"",start_time:"",end_time:"",registration_deadline:"",discount_deadline:"",location:"",link:"",price:"",tags:""});J(()=>{l.value?(s.value=new ae(l.value,{linear:!1,animation:!0}),console.log("Stepper initialized")):console.error("Stepper ref not found")});const y=()=>{var p,c,D;const r=((c=(p=s.value)==null?void 0:p.getCurrentStep)==null?void 0:c.call(p))??0;console.log("Next button clicked, current step:",r,"formData:",t.value),k(r)&&((D=s.value)==null||D.next())},u=()=>{var r;console.log("Previous button clicked"),(r=s.value)==null||r.previous()},k=r=>{i.value=!0;let p=!0;d.value={title:"",description:"",event_type:"",cover:"",start_time:"",end_time:"",registration_deadline:"",discount_deadline:"",location:"",link:"",price:"",tags:""};const c=[];return r===0?(t.value.title||(d.value.title="Event title is required",c.push("Event title"),p=!1),t.value.description||(d.value.description="Description is required",c.push("Description"),p=!1),t.value.event_type||(d.value.event_type="Event type is required",c.push("Event type"),p=!1)):r===1?t.value.cover||(d.value.cover="Event image is required",c.push("Event image"),p=!1):r===2&&(t.value.start_time||(d.value.start_time="Start time is required",c.push("Start time"),p=!1),t.value.end_time||(d.value.end_time="End time is required",c.push("End time"),p=!1),t.value.registration_deadline||(d.value.registration_deadline="Registration deadline is required",c.push("Registration deadline"),p=!1),t.value.event_type==="on_premises"&&!t.value.location&&(d.value.location="Location is required for on-premises events",c.push("Location"),p=!1),t.value.event_type==="online"&&!t.value.link&&(d.value.link="Link is required for online events",c.push("Link"),p=!1),(t.value.price===null||t.value.price<0)&&(d.value.price="Valid price is required",c.push("Price"),p=!1)),p?console.log("Validation passed for step",r):(console.log("Validation failed for step",r,"Missing fields:",c),b.error(`Please fill in all required fields: ${c.join(", ")}`)),p},z=async()=>{if(console.log("Submitting event, formData:",t.value),i.value=!0,!k(2))return;const r=new FormData;r.append("title",t.value.title),r.append("description",t.value.description),r.append("event_type",t.value.event_type),t.value.cover&&r.append("cover",t.value.cover),r.append("start_time",t.value.start_time),r.append("end_time",t.value.end_time),r.append("registration_deadline",t.value.registration_deadline),t.value.discount_deadline&&r.append("discount_deadline",t.value.discount_deadline),t.value.event_type==="on_premises"?r.append("location",t.value.location):t.value.event_type==="online"&&r.append("link",t.value.link),t.value.price!==null&&r.append("price",t.value.price.toFixed(2)),t.value.enable_discount&&t.value.discount_percentage!==null&&r.append("discount_percentage",t.value.discount_percentage.toString()),r.append("tags",JSON.stringify(t.value.tags));try{const p=await Q.post("coaching/events/",r,{headers:{"Content-Type":"multipart/form-data"}});b.success("Event created successfully!"),e.push({name:"admin.manage.event"}),T()}catch(p){if(p.response&&p.response.data){const c=p.response.data;for(const[D,E]of Object.entries(c))D in d.value&&(d.value[D]=Array.isArray(E)?E[0]:E);console.log("Backend errors:",c),b.error("Please correct the errors and try again")}else console.error("Error submitting event:",p),b.error("Failed to create event")}},T=()=>{t.value={title:"",description:"",event_type:"",cover:null,start_time:"",end_time:"",registration_deadline:"",discount_deadline:"",location:"",link:"",price:null,discount_percentage:null,enable_discount:!1,tags:[]},i.value=!1,d.value={title:"",description:"",event_type:"",cover:"",start_time:"",end_time:"",registration_deadline:"",discount_deadline:"",location:"",link:"",price:"",tags:""}};return(r,p)=>{const c=w,D=C,E=Y,I=H,L=X,R=W,B=A;return m(),S(te,null,{default:o(()=>[n("main",null,[n("section",{class:"py-0 bg-blue h-100px align-items-center d-flex h-200px rounded-0",style:G(`background:url(${F(ne)}) no-repeat center center; background-size:cover;`)},[a(E,null,{default:o(()=>[a(D,null,{default:o(()=>[a(c,{cols:"12",class:"text-center"},{default:o(()=>[Le,Re]),_:1})]),_:1})]),_:1})],4),n("section",null,[a(E,null,{default:o(()=>[a(B,{"no-body":"",class:"bg-transparent border rounded-3 mb-5"},{default:o(()=>[n("div",{id:"stepper",ref_key:"stepperRef",ref:l,class:"bs-stepper stepper-outline"},[a(I,{class:"bg-light border-bottom px-lg-5"},{default:o(()=>[Be]),_:1}),a(R,null,{default:o(()=>[n("div",Me,[a(L,{onSubmit:Z(z,["prevent"])},{default:o(()=>[a(ve,{"form-data":t.value,"next-page":y,errors:d.value},null,8,["form-data","errors"]),a(Se,{"form-data":t.value,"next-page":y,"previous-page":u,errors:d.value},null,8,["form-data","errors"]),a(Ie,{"form-data":t.value,"previous-page":u,errors:d.value},null,8,["form-data","errors"])]),_:1})])]),_:1})],512)]),_:1})]),_:1})])])]),_:1})}}});export{pt as default};
