import{d as ci,bR as Yw,bp as jw,q as Pe,bS as Xw,bT as yh,bU as Zw,bV as Qw,f as Et,bW as ex,i as Le,o as Te,b as A,ar as Xi,w as P,e as ko,bX as Ya,g as Se,t as Be,at as ja,$ as Zi,a as D,H as Qi,h as $i,bB as Ta,L as So,p as vh,l as bh,y as Co,x as dt,c as ri,Q as tx,bY as nx,bZ as rx,r as Xa,bn as Zr,b_ as Oa,au as ix,F as Vi,m as zi,aE as wh,Y as Za,n as br,aA as td,av as sx,b$ as ox,b4 as xh,aO as Di,A as nd,a$ as lx,E as ax,J as Me,s as ux,C as cx,X as fx,as as dx,V as hx,W as px,D as mx}from"./index-BKxaJmes.js";/* empty css                    */import{_ as gx}from"./AdminLayout.vue_vue_type_script_setup_true_lang-C2I9QJJr.js";import{_ as oa}from"./ChoicesSelect.vue_vue_type_script_setup_true_lang-B5ypeToF.js";import{_ as _h}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as kh,au as Sh,a9 as Ch}from"./index-DdoyQ2gK.js";import{_ as yx}from"./CustomGLightbox.vue_vue_type_script_setup_true_lang-CGg3lnMz.js";import{g as vx}from"./gallery-Cdr3p6R3.js";import{a as bx}from"./04-cRtnBCs6.js";import{p as wx}from"./04-DIykCGoU.js";import{S as xx}from"./bs-stepper-B-e4yanc.js";import"./DropDown.vue_vue_type_script_setup_true_lang-DCXrtorV.js";import"./ProfileDropdown.vue_vue_type_script_setup_true_lang-DwdOghs1.js";import"./change-casing-BoyW-fpY.js";import"./01-DeMBLNXD.js";import"./MobileNavbarToggler-CAzdXCW6.js";import"./MenuItemWithChildren.vue_vue_type_script_setup_true_lang-BcgdXxdP.js";import"./getActiveClass-BJHf-Sl9.js";import"./menu-items-CfbG37ai.js";import"./index-DwNiKAmd.js";import"./logo-light-sT18Thxh.js";import"./08-DzHvQlEd.js";import"./02-u1oGLGhS.js";import"./05-BauEG9gJ.js";import"./03-6nKUgUxe.js";function ot(r){this.content=r}ot.prototype={constructor:ot,find:function(r){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===r)return e;return-1},get:function(r){var e=this.find(r);return e==-1?void 0:this.content[e+1]},update:function(r,e,t){var n=t&&t!=r?this.remove(t):this,i=n.find(r),o=n.content.slice();return i==-1?o.push(t||r,e):(o[i+1]=e,t&&(o[i]=t)),new ot(o)},remove:function(r){var e=this.find(r);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new ot(t)},addToStart:function(r,e){return new ot([r,e].concat(this.remove(r).content))},addToEnd:function(r,e){var t=this.remove(r).content.slice();return t.push(r,e),new ot(t)},addBefore:function(r,e,t){var n=this.remove(e),i=n.content.slice(),o=n.find(r);return i.splice(o==-1?i.length:o,0,e,t),new ot(i)},forEach:function(r){for(var e=0;e<this.content.length;e+=2)r(this.content[e],this.content[e+1])},prepend:function(r){return r=ot.from(r),r.size?new ot(r.content.concat(this.subtract(r).content)):this},append:function(r){return r=ot.from(r),r.size?new ot(this.subtract(r).content.concat(r.content)):this},subtract:function(r){var e=this;r=ot.from(r);for(var t=0;t<r.content.length;t+=2)e=e.remove(r.content[t]);return e},toObject:function(){var r={};return this.forEach(function(e,t){r[e]=t}),r},get size(){return this.content.length>>1}};ot.from=function(r){if(r instanceof ot)return r;var e=[];if(r)for(var t in r)e.push(t,r[t]);return new ot(e)};function Mh(r,e,t){for(let n=0;;n++){if(n==r.childCount||n==e.childCount)return r.childCount==e.childCount?null:t;let i=r.child(n),o=e.child(n);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let a=0;i.text[a]==o.text[a];a++)t++;return t}if(i.content.size||o.content.size){let a=Mh(i.content,o.content,t+1);if(a!=null)return a}t+=i.nodeSize}}function Th(r,e,t,n){for(let i=r.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:n};let a=r.child(--i),u=e.child(--o),f=a.nodeSize;if(a==u){t-=f,n-=f;continue}if(!a.sameMarkup(u))return{a:t,b:n};if(a.isText&&a.text!=u.text){let d=0,p=Math.min(a.text.length,u.text.length);for(;d<p&&a.text[a.text.length-d-1]==u.text[u.text.length-d-1];)d++,t--,n--;return{a:t,b:n}}if(a.content.size||u.content.size){let d=Th(a.content,u.content,t-1,n-1);if(d)return d}t-=f,n-=f}}class ${constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,i=0,o){for(let a=0,u=0;u<t;a++){let f=this.content[a],d=u+f.nodeSize;if(d>e&&n(f,i+u,o||null,a)!==!1&&f.content.size){let p=u+1;f.nodesBetween(Math.max(0,e-p),Math.min(f.content.size,t-p),n,i+p)}u=d}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,i){let o="",a=!0;return this.nodesBetween(e,t,(u,f)=>{let d=u.isText?u.text.slice(Math.max(e,f)-f,t-f):u.isLeaf?i?typeof i=="function"?i(u):i:u.type.spec.leafText?u.type.spec.leafText(u):"":"";u.isBlock&&(u.isLeaf&&d||u.isTextblock)&&n&&(a?a=!1:o+=n),o+=d},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(i[i.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new $(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let n=[],i=0;if(t>e)for(let o=0,a=0;a<t;o++){let u=this.content[o],f=a+u.nodeSize;f>e&&((a<e||f>t)&&(u.isText?u=u.cut(Math.max(0,e-a),Math.min(u.text.length,t-a)):u=u.cut(Math.max(0,e-a-1),Math.min(u.content.size,t-a-1))),n.push(u),i+=u.nodeSize),a=f}return new $(n,i)}cutByIndex(e,t){return e==t?$.empty:e==0&&t==this.content.length?this:new $(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return i[e]=t,new $(i,o)}addToStart(e){return new $([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new $(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let i=this.content[t];e(i,n,t),n+=i.nodeSize}}findDiffStart(e,t=0){return Mh(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return Th(this,e,t,n)}findIndex(e,t=-1){if(e==0)return Ys(0,e);if(e==this.size)return Ys(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,i=0;;n++){let o=this.child(n),a=i+o.nodeSize;if(a>=e)return a==e||t>0?Ys(n+1,a):Ys(n,i);i=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return $.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new $(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return $.empty;let t,n=0;for(let i=0;i<e.length;i++){let o=e[i];n+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new $(t||e,n)}static from(e){if(!e)return $.empty;if(e instanceof $)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new $([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}$.empty=new $([],0);const la={index:0,offset:0};function Ys(r,e){return la.index=r,la.offset=e,la}function lo(r,e){if(r===e)return!0;if(!(r&&typeof r=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(r);if(Array.isArray(e)!=t)return!1;if(t){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(!lo(r[n],e[n]))return!1}else{for(let n in r)if(!(n in e)||!lo(r[n],e[n]))return!1;for(let n in e)if(!(n in r))return!1}return!0}let Ne=class Aa{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&lo(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=n.create(t.attrs);return n.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Aa.none;if(e instanceof Aa)return[e];let t=e.slice();return t.sort((n,i)=>n.type.rank-i.type.rank),t}};Ne.none=[];class ao extends Error{}class U{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=Ah(this.content,e+this.openStart,t);return n&&new U(n,this.openStart,this.openEnd)}removeBetween(e,t){return new U(Oh(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return U.empty;let n=t.openStart||0,i=t.openEnd||0;if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new U($.fromJSON(e,t.content),n,i)}static maxOpen(e,t=!0){let n=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new U(e,n,i)}}U.empty=new U($.empty,0,0);function Oh(r,e,t){let{index:n,offset:i}=r.findIndex(e),o=r.maybeChild(n),{index:a,offset:u}=r.findIndex(t);if(i==e||o.isText){if(u!=t&&!r.child(a).isText)throw new RangeError("Removing non-flat range");return r.cut(0,e).append(r.cut(t))}if(n!=a)throw new RangeError("Removing non-flat range");return r.replaceChild(n,o.copy(Oh(o.content,e-i-1,t-i-1)))}function Ah(r,e,t,n){let{index:i,offset:o}=r.findIndex(e),a=r.maybeChild(i);if(o==e||a.isText)return r.cut(0,e).append(t).append(r.cut(e));let u=Ah(a.content,e-o-1,t);return u&&r.replaceChild(i,a.copy(u))}function _x(r,e,t){if(t.openStart>r.depth)throw new ao("Inserted content deeper than insertion position");if(r.depth-t.openStart!=e.depth-t.openEnd)throw new ao("Inconsistent open depths");return Eh(r,e,t,0)}function Eh(r,e,t,n){let i=r.index(n),o=r.node(n);if(i==e.index(n)&&n<r.depth-t.openStart){let a=Eh(r,e,t,n+1);return o.copy(o.content.replaceChild(i,a))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&r.depth==n&&e.depth==n){let a=r.parent,u=a.content;return Sr(a,u.cut(0,r.parentOffset).append(t.content).append(u.cut(e.parentOffset)))}else{let{start:a,end:u}=kx(t,r);return Sr(o,Nh(r,a,u,e,n))}else return Sr(o,uo(r,e,n))}function Dh(r,e){if(!e.type.compatibleContent(r.type))throw new ao("Cannot join "+e.type.name+" onto "+r.type.name)}function Ea(r,e,t){let n=r.node(t);return Dh(n,e.node(t)),n}function kr(r,e){let t=e.length-1;t>=0&&r.isText&&r.sameMarkup(e[t])?e[t]=r.withText(e[t].text+r.text):e.push(r)}function Li(r,e,t,n){let i=(e||r).node(t),o=0,a=e?e.index(t):i.childCount;r&&(o=r.index(t),r.depth>t?o++:r.textOffset&&(kr(r.nodeAfter,n),o++));for(let u=o;u<a;u++)kr(i.child(u),n);e&&e.depth==t&&e.textOffset&&kr(e.nodeBefore,n)}function Sr(r,e){return r.type.checkContent(e),r.copy(e)}function Nh(r,e,t,n,i){let o=r.depth>i&&Ea(r,e,i+1),a=n.depth>i&&Ea(t,n,i+1),u=[];return Li(null,r,i,u),o&&a&&e.index(i)==t.index(i)?(Dh(o,a),kr(Sr(o,Nh(r,e,t,n,i+1)),u)):(o&&kr(Sr(o,uo(r,e,i+1)),u),Li(e,t,i,u),a&&kr(Sr(a,uo(t,n,i+1)),u)),Li(n,null,i,u),new $(u)}function uo(r,e,t){let n=[];if(Li(null,r,t,n),r.depth>t){let i=Ea(r,e,t+1);kr(Sr(i,uo(r,e,t+1)),n)}return Li(e,null,t,n),new $(n)}function kx(r,e){let t=e.depth-r.openStart,i=e.node(t).copy(r.content);for(let o=t-1;o>=0;o--)i=e.node(o).copy($.from(i));return{start:i.resolveNoCache(r.openStart+t),end:i.resolveNoCache(i.content.size-r.openEnd-t)}}class Wi{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=e.child(t);return n?e.child(t).cut(n):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)i+=n.child(o).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Ne.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),i=e.maybeChild(t);if(!n){let u=n;n=i,i=u}let o=n.marks;for(var a=0;a<o.length;a++)o[a].type.spec.inclusive===!1&&(!i||!o[a].isInSet(i.marks))&&(o=o[a--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<n.length;o++)n[o].type.spec.inclusive===!1&&(!i||!n[o].isInSet(i.marks))&&(n=n[o--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new co(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],i=0,o=t;for(let a=e;;){let{index:u,offset:f}=a.content.findIndex(o),d=o-f;if(n.push(a,u,i+f),!d||(a=a.child(u),a.isText))break;o=d-1,i+=f+1}return new Wi(t,n,o)}static resolveCached(e,t){let n=rd.get(e);if(n)for(let o=0;o<n.elts.length;o++){let a=n.elts[o];if(a.pos==t)return a}else rd.set(e,n=new Sx);let i=n.elts[n.i]=Wi.resolve(e,t);return n.i=(n.i+1)%Cx,i}}class Sx{constructor(){this.elts=[],this.i=0}}const Cx=12,rd=new WeakMap;class co{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Mx=Object.create(null);let jn=class Da{constructor(e,t,n,i=Ne.none){this.type=e,this.attrs=t,this.marks=i,this.content=n||$.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,i=0){this.content.nodesBetween(e,t,n,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,i){return this.content.textBetween(e,t,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&lo(this.attrs,t||e.defaultAttrs||Mx)&&Ne.sameSet(this.marks,n||Ne.none)}copy(e=null){return e==this.content?this:new Da(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Da(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return U.empty;let i=this.resolve(e),o=this.resolve(t),a=n?0:i.sharedDepth(t),u=i.start(a),d=i.node(a).content.cut(i.pos-u,o.pos-u);return new U(d,i.depth-a,o.depth-a)}replace(e,t,n){return _x(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let i=this.content.child(t-1);return{node:i,index:t-1,offset:n-i.nodeSize}}resolve(e){return Wi.resolveCached(this,e)}resolveNoCache(e){return Wi.resolve(this,e)}rangeHasMark(e,t,n){let i=!1;return t>e&&this.nodesBetween(e,t,o=>(n.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Ih(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=$.empty,i=0,o=n.childCount){let a=this.contentMatchAt(e).matchFragment(n,i,o),u=a&&a.matchFragment(this.content,t);if(!u||!u.validEnd)return!1;for(let f=i;f<o;f++)if(!this.type.allowsMarks(n.child(f).marks))return!1;return!0}canReplaceWith(e,t,n,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(n),a=o&&o.matchFragment(this.content,t);return a?a.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Ne.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!Ne.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let i=$.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,i,n);return o.type.checkAttrs(o.attrs),o}};jn.prototype.text=void 0;class fo extends jn{constructor(e,t,n,i){if(super(e,t,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Ih(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new fo(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new fo(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Ih(r,e){for(let t=r.length-1;t>=0;t--)e=r[t].type.name+"("+e+")";return e}class Or{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new Tx(e,t);if(n.next==null)return Or.empty;let i=Rh(n);n.next&&n.err("Unexpected trailing text");let o=Rx(Ix(i));return Px(o,n),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let i=this;for(let o=t;i&&o<n;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let i=[this];function o(a,u){let f=a.matchFragment(e,n);if(f&&(!t||f.validEnd))return $.from(u.map(d=>d.createAndFill()));for(let d=0;d<a.next.length;d++){let{type:p,next:m}=a.next[d];if(!(p.isText||p.hasRequiredAttrs())&&i.indexOf(m)==-1){i.push(m);let y=o(m,u.concat(p));if(y)return y}}return null}return o(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),o=i.match;if(o.matchType(e)){let a=[];for(let u=i;u.type;u=u.via)a.push(u.type);return a.reverse()}for(let a=0;a<o.next.length;a++){let{type:u,next:f}=o.next[a];!u.isLeaf&&!u.hasRequiredAttrs()&&!(u.name in t)&&(!i.type||f.validEnd)&&(n.push({match:u.contentMatch,type:u,via:i}),t[u.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(n){e.push(n);for(let i=0;i<n.next.length;i++)e.indexOf(n.next[i].next)==-1&&t(n.next[i].next)}return t(this),e.map((n,i)=>{let o=i+(n.validEnd?"*":" ")+" ";for(let a=0;a<n.next.length;a++)o+=(a?", ":"")+n.next[a].type.name+"->"+e.indexOf(n.next[a].next);return o}).join(`
`)}}Or.empty=new Or(!0);class Tx{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Rh(r){let e=[];do e.push(Ox(r));while(r.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function Ox(r){let e=[];do e.push(Ax(r));while(r.next&&r.next!=")"&&r.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function Ax(r){let e=Nx(r);for(;;)if(r.eat("+"))e={type:"plus",expr:e};else if(r.eat("*"))e={type:"star",expr:e};else if(r.eat("?"))e={type:"opt",expr:e};else if(r.eat("{"))e=Ex(r,e);else break;return e}function id(r){/\D/.test(r.next)&&r.err("Expected number, got '"+r.next+"'");let e=Number(r.next);return r.pos++,e}function Ex(r,e){let t=id(r),n=t;return r.eat(",")&&(r.next!="}"?n=id(r):n=-1),r.eat("}")||r.err("Unclosed braced range"),{type:"range",min:t,max:n,expr:e}}function Dx(r,e){let t=r.nodeTypes,n=t[e];if(n)return[n];let i=[];for(let o in t){let a=t[o];a.isInGroup(e)&&i.push(a)}return i.length==0&&r.err("No node type or group '"+e+"' found"),i}function Nx(r){if(r.eat("(")){let e=Rh(r);return r.eat(")")||r.err("Missing closing paren"),e}else if(/\W/.test(r.next))r.err("Unexpected token '"+r.next+"'");else{let e=Dx(r,r.next).map(t=>(r.inline==null?r.inline=t.isInline:r.inline!=t.isInline&&r.err("Mixing inline and block content"),{type:"name",value:t}));return r.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Ix(r){let e=[[]];return i(o(r,0),t()),e;function t(){return e.push([])-1}function n(a,u,f){let d={term:f,to:u};return e[a].push(d),d}function i(a,u){a.forEach(f=>f.to=u)}function o(a,u){if(a.type=="choice")return a.exprs.reduce((f,d)=>f.concat(o(d,u)),[]);if(a.type=="seq")for(let f=0;;f++){let d=o(a.exprs[f],u);if(f==a.exprs.length-1)return d;i(d,u=t())}else if(a.type=="star"){let f=t();return n(u,f),i(o(a.expr,f),f),[n(f)]}else if(a.type=="plus"){let f=t();return i(o(a.expr,u),f),i(o(a.expr,f),f),[n(f)]}else{if(a.type=="opt")return[n(u)].concat(o(a.expr,u));if(a.type=="range"){let f=u;for(let d=0;d<a.min;d++){let p=t();i(o(a.expr,f),p),f=p}if(a.max==-1)i(o(a.expr,f),f);else for(let d=a.min;d<a.max;d++){let p=t();n(f,p),i(o(a.expr,f),p),f=p}return[n(f)]}else{if(a.type=="name")return[n(u,void 0,a.value)];throw new Error("Unknown expr type")}}}}function Ph(r,e){return e-r}function sd(r,e){let t=[];return n(e),t.sort(Ph);function n(i){let o=r[i];if(o.length==1&&!o[0].term)return n(o[0].to);t.push(i);for(let a=0;a<o.length;a++){let{term:u,to:f}=o[a];!u&&t.indexOf(f)==-1&&n(f)}}}function Rx(r){let e=Object.create(null);return t(sd(r,0));function t(n){let i=[];n.forEach(a=>{r[a].forEach(({term:u,to:f})=>{if(!u)return;let d;for(let p=0;p<i.length;p++)i[p][0]==u&&(d=i[p][1]);sd(r,f).forEach(p=>{d||i.push([u,d=[]]),d.indexOf(p)==-1&&d.push(p)})})});let o=e[n.join(",")]=new Or(n.indexOf(r.length-1)>-1);for(let a=0;a<i.length;a++){let u=i[a][1].sort(Ph);o.next.push({type:i[a][0],next:e[u.join(",")]||t(u)})}return o}}function Px(r,e){for(let t=0,n=[r];t<n.length;t++){let i=n[t],o=!i.validEnd,a=[];for(let u=0;u<i.next.length;u++){let{type:f,next:d}=i.next[u];a.push(f.name),o&&!(f.isText||f.hasRequiredAttrs())&&(o=!1),n.indexOf(d)==-1&&n.push(d)}o&&e.err("Only non-generatable nodes ("+a.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Lh(r){let e=Object.create(null);for(let t in r){let n=r[t];if(!n.hasDefault)return null;e[t]=n.default}return e}function Bh(r,e){let t=Object.create(null);for(let n in r){let i=e&&e[n];if(i===void 0){let o=r[n];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+n)}t[n]=i}return t}function Fh(r,e,t,n){for(let i in e)if(!(i in r))throw new RangeError(`Unsupported attribute ${i} for ${t} of type ${i}`);for(let i in r){let o=r[i];o.validate&&o.validate(e[i])}}function $h(r,e){let t=Object.create(null);if(e)for(let n in e)t[n]=new Bx(r,n,e[n]);return t}let od=class Vh{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=$h(e,n.attrs),this.defaultAttrs=Lh(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Or.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Bh(this.attrs,e)}create(e=null,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new jn(this,this.computeAttrs(e),$.from(t),Ne.setFrom(n))}createChecked(e=null,t,n){return t=$.from(t),this.checkContent(t),new jn(this,this.computeAttrs(e),t,Ne.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),t=$.from(t),t.size){let a=this.contentMatch.fillBefore(t);if(!a)return null;t=a.append(t)}let i=this.contentMatch.matchFragment(t),o=i&&i.fillBefore($.empty,!0);return o?new jn(this,e,t.append(o),Ne.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Fh(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:Ne.none:e}static compile(e,t){let n=Object.create(null);e.forEach((o,a)=>n[o]=new Vh(o,t,a));let i=t.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function Lx(r,e,t){let n=t.split("|");return i=>{let o=i===null?"null":typeof i;if(n.indexOf(o)<0)throw new RangeError(`Expected value of type ${n} for attribute ${e} on type ${r}, got ${o}`)}}class Bx{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?Lx(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class Mo{constructor(e,t,n,i){this.name=e,this.rank=t,this.schema=n,this.spec=i,this.attrs=$h(e,i.attrs),this.excluded=null;let o=Lh(this.attrs);this.instance=o?new Ne(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Ne(this,Bh(this.attrs,e))}static compile(e,t){let n=Object.create(null),i=0;return e.forEach((o,a)=>n[o]=new Mo(o,i++,t,a)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Fh(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class zh{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=ot.from(e.nodes),t.marks=ot.from(e.marks||{}),this.nodes=od.compile(this.spec.nodes,this),this.marks=Mo.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],a=o.spec.content||"",u=o.spec.marks;if(o.contentMatch=n[a]||(n[a]=Or.parse(a,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=u=="_"?null:u?ld(this,u.split(" ")):u==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],a=o.spec.excludes;o.excluded=a==null?[o]:a==""?[]:ld(this,a.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof od){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,n,i)}text(e,t){let n=this.nodes.text;return new fo(n,n.defaultAttrs,e,Ne.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return jn.fromJSON(this,e)}markFromJSON(e){return Ne.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function ld(r,e){let t=[];for(let n=0;n<e.length;n++){let i=e[n],o=r.marks[i],a=o;if(o)t.push(o);else for(let u in r.marks){let f=r.marks[u];(i=="_"||f.spec.group&&f.spec.group.split(" ").indexOf(i)>-1)&&t.push(a=f)}if(!a)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return t}function Fx(r){return r.tag!=null}function $x(r){return r.style!=null}class Xn{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(i=>{if(Fx(i))this.tags.push(i);else if($x(i)){let o=/[^=]*/.exec(i.style)[0];n.indexOf(o)<0&&n.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let n=new ud(this,t,!1);return n.addAll(e,Ne.none,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new ud(this,t,!0);return n.addAll(e,Ne.none,t.from,t.to),U.maxOpen(n.finish())}matchTag(e,t,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(Wx(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let a=o.getAttrs(e);if(a===!1)continue;o.attrs=a||void 0}return o}}}matchStyle(e,t,n,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let a=this.styles[o],u=a.style;if(!(u.indexOf(e)!=0||a.context&&!n.matchesContext(a.context)||u.length>e.length&&(u.charCodeAt(e.length)!=61||u.slice(e.length+1)!=t))){if(a.getAttrs){let f=a.getAttrs(t);if(f===!1)continue;a.attrs=f||void 0}return a}}}static schemaRules(e){let t=[];function n(i){let o=i.priority==null?50:i.priority,a=0;for(;a<t.length;a++){let u=t[a];if((u.priority==null?50:u.priority)<o)break}t.splice(a,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(a=>{n(a=cd(a)),a.mark||a.ignore||a.clearMark||(a.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(a=>{n(a=cd(a)),a.node||a.ignore||a.mark||(a.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Xn(e,Xn.schemaRules(e)))}}const Wh={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Vx={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},qh={ol:!0,ul:!0},qi=1,Na=2,no=4;function ad(r,e,t){return e!=null?(e?qi:0)|(e==="full"?Na:0):r&&r.whitespace=="pre"?qi|Na:t&-5}class js{constructor(e,t,n,i,o,a){this.type=e,this.attrs=t,this.marks=n,this.solid=i,this.options=a,this.content=[],this.activeMarks=Ne.none,this.match=o||(a&no?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore($.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let n=this.type.contentMatch,i;return(i=n.findWrapping(e.type))?(this.match=n,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&qi)){let n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let o=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=$.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore($.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Wh.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class ud{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let i=t.topNode,o,a=ad(null,t.preserveWhitespace,0)|(n?no:0);i?o=new js(i.type,i.attrs,Ne.none,!0,t.topMatch||i.type.contentMatch,a):n?o=new js(null,null,Ne.none,!0,null,a):o=new js(e.schema.topNodeType,null,Ne.none,!0,null,a),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,i=this.top,o=i.options&Na?"full":this.localPreserveWS||(i.options&qi)>0;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(o)o!=="full"?n=n.replace(/\r?\n|\r/g," "):n=n.replace(/\r\n?/g,`
`);else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let a=i.content[i.content.length-1],u=e.previousSibling;(!a||u&&u.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let a=e.nodeName.toLowerCase(),u;qh.hasOwnProperty(a)&&this.parser.normalizeLists&&zx(e);let f=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(u=this.parser.matchTag(e,this,n));e:if(f?f.ignore:Vx.hasOwnProperty(a))this.findInside(e),this.ignoreFallback(e,t);else if(!f||f.skip||f.closeParent){f&&f.closeParent?this.open=Math.max(0,this.open-1):f&&f.skip.nodeType&&(e=f.skip);let d,p=this.needsBlock;if(Wh.hasOwnProperty(a))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),d=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let m=f&&f.skip?t:this.readStyles(e,t);m&&this.addAll(e,m),d&&this.sync(o),this.needsBlock=p}else{let d=this.readStyles(e,t);d&&this.addElementByRule(e,f,d,f.consuming===!1?u:void 0)}this.localPreserveWS=i}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],a=n.getPropertyValue(o);if(a)for(let u=void 0;;){let f=this.parser.matchStyle(o,a,this,u);if(!f)break;if(f.ignore)return null;if(f.clearMark?t=t.filter(d=>!f.clearMark(d)):t=t.concat(this.parser.schema.marks[f.mark].create(f.attrs)),f.consuming===!1)u=f;else break}}return t}addElementByRule(e,t,n,i){let o,a;if(t.node)if(a=this.parser.schema.nodes[t.node],a.isLeaf)this.insertNode(a.create(t.attrs),n,e.nodeName=="BR")||this.leafFallback(e,n);else{let f=this.enter(a,t.attrs||null,n,t.preserveWhitespace);f&&(o=!0,n=f)}else{let f=this.parser.schema.marks[t.mark];n=n.concat(f.create(t.attrs))}let u=this.top;if(a&&a.isLeaf)this.findInside(e);else if(i)this.addElement(e,n,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(f=>this.insertNode(f,n,!1));else{let f=e;typeof t.contentElement=="string"?f=e.querySelector(t.contentElement):typeof t.contentElement=="function"?f=t.contentElement(e):t.contentElement&&(f=t.contentElement),this.findAround(e,f,!0),this.addAll(f,n),this.findAround(e,f,!1)}o&&this.sync(u)&&this.open--}addAll(e,t,n,i){let o=n||0;for(let a=n?e.childNodes[n]:e.firstChild,u=i==null?null:e.childNodes[i];a!=u;a=a.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(a,t);this.findAtPoint(e,o)}findPlace(e,t,n){let i,o;for(let a=this.open,u=0;a>=0;a--){let f=this.nodes[a],d=f.findWrapping(e);if(d&&(!i||i.length>d.length+u)&&(i=d,o=f,!d.length))break;if(f.solid){if(n)break;u+=2}}if(!i)return null;this.sync(o);for(let a=0;a<i.length;a++)t=this.enterInner(i[a],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(t=this.enterInner(o,null,t))}let i=this.findPlace(e,t,n);if(i){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(e.type));let a=Ne.none;for(let u of i.concat(e.marks))(o.type?o.type.allowsMarkType(u.type):fd(u.type,e.type))&&(a=u.addToSet(a));return o.content.push(e.mark(a)),!0}return!1}enter(e,t,n,i){let o=this.findPlace(e.create(t),n,!1);return o&&(o=this.enterInner(e,t,n,!0,i)),o}enterInner(e,t,n,i=!1,o){this.closeExtra();let a=this.top;a.match=a.match&&a.match.matchType(e);let u=ad(e,o,a.options);a.options&no&&a.content.length==0&&(u|=no);let f=Ne.none;return n=n.filter(d=>(a.type?a.type.allowsMarkType(d.type):fd(d.type,e))?(f=d.addToSet(f),!1):!0),this.nodes.push(new js(e,t,f,i,null,u)),this.open++,n}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=qi)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let i=n.length-1;i>=0;i--)e+=n[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,i=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),o=-(n?n.depth+1:0)+(i?0:1),a=(u,f)=>{for(;u>=0;u--){let d=t[u];if(d==""){if(u==t.length-1||u==0)continue;for(;f>=o;f--)if(a(u-1,f))return!0;return!1}else{let p=f>0||f==0&&i?this.nodes[f].type:n&&f>=o?n.node(f-o).type:null;if(!p||p.name!=d&&!p.isInGroup(d))return!1;f--}}return!0};return a(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let n=this.parser.schema.nodes[t];if(n.isTextblock&&n.defaultAttrs)return n}}}function zx(r){for(let e=r.firstChild,t=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&qh.hasOwnProperty(n)&&t?(t.appendChild(e),e=t):n=="li"?t=e:n&&(t=null)}}function Wx(r,e){return(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,e)}function cd(r){let e={};for(let t in r)e[t]=r[t];return e}function fd(r,e){let t=e.schema.nodes;for(let n in t){let i=t[n];if(!i.allowsMarkType(r))continue;let o=[],a=u=>{o.push(u);for(let f=0;f<u.edgeCount;f++){let{type:d,next:p}=u.edge(f);if(d==e||o.indexOf(p)<0&&a(p))return!0}};if(a(i.contentMatch))return!0}}class Nr{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=aa(t).createDocumentFragment());let i=n,o=[];return e.forEach(a=>{if(o.length||a.marks.length){let u=0,f=0;for(;u<o.length&&f<a.marks.length;){let d=a.marks[f];if(!this.marks[d.type.name]){f++;continue}if(!d.eq(o[u][0])||d.type.spec.spanning===!1)break;u++,f++}for(;u<o.length;)i=o.pop()[1];for(;f<a.marks.length;){let d=a.marks[f++],p=this.serializeMark(d,a.isInline,t);p&&(o.push([d,i]),i.appendChild(p.dom),i=p.contentDOM||p.dom)}}i.appendChild(this.serializeNodeInner(a,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:i}=ro(aa(t),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(e,t,n={}){let i=this.marks[e.type.name];return i&&ro(aa(n),i(e,t),null,e.attrs)}static renderSpec(e,t,n=null,i){return ro(e,t,n,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Nr(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=dd(e.nodes);return t.text||(t.text=n=>n.text),t}static marksFromSchema(e){return dd(e.marks)}}function dd(r){let e={};for(let t in r){let n=r[t].spec.toDOM;n&&(e[t]=n)}return e}function aa(r){return r.document||window.document}const hd=new WeakMap;function qx(r){let e=hd.get(r);return e===void 0&&hd.set(r,e=Hx(r)),e}function Hx(r){let e=null;function t(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")e||(e=[]),e.push(n);else for(let i=0;i<n.length;i++)t(n[i]);else for(let i in n)t(n[i])}return t(r),e}function ro(r,e,t,n){if(typeof e=="string")return{dom:r.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(o=qx(n))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let a=i.indexOf(" ");a>0&&(t=i.slice(0,a),i=i.slice(a+1));let u,f=t?r.createElementNS(t,i):r.createElement(i),d=e[1],p=1;if(d&&typeof d=="object"&&d.nodeType==null&&!Array.isArray(d)){p=2;for(let m in d)if(d[m]!=null){let y=m.indexOf(" ");y>0?f.setAttributeNS(m.slice(0,y),m.slice(y+1),d[m]):f.setAttribute(m,d[m])}}for(let m=p;m<e.length;m++){let y=e[m];if(y===0){if(m<e.length-1||m>p)throw new RangeError("Content hole must be the only child of its parent node");return{dom:f,contentDOM:f}}else{let{dom:v,contentDOM:x}=ro(r,y,t,n);if(f.appendChild(v),x){if(u)throw new RangeError("Multiple content holes");u=x}}}return{dom:f,contentDOM:u}}const Hh=65535,Uh=Math.pow(2,16);function Ux(r,e){return r+e*Uh}function pd(r){return r&Hh}function Jx(r){return(r-(r&Hh))/Uh}const Jh=1,Kh=2,io=4,Gh=8;class Ia{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(this.delInfo&Gh)>0}get deletedBefore(){return(this.delInfo&(Jh|io))>0}get deletedAfter(){return(this.delInfo&(Kh|io))>0}get deletedAcross(){return(this.delInfo&io)>0}}class Vt{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Vt.empty)return Vt.empty}recover(e){let t=0,n=pd(e);if(!this.inverted)for(let i=0;i<n;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[n*3]+t+Jx(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let i=0,o=this.inverted?2:1,a=this.inverted?1:2;for(let u=0;u<this.ranges.length;u+=3){let f=this.ranges[u]-(this.inverted?i:0);if(f>e)break;let d=this.ranges[u+o],p=this.ranges[u+a],m=f+d;if(e<=m){let y=d?e==f?-1:e==m?1:t:t,v=f+i+(y<0?0:p);if(n)return v;let x=e==(t<0?f:m)?null:Ux(u/3,e-f),b=e==f?Kh:e==m?Jh:io;return(t<0?e!=f:e!=m)&&(b|=Gh),new Ia(v,b,x)}i+=p-d}return n?e+i:new Ia(e+i,0,null)}touches(e,t){let n=0,i=pd(t),o=this.inverted?2:1,a=this.inverted?1:2;for(let u=0;u<this.ranges.length;u+=3){let f=this.ranges[u]-(this.inverted?n:0);if(f>e)break;let d=this.ranges[u+o],p=f+d;if(e<=p&&u==i*3)return!0;n+=this.ranges[u+a]-d}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let a=this.ranges[i],u=a-(this.inverted?o:0),f=a+(this.inverted?0:o),d=this.ranges[i+t],p=this.ranges[i+n];e(u,u+d,f,f+p),o+=p-d}}invert(){return new Vt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Vt.empty:new Vt(e<0?[0,-e,0]:[0,0,e])}}Vt.empty=new Vt([]);class Hi{constructor(e,t,n=0,i=e?e.length:0){this.mirror=t,this.from=n,this.to=i,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new Hi(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let i=e.getMirror(t);this.appendMap(e._maps[t],i!=null&&i<t?n+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e._maps[t].invert(),i!=null&&i>t?n-i-1:void 0)}}invert(){let e=new Hi;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let i=0;for(let o=this.from;o<this.to;o++){let a=this._maps[o],u=a.mapResult(e,t);if(u.recover!=null){let f=this.getMirror(o);if(f!=null&&f>o&&f<this.to){o=f,e=this._maps[f].recover(u.recover);continue}}i|=u.delInfo,e=u.pos}return n?e:new Ia(e,i,null)}}const ua=Object.create(null);class pt{getMap(){return Vt.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=ua[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in ua)throw new RangeError("Duplicate use of step JSON ID "+e);return ua[e]=t,t.prototype.jsonID=e,t}}class Ue{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Ue(e,null)}static fail(e){return new Ue(null,e)}static fromReplace(e,t,n,i){try{return Ue.ok(e.replace(t,n,i))}catch(o){if(o instanceof ao)return Ue.fail(o.message);throw o}}}function Qa(r,e,t){let n=[];for(let i=0;i<r.childCount;i++){let o=r.child(i);o.content.size&&(o=o.copy(Qa(o.content,e,o))),o.isInline&&(o=e(o,t,i)),n.push(o)}return $.fromArray(n)}class Kn extends pt{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),o=new U(Qa(t.content,(a,u)=>!a.isAtom||!u.type.allowsMarkType(this.mark.type)?a:a.mark(this.mark.addToSet(a.marks)),i),t.openStart,t.openEnd);return Ue.fromReplace(e,this.from,this.to,o)}invert(){return new pn(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new Kn(t.pos,n.pos,this.mark)}merge(e){return e instanceof Kn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Kn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Kn(t.from,t.to,e.markFromJSON(t.mark))}}pt.jsonID("addMark",Kn);class pn extends pt{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new U(Qa(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Ue.fromReplace(e,this.from,this.to,n)}invert(){return new Kn(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new pn(t.pos,n.pos,this.mark)}merge(e){return e instanceof pn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new pn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new pn(t.from,t.to,e.markFromJSON(t.mark))}}pt.jsonID("removeMark",pn);class Gn extends pt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ue.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Ue.fromReplace(e,this.pos,this.pos+1,new U($.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let n=this.mark.addToSet(t.marks);if(n.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(n))return new Gn(this.pos,t.marks[i]);return new Gn(this.pos,this.mark)}}return new Ar(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Gn(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Gn(t.pos,e.markFromJSON(t.mark))}}pt.jsonID("addNodeMark",Gn);class Ar extends pt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ue.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Ue.fromReplace(e,this.pos,this.pos+1,new U($.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Gn(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ar(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ar(t.pos,e.markFromJSON(t.mark))}}pt.jsonID("removeNodeMark",Ar);class Xe extends pt{constructor(e,t,n,i=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=i}apply(e){return this.structure&&Ra(e,this.from,this.to)?Ue.fail("Structure replace would overwrite content"):Ue.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Vt([this.from,this.to-this.from,this.slice.size])}invert(e){return new Xe(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new Xe(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Xe)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?U.empty:new U(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Xe(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?U.empty:new U(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Xe(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Xe(t.from,t.to,U.fromJSON(e,t.slice),!!t.structure)}}pt.jsonID("replace",Xe);class Ze extends pt{constructor(e,t,n,i,o,a,u=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=i,this.slice=o,this.insert=a,this.structure=u}apply(e){if(this.structure&&(Ra(e,this.from,this.gapFrom)||Ra(e,this.gapTo,this.to)))return Ue.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Ue.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?Ue.fromReplace(e,this.from,this.to,n):Ue.fail("Content does not fit in gap")}getMap(){return new Vt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Ze(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||i<t.pos||o>n.pos?null:new Ze(t.pos,n.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ze(t.from,t.to,t.gapFrom,t.gapTo,U.fromJSON(e,t.slice),t.insert,!!t.structure)}}pt.jsonID("replaceAround",Ze);function Ra(r,e,t){let n=r.resolve(e),i=t-e,o=n.depth;for(;i>0&&o>0&&n.indexAfter(o)==n.node(o).childCount;)o--,i--;if(i>0){let a=n.node(o).maybeChild(n.indexAfter(o));for(;i>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,i--}}return!1}function Kx(r,e,t,n){let i=[],o=[],a,u;r.doc.nodesBetween(e,t,(f,d,p)=>{if(!f.isInline)return;let m=f.marks;if(!n.isInSet(m)&&p.type.allowsMarkType(n.type)){let y=Math.max(d,e),v=Math.min(d+f.nodeSize,t),x=n.addToSet(m);for(let b=0;b<m.length;b++)m[b].isInSet(x)||(a&&a.to==y&&a.mark.eq(m[b])?a.to=v:i.push(a=new pn(y,v,m[b])));u&&u.to==y?u.to=v:o.push(u=new Kn(y,v,n))}}),i.forEach(f=>r.step(f)),o.forEach(f=>r.step(f))}function Gx(r,e,t,n){let i=[],o=0;r.doc.nodesBetween(e,t,(a,u)=>{if(!a.isInline)return;o++;let f=null;if(n instanceof Mo){let d=a.marks,p;for(;p=n.isInSet(d);)(f||(f=[])).push(p),d=p.removeFromSet(d)}else n?n.isInSet(a.marks)&&(f=[n]):f=a.marks;if(f&&f.length){let d=Math.min(u+a.nodeSize,t);for(let p=0;p<f.length;p++){let m=f[p],y;for(let v=0;v<i.length;v++){let x=i[v];x.step==o-1&&m.eq(i[v].style)&&(y=x)}y?(y.to=d,y.step=o):i.push({style:m,from:Math.max(u,e),to:d,step:o})}}}),i.forEach(a=>r.step(new pn(a.from,a.to,a.style)))}function eu(r,e,t,n=t.contentMatch,i=!0){let o=r.doc.nodeAt(e),a=[],u=e+1;for(let f=0;f<o.childCount;f++){let d=o.child(f),p=u+d.nodeSize,m=n.matchType(d.type);if(!m)a.push(new Xe(u,p,U.empty));else{n=m;for(let y=0;y<d.marks.length;y++)t.allowsMarkType(d.marks[y].type)||r.step(new pn(u,p,d.marks[y]));if(i&&d.isText&&t.whitespace!="pre"){let y,v=/\r?\n|\r/g,x;for(;y=v.exec(d.text);)x||(x=new U($.from(t.schema.text(" ",t.allowedMarks(d.marks))),0,0)),a.push(new Xe(u+y.index,u+y.index+y[0].length,x))}}u=p}if(!n.validEnd){let f=n.fillBefore($.empty,!0);r.replace(u,u,new U(f,0,0))}for(let f=a.length-1;f>=0;f--)r.step(a[f])}function Yx(r,e,t){return(e==0||r.canReplace(e,r.childCount))&&(t==r.childCount||r.canReplace(0,t))}function fi(r){let t=r.parent.content.cutByIndex(r.startIndex,r.endIndex);for(let n=r.depth;;--n){let i=r.$from.node(n),o=r.$from.index(n),a=r.$to.indexAfter(n);if(n<r.depth&&i.canReplace(o,a,t))return n;if(n==0||i.type.spec.isolating||!Yx(i,o,a))break}return null}function jx(r,e,t){let{$from:n,$to:i,depth:o}=e,a=n.before(o+1),u=i.after(o+1),f=a,d=u,p=$.empty,m=0;for(let x=o,b=!1;x>t;x--)b||n.index(x)>0?(b=!0,p=$.from(n.node(x).copy(p)),m++):f--;let y=$.empty,v=0;for(let x=o,b=!1;x>t;x--)b||i.after(x+1)<i.end(x)?(b=!0,y=$.from(i.node(x).copy(y)),v++):d++;r.step(new Ze(f,d,a,u,new U(p.append(y),m,v),p.size-m,!0))}function tu(r,e,t=null,n=r){let i=Xx(r,e),o=i&&Zx(n,e);return o?i.map(md).concat({type:e,attrs:t}).concat(o.map(md)):null}function md(r){return{type:r,attrs:null}}function Xx(r,e){let{parent:t,startIndex:n,endIndex:i}=r,o=t.contentMatchAt(n).findWrapping(e);if(!o)return null;let a=o.length?o[0]:e;return t.canReplaceWith(n,i,a)?o:null}function Zx(r,e){let{parent:t,startIndex:n,endIndex:i}=r,o=t.child(n),a=e.contentMatch.findWrapping(o.type);if(!a)return null;let f=(a.length?a[a.length-1]:e).contentMatch;for(let d=n;f&&d<i;d++)f=f.matchType(t.child(d).type);return!f||!f.validEnd?null:a}function Qx(r,e,t){let n=$.empty;for(let a=t.length-1;a>=0;a--){if(n.size){let u=t[a].type.contentMatch.matchFragment(n);if(!u||!u.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=$.from(t[a].type.create(t[a].attrs,n))}let i=e.start,o=e.end;r.step(new Ze(i,o,i,o,new U(n,0,0),t.length,!0))}function e_(r,e,t,n,i){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=r.steps.length;r.doc.nodesBetween(e,t,(a,u)=>{let f=typeof i=="function"?i(a):i;if(a.isTextblock&&!a.hasMarkup(n,f)&&t_(r.doc,r.mapping.slice(o).map(u),n)){let d=null;if(n.schema.linebreakReplacement){let v=n.whitespace=="pre",x=!!n.contentMatch.matchType(n.schema.linebreakReplacement);v&&!x?d=!1:!v&&x&&(d=!0)}d===!1&&jh(r,a,u,o),eu(r,r.mapping.slice(o).map(u,1),n,void 0,d===null);let p=r.mapping.slice(o),m=p.map(u,1),y=p.map(u+a.nodeSize,1);return r.step(new Ze(m,y,m+1,y-1,new U($.from(n.create(f,null,a.marks)),0,0),1,!0)),d===!0&&Yh(r,a,u,o),!1}})}function Yh(r,e,t,n){e.forEach((i,o)=>{if(i.isText){let a,u=/\r?\n|\r/g;for(;a=u.exec(i.text);){let f=r.mapping.slice(n).map(t+1+o+a.index);r.replaceWith(f,f+1,e.type.schema.linebreakReplacement.create())}}})}function jh(r,e,t,n){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let a=r.mapping.slice(n).map(t+1+o);r.replaceWith(a,a+1,e.type.schema.text(`
`))}})}function t_(r,e,t){let n=r.resolve(e),i=n.index();return n.parent.canReplaceWith(i,i+1,t)}function n_(r,e,t,n,i){let o=r.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let a=t.create(n,null,i||o.marks);if(o.isLeaf)return r.replaceWith(e,e+o.nodeSize,a);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);r.step(new Ze(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new U($.from(a),0,0),1,!0))}function Dn(r,e,t=1,n){let i=r.resolve(e),o=i.depth-t,a=n&&n[n.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!a.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let d=i.depth-1,p=t-2;d>o;d--,p--){let m=i.node(d),y=i.index(d);if(m.type.spec.isolating)return!1;let v=m.content.cutByIndex(y,m.childCount),x=n&&n[p+1];x&&(v=v.replaceChild(0,x.type.create(x.attrs)));let b=n&&n[p]||m;if(!m.canReplace(y+1,m.childCount)||!b.type.validContent(v))return!1}let u=i.indexAfter(o),f=n&&n[0];return i.node(o).canReplaceWith(u,u,f?f.type:i.node(o+1).type)}function r_(r,e,t=1,n){let i=r.doc.resolve(e),o=$.empty,a=$.empty;for(let u=i.depth,f=i.depth-t,d=t-1;u>f;u--,d--){o=$.from(i.node(u).copy(o));let p=n&&n[d];a=$.from(p?p.type.create(p.attrs,a):i.node(u).copy(a))}r.step(new Xe(e,e,new U(o.append(a),t,t),!0))}function rr(r,e){let t=r.resolve(e),n=t.index();return Xh(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(n,n+1)}function i_(r,e){e.content.size||r.type.compatibleContent(e.type);let t=r.contentMatchAt(r.childCount),{linebreakReplacement:n}=r.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),a=o.type==n?r.type.schema.nodes.text:o.type;if(t=t.matchType(a),!t||!r.type.allowsMarks(o.marks))return!1}return t.validEnd}function Xh(r,e){return!!(r&&e&&!r.isLeaf&&i_(r,e))}function To(r,e,t=-1){let n=r.resolve(e);for(let i=n.depth;;i--){let o,a,u=n.index(i);if(i==n.depth?(o=n.nodeBefore,a=n.nodeAfter):t>0?(o=n.node(i+1),u++,a=n.node(i).maybeChild(u)):(o=n.node(i).maybeChild(u-1),a=n.node(i+1)),o&&!o.isTextblock&&Xh(o,a)&&n.node(i).canReplace(u,u+1))return e;if(i==0)break;e=t<0?n.before(i):n.after(i)}}function s_(r,e,t){let n=null,{linebreakReplacement:i}=r.doc.type.schema,o=r.doc.resolve(e-t),a=o.node().type;if(i&&a.inlineContent){let p=a.whitespace=="pre",m=!!a.contentMatch.matchType(i);p&&!m?n=!1:!p&&m&&(n=!0)}let u=r.steps.length;if(n===!1){let p=r.doc.resolve(e+t);jh(r,p.node(),p.before(),u)}a.inlineContent&&eu(r,e+t-1,a,o.node().contentMatchAt(o.index()),n==null);let f=r.mapping.slice(u),d=f.map(e-t);if(r.step(new Xe(d,f.map(e+t,-1),U.empty,!0)),n===!0){let p=r.doc.resolve(d);Yh(r,p.node(),p.before(),r.steps.length)}return r}function o_(r,e,t){let n=r.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),t))return e;if(n.parentOffset==0)for(let i=n.depth-1;i>=0;i--){let o=n.index(i);if(n.node(i).canReplaceWith(o,o,t))return n.before(i+1);if(o>0)return null}if(n.parentOffset==n.parent.content.size)for(let i=n.depth-1;i>=0;i--){let o=n.indexAfter(i);if(n.node(i).canReplaceWith(o,o,t))return n.after(i+1);if(o<n.node(i).childCount)return null}return null}function Zh(r,e,t){let n=r.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let a=n.depth;a>=0;a--){let u=a==n.depth?0:n.pos<=(n.start(a+1)+n.end(a+1))/2?-1:1,f=n.index(a)+(u>0?1:0),d=n.node(a),p=!1;if(o==1)p=d.canReplace(f,f,i);else{let m=d.contentMatchAt(f).findWrapping(i.firstChild.type);p=m&&d.canReplaceWith(f,f,m[0])}if(p)return u==0?n.pos:u<0?n.before(a+1):n.after(a+1)}return null}function Oo(r,e,t=e,n=U.empty){if(e==t&&!n.size)return null;let i=r.resolve(e),o=r.resolve(t);return Qh(i,o,n)?new Xe(e,t,n):new l_(i,o,n).fit()}function Qh(r,e,t){return!t.openStart&&!t.openEnd&&r.start()==e.start()&&r.parent.canReplace(r.index(),e.index(),t.content)}class l_{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=$.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=$.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let d=this.findFittable();d?this.placeNodes(d):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let o=this.placed,a=n.depth,u=i.depth;for(;a&&u&&o.childCount==1;)o=o.firstChild.content,a--,u--;let f=new U(o,a,u);return e>-1?new Ze(n.pos,e,this.$to.pos,this.$to.end(),f,t):f.size||n.pos!=this.$to.pos?new Xe(n.pos,i.pos,f):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=n){e=n;break}t=o.content}for(let t=1;t<=2;t++)for(let n=t==1?e:this.unplaced.openStart;n>=0;n--){let i,o=null;n?(o=ca(this.unplaced.content,n-1).firstChild,i=o.content):i=this.unplaced.content;let a=i.firstChild;for(let u=this.depth;u>=0;u--){let{type:f,match:d}=this.frontier[u],p,m=null;if(t==1&&(a?d.matchType(a.type)||(m=d.fillBefore($.from(a),!1)):o&&f.compatibleContent(o.type)))return{sliceDepth:n,frontierDepth:u,parent:o,inject:m};if(t==2&&a&&(p=d.findWrapping(a.type)))return{sliceDepth:n,frontierDepth:u,parent:o,wrap:p};if(o&&d.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=ca(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new U(e,t+1,Math.max(n,i.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=ca(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new U(Ii(e,t-1,1),t-1,o?t-1:n)}else this.unplaced=new U(Ii(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let b=0;b<o.length;b++)this.openFrontierNode(o[b]);let a=this.unplaced,u=n?n.content:a.content,f=a.openStart-e,d=0,p=[],{match:m,type:y}=this.frontier[t];if(i){for(let b=0;b<i.childCount;b++)p.push(i.child(b));m=m.matchFragment(i)}let v=u.size+e-(a.content.size-a.openEnd);for(;d<u.childCount;){let b=u.child(d),S=m.matchType(b.type);if(!S)break;d++,(d>1||f==0||b.content.size)&&(m=S,p.push(ep(b.mark(y.allowedMarks(b.marks)),d==1?f:0,d==u.childCount?v:-1)))}let x=d==u.childCount;x||(v=-1),this.placed=Ri(this.placed,t,$.from(p)),this.frontier[t].match=m,x&&v<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let b=0,S=u;b<v;b++){let E=S.lastChild;this.frontier.push({type:E.type,match:E.contentMatchAt(E.childCount)}),S=E.content}this.unplaced=x?e==0?U.empty:new U(Ii(a.content,e-1,1),e-1,v<0?a.openEnd:e-1):new U(Ii(a.content,e,d),a.openStart,a.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!fa(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),a=fa(e,t,i,n,o);if(a){for(let u=t-1;u>=0;u--){let{match:f,type:d}=this.frontier[u],p=fa(e,u,d,f,!0);if(!p||p.childCount)continue e}return{depth:t,fit:a,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Ri(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let i=e.node(n),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(n));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Ri(this.placed,this.depth,$.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore($.empty,!0);t.childCount&&(this.placed=Ri(this.placed,this.frontier.length,t))}}function Ii(r,e,t){return e==0?r.cutByIndex(t,r.childCount):r.replaceChild(0,r.firstChild.copy(Ii(r.firstChild.content,e-1,t)))}function Ri(r,e,t){return e==0?r.append(t):r.replaceChild(r.childCount-1,r.lastChild.copy(Ri(r.lastChild.content,e-1,t)))}function ca(r,e){for(let t=0;t<e;t++)r=r.firstChild.content;return r}function ep(r,e,t){if(e<=0)return r;let n=r.content;return e>1&&(n=n.replaceChild(0,ep(n.firstChild,e-1,n.childCount==1?t-1:0))),e>0&&(n=r.type.contentMatch.fillBefore(n).append(n),t<=0&&(n=n.append(r.type.contentMatch.matchFragment(n).fillBefore($.empty,!0)))),r.copy(n)}function fa(r,e,t,n,i){let o=r.node(e),a=i?r.indexAfter(e):r.index(e);if(a==o.childCount&&!t.compatibleContent(o.type))return null;let u=n.fillBefore(o.content,!0,a);return u&&!a_(t,o.content,a)?u:null}function a_(r,e,t){for(let n=t;n<e.childCount;n++)if(!r.allowsMarks(e.child(n).marks))return!0;return!1}function u_(r){return r.spec.defining||r.spec.definingForContent}function c_(r,e,t,n){if(!n.size)return r.deleteRange(e,t);let i=r.doc.resolve(e),o=r.doc.resolve(t);if(Qh(i,o,n))return r.step(new Xe(e,t,n));let a=np(i,r.doc.resolve(t));a[a.length-1]==0&&a.pop();let u=-(i.depth+1);a.unshift(u);for(let y=i.depth,v=i.pos-1;y>0;y--,v--){let x=i.node(y).type.spec;if(x.defining||x.definingAsContext||x.isolating)break;a.indexOf(y)>-1?u=y:i.before(y)==v&&a.splice(1,0,-y)}let f=a.indexOf(u),d=[],p=n.openStart;for(let y=n.content,v=0;;v++){let x=y.firstChild;if(d.push(x),v==n.openStart)break;y=x.content}for(let y=p-1;y>=0;y--){let v=d[y],x=u_(v.type);if(x&&!v.sameMarkup(i.node(Math.abs(u)-1)))p=y;else if(x||!v.type.isTextblock)break}for(let y=n.openStart;y>=0;y--){let v=(y+p+1)%(n.openStart+1),x=d[v];if(x)for(let b=0;b<a.length;b++){let S=a[(b+f)%a.length],E=!0;S<0&&(E=!1,S=-S);let Z=i.node(S-1),te=i.index(S-1);if(Z.canReplaceWith(te,te,x.type,x.marks))return r.replace(i.before(S),E?o.after(S):t,new U(tp(n.content,0,n.openStart,v),v,n.openEnd))}}let m=r.steps.length;for(let y=a.length-1;y>=0&&(r.replace(e,t,n),!(r.steps.length>m));y--){let v=a[y];v<0||(e=i.before(v),t=o.after(v))}}function tp(r,e,t,n,i){if(e<t){let o=r.firstChild;r=r.replaceChild(0,o.copy(tp(o.content,e+1,t,n,o)))}if(e>n){let o=i.contentMatchAt(0),a=o.fillBefore(r).append(r);r=a.append(o.matchFragment(a).fillBefore($.empty,!0))}return r}function f_(r,e,t,n){if(!n.isInline&&e==t&&r.doc.resolve(e).parent.content.size){let i=o_(r.doc,e,n.type);i!=null&&(e=t=i)}r.replaceRange(e,t,new U($.from(n),0,0))}function d_(r,e,t){let n=r.doc.resolve(e),i=r.doc.resolve(t),o=np(n,i);for(let a=0;a<o.length;a++){let u=o[a],f=a==o.length-1;if(f&&u==0||n.node(u).type.contentMatch.validEnd)return r.delete(n.start(u),i.end(u));if(u>0&&(f||n.node(u-1).canReplace(n.index(u-1),i.indexAfter(u-1))))return r.delete(n.before(u),i.after(u))}for(let a=1;a<=n.depth&&a<=i.depth;a++)if(e-n.start(a)==n.depth-a&&t>n.end(a)&&i.end(a)-t!=i.depth-a&&n.start(a-1)==i.start(a-1)&&n.node(a-1).canReplace(n.index(a-1),i.index(a-1)))return r.delete(n.before(a),t);r.delete(e,t)}function np(r,e){let t=[],n=Math.min(r.depth,e.depth);for(let i=n;i>=0;i--){let o=r.start(i);if(o<r.pos-(r.depth-i)||e.end(i)>e.pos+(e.depth-i)||r.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==r.depth&&i==e.depth&&r.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}class ti extends pt{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ue.fail("No node at attribute step's position");let n=Object.create(null);for(let o in t.attrs)n[o]=t.attrs[o];n[this.attr]=this.value;let i=t.type.create(n,null,t.marks);return Ue.fromReplace(e,this.pos,this.pos+1,new U($.from(i),0,t.isLeaf?0:1))}getMap(){return Vt.empty}invert(e){return new ti(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ti(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new ti(t.pos,t.attr,t.value)}}pt.jsonID("attr",ti);class Ui extends pt{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return Ue.ok(n)}getMap(){return Vt.empty}invert(e){return new Ui(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Ui(t.attr,t.value)}}pt.jsonID("docAttr",Ui);let ii=class extends Error{};ii=function r(e){let t=Error.call(this,e);return t.__proto__=r.prototype,t};ii.prototype=Object.create(Error.prototype);ii.prototype.constructor=ii;ii.prototype.name="TransformError";class h_{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Hi}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new ii(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=U.empty){let i=Oo(this.doc,e,t,n);return i&&this.step(i),this}replaceWith(e,t,n){return this.replace(e,t,new U($.from(n),0,0))}delete(e,t){return this.replace(e,t,U.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return c_(this,e,t,n),this}replaceRangeWith(e,t,n){return f_(this,e,t,n),this}deleteRange(e,t){return d_(this,e,t),this}lift(e,t){return jx(this,e,t),this}join(e,t=1){return s_(this,e,t),this}wrap(e,t){return Qx(this,e,t),this}setBlockType(e,t=e,n,i=null){return e_(this,e,t,n,i),this}setNodeMarkup(e,t,n=null,i){return n_(this,e,t,n,i),this}setNodeAttribute(e,t,n){return this.step(new ti(e,t,n)),this}setDocAttribute(e,t){return this.step(new Ui(e,t)),this}addNodeMark(e,t){return this.step(new Gn(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(t instanceof Ne)t.isInSet(n.marks)&&this.step(new Ar(e,t));else{let i=n.marks,o,a=[];for(;o=t.isInSet(i);)a.push(new Ar(e,o)),i=o.removeFromSet(i);for(let u=a.length-1;u>=0;u--)this.step(a[u])}return this}split(e,t=1,n){return r_(this,e,t,n),this}addMark(e,t,n){return Kx(this,e,t,n),this}removeMark(e,t,n){return Gx(this,e,t,n),this}clearIncompatible(e,t,n){return eu(this,e,t,n),this}}const da=Object.create(null);class he{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new p_(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=U.empty){let n=t.content.lastChild,i=null;for(let u=0;u<t.openEnd;u++)i=n,n=n.lastChild;let o=e.steps.length,a=this.ranges;for(let u=0;u<a.length;u++){let{$from:f,$to:d}=a[u],p=e.mapping.slice(o);e.replaceRange(p.map(f.pos),p.map(d.pos),u?U.empty:t),u==0&&vd(e,o,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:a,$to:u}=i[o],f=e.mapping.slice(n),d=f.map(a.pos),p=f.map(u.pos);o?e.deleteRange(d,p):(e.replaceRangeWith(d,p,t),vd(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let i=e.parent.inlineContent?new ae(e):jr(e.node(0),e.parent,e.pos,e.index(),t,n);if(i)return i;for(let o=e.depth-1;o>=0;o--){let a=t<0?jr(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):jr(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(a)return a}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new zt(e.node(0))}static atStart(e){return jr(e,e,0,0,1)||new zt(e)}static atEnd(e){return jr(e,e,e.content.size,e.childCount,-1)||new zt(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=da[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in da)throw new RangeError("Duplicate use of selection JSON ID "+e);return da[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ae.between(this.$anchor,this.$head).getBookmark()}}he.prototype.visible=!0;class p_{constructor(e,t){this.$from=e,this.$to=t}}let gd=!1;function yd(r){!gd&&!r.parent.inlineContent&&(gd=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+r.parent.type.name+")"))}class ae extends he{constructor(e,t=e){yd(e),yd(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return he.near(n);let i=e.resolve(t.map(this.anchor));return new ae(i.parent.inlineContent?i:n,n)}replace(e,t=U.empty){if(super.replace(e,t),t==U.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof ae&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Ao(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ae(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let i=e.resolve(t);return new this(i,n==t?i:e.resolve(n))}static between(e,t,n){let i=e.pos-t.pos;if((!n||i)&&(n=i>=0?1:-1),!t.parent.inlineContent){let o=he.findFrom(t,n,!0)||he.findFrom(t,-n,!0);if(o)t=o.$head;else return he.near(t,n)}return e.parent.inlineContent||(i==0?e=t:(e=(he.findFrom(e,-n,!0)||he.findFrom(e,n,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new ae(e,t)}}he.jsonID("text",ae);class Ao{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Ao(e.map(this.anchor),e.map(this.head))}resolve(e){return ae.between(e.resolve(this.anchor),e.resolve(this.head))}}class re extends he{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return n?he.near(o):new re(o)}content(){return new U($.from(this.node),0,0)}eq(e){return e instanceof re&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new nu(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new re(e.resolve(t.anchor))}static create(e,t){return new re(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}re.prototype.visible=!1;he.jsonID("node",re);class nu{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new Ao(n,n):new nu(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&re.isSelectable(n)?new re(t):he.near(t)}}class zt extends he{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=U.empty){if(t==U.empty){e.delete(0,e.doc.content.size);let n=he.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new zt(e)}map(e){return new zt(e)}eq(e){return e instanceof zt}getBookmark(){return m_}}he.jsonID("all",zt);const m_={map(){return this},resolve(r){return new zt(r)}};function jr(r,e,t,n,i,o=!1){if(e.inlineContent)return ae.create(r,t);for(let a=n-(i>0?0:1);i>0?a<e.childCount:a>=0;a+=i){let u=e.child(a);if(u.isAtom){if(!o&&re.isSelectable(u))return re.create(r,t-(i<0?u.nodeSize:0))}else{let f=jr(r,u,t+i,i<0?u.childCount:0,i,o);if(f)return f}t+=u.nodeSize*i}return null}function vd(r,e,t){let n=r.steps.length-1;if(n<e)return;let i=r.steps[n];if(!(i instanceof Xe||i instanceof Ze))return;let o=r.mapping.maps[n],a;o.forEach((u,f,d,p)=>{a==null&&(a=p)}),r.setSelection(he.near(r.doc.resolve(a),t))}const bd=1,wd=2,xd=4;class g_ extends h_{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|bd)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&bd)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=wd,this}ensureMarks(e){return Ne.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&wd)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&-3,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Ne.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(n==null&&(n=t),n=n??t,!e)return this.deleteRange(t,n);let o=this.storedMarks;if(!o){let a=this.doc.resolve(t);o=n==t?a.marks():a.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,i.text(e,o)),this.selection.empty||this.setSelection(he.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=xd,this}get scrolledIntoView(){return(this.updated&xd)>0}}function _d(r,e){return!e||!r?r:r.bind(e)}class Pi{constructor(e,t,n){this.name=e,this.init=_d(t.init,n),this.apply=_d(t.apply,n)}}const y_=[new Pi("doc",{init(r){return r.doc||r.schema.topNodeType.createAndFill()},apply(r){return r.doc}}),new Pi("selection",{init(r,e){return r.selection||he.atStart(e.doc)},apply(r){return r.selection}}),new Pi("storedMarks",{init(r){return r.storedMarks||null},apply(r,e,t,n){return n.selection.$cursor?r.storedMarks:null}}),new Pi("scrollToSelection",{init(){return 0},apply(r,e){return r.scrolledIntoView?e+1:e}})];class ha{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=y_.slice(),t&&t.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new Pi(n.key,n.spec.state,n))})}}class Qr{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let i=this.config.plugins[n];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),i=null;for(;;){let o=!1;for(let a=0;a<this.config.plugins.length;a++){let u=this.config.plugins[a];if(u.spec.appendTransaction){let f=i?i[a].n:0,d=i?i[a].state:this,p=f<t.length&&u.spec.appendTransaction.call(u,f?t.slice(f):t,d,n);if(p&&n.filterTransaction(p,a)){if(p.setMeta("appendedTransaction",e),!i){i=[];for(let m=0;m<this.config.plugins.length;m++)i.push(m<a?{state:n,n:t.length}:{state:this,n:0})}t.push(p),n=n.applyInner(p),o=!0}i&&(i[a]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new Qr(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let o=n[i];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new g_(this)}static create(e){let t=new ha(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new Qr(t);for(let i=0;i<t.fields.length;i++)n[t.fields[i].name]=t.fields[i].init(e,n);return n}reconfigure(e){let t=new ha(this.schema,e.plugins),n=t.fields,i=new Qr(t);for(let o=0;o<n.length;o++){let a=n[o].name;i[a]=this.hasOwnProperty(a)?this[a]:n[o].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(n=>n.toJSON())),e&&typeof e=="object")for(let n in e){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[n],o=i.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new ha(e.schema,e.plugins),o=new Qr(i);return i.fields.forEach(a=>{if(a.name=="doc")o.doc=jn.fromJSON(e.schema,t.doc);else if(a.name=="selection")o.selection=he.fromJSON(o.doc,t.selection);else if(a.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let u in n){let f=n[u],d=f.spec.state;if(f.key==a.name&&d&&d.fromJSON&&Object.prototype.hasOwnProperty.call(t,u)){o[a.name]=d.fromJSON.call(f,e,t[u],o);return}}o[a.name]=a.init(e,o)}}),o}}function rp(r,e,t){for(let n in r){let i=r[n];i instanceof Function?i=i.bind(e):n=="handleDOMEvents"&&(i=rp(i,e,{})),t[n]=i}return t}class It{constructor(e){this.spec=e,this.props={},e.props&&rp(e.props,this,this.props),this.key=e.key?e.key.key:ip("plugin")}getState(e){return e[this.key]}}const pa=Object.create(null);function ip(r){return r in pa?r+"$"+ ++pa[r]:(pa[r]=0,r+"$")}class yn{constructor(e="key"){this.key=ip(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const lt=function(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e},si=function(r){let e=r.assignedSlot||r.parentNode;return e&&e.nodeType==11?e.host:e};let Pa=null;const An=function(r,e,t){let n=Pa||(Pa=document.createRange());return n.setEnd(r,t??r.nodeValue.length),n.setStart(r,e||0),n},v_=function(){Pa=null},Er=function(r,e,t,n){return t&&(kd(r,e,t,n,-1)||kd(r,e,t,n,1))},b_=/^(img|br|input|textarea|hr)$/i;function kd(r,e,t,n,i){for(;;){if(r==t&&e==n)return!0;if(e==(i<0?0:Zt(r))){let o=r.parentNode;if(!o||o.nodeType!=1||es(r)||b_.test(r.nodeName)||r.contentEditable=="false")return!1;e=lt(r)+(i<0?0:1),r=o}else if(r.nodeType==1){if(r=r.childNodes[e+(i<0?-1:0)],r.contentEditable=="false")return!1;e=i<0?Zt(r):0}else return!1}}function Zt(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function w_(r,e){for(;;){if(r.nodeType==3&&e)return r;if(r.nodeType==1&&e>0){if(r.contentEditable=="false")return null;r=r.childNodes[e-1],e=Zt(r)}else if(r.parentNode&&!es(r))e=lt(r),r=r.parentNode;else return null}}function x_(r,e){for(;;){if(r.nodeType==3&&e<r.nodeValue.length)return r;if(r.nodeType==1&&e<r.childNodes.length){if(r.contentEditable=="false")return null;r=r.childNodes[e],e=0}else if(r.parentNode&&!es(r))e=lt(r)+1,r=r.parentNode;else return null}}function __(r,e,t){for(let n=e==0,i=e==Zt(r);n||i;){if(r==t)return!0;let o=lt(r);if(r=r.parentNode,!r)return!1;n=n&&o==0,i=i&&o==Zt(r)}}function es(r){let e;for(let t=r;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==r||e.contentDOM==r)}const Eo=function(r){return r.focusNode&&Er(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)};function yr(r,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=r,t.key=t.code=e,t}function k_(r){let e=r.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function S_(r,e,t){if(r.caretPositionFromPoint)try{let n=r.caretPositionFromPoint(e,t);if(n)return{node:n.offsetNode,offset:Math.min(Zt(n.offsetNode),n.offset)}}catch{}if(r.caretRangeFromPoint){let n=r.caretRangeFromPoint(e,t);if(n)return{node:n.startContainer,offset:Math.min(Zt(n.startContainer),n.startOffset)}}}const mn=typeof navigator<"u"?navigator:null,Sd=typeof document<"u"?document:null,ir=mn&&mn.userAgent||"",La=/Edge\/(\d+)/.exec(ir),sp=/MSIE \d/.exec(ir),Ba=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ir),Dt=!!(sp||Ba||La),Zn=sp?document.documentMode:Ba?+Ba[1]:La?+La[1]:0,an=!Dt&&/gecko\/(\d+)/i.test(ir);an&&+(/Firefox\/(\d+)/.exec(ir)||[0,0])[1];const Fa=!Dt&&/Chrome\/(\d+)/.exec(ir),ht=!!Fa,op=Fa?+Fa[1]:0,bt=!Dt&&!!mn&&/Apple Computer/.test(mn.vendor),oi=bt&&(/Mobile\/\w+/.test(ir)||!!mn&&mn.maxTouchPoints>2),Xt=oi||(mn?/Mac/.test(mn.platform):!1),C_=mn?/Win/.test(mn.platform):!1,En=/Android \d/.test(ir),ts=!!Sd&&"webkitFontSmoothing"in Sd.documentElement.style,M_=ts?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function T_(r){let e=r.defaultView&&r.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.documentElement.clientWidth,top:0,bottom:r.documentElement.clientHeight}}function On(r,e){return typeof r=="number"?r:r[e]}function O_(r){let e=r.getBoundingClientRect(),t=e.width/r.offsetWidth||1,n=e.height/r.offsetHeight||1;return{left:e.left,right:e.left+r.clientWidth*t,top:e.top,bottom:e.top+r.clientHeight*n}}function Cd(r,e,t){let n=r.someProp("scrollThreshold")||0,i=r.someProp("scrollMargin")||5,o=r.dom.ownerDocument;for(let a=t||r.dom;a;){if(a.nodeType!=1){a=si(a);continue}let u=a,f=u==o.body,d=f?T_(o):O_(u),p=0,m=0;if(e.top<d.top+On(n,"top")?m=-(d.top-e.top+On(i,"top")):e.bottom>d.bottom-On(n,"bottom")&&(m=e.bottom-e.top>d.bottom-d.top?e.top+On(i,"top")-d.top:e.bottom-d.bottom+On(i,"bottom")),e.left<d.left+On(n,"left")?p=-(d.left-e.left+On(i,"left")):e.right>d.right-On(n,"right")&&(p=e.right-d.right+On(i,"right")),p||m)if(f)o.defaultView.scrollBy(p,m);else{let v=u.scrollLeft,x=u.scrollTop;m&&(u.scrollTop+=m),p&&(u.scrollLeft+=p);let b=u.scrollLeft-v,S=u.scrollTop-x;e={left:e.left-b,top:e.top-S,right:e.right-b,bottom:e.bottom-S}}let y=f?"fixed":getComputedStyle(a).position;if(/^(fixed|sticky)$/.test(y))break;a=y=="absolute"?a.offsetParent:si(a)}}function A_(r){let e=r.dom.getBoundingClientRect(),t=Math.max(0,e.top),n,i;for(let o=(e.left+e.right)/2,a=t+1;a<Math.min(innerHeight,e.bottom);a+=5){let u=r.root.elementFromPoint(o,a);if(!u||u==r.dom||!r.dom.contains(u))continue;let f=u.getBoundingClientRect();if(f.top>=t-20){n=u,i=f.top;break}}return{refDOM:n,refTop:i,stack:lp(r.dom)}}function lp(r){let e=[],t=r.ownerDocument;for(let n=r;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),r!=t);n=si(n));return e}function E_({refDOM:r,refTop:e,stack:t}){let n=r?r.getBoundingClientRect().top:0;ap(t,n==0?0:n-e)}function ap(r,e){for(let t=0;t<r.length;t++){let{dom:n,top:i,left:o}=r[t];n.scrollTop!=i+e&&(n.scrollTop=i+e),n.scrollLeft!=o&&(n.scrollLeft=o)}}let Gr=null;function D_(r){if(r.setActive)return r.setActive();if(Gr)return r.focus(Gr);let e=lp(r);r.focus(Gr==null?{get preventScroll(){return Gr={preventScroll:!0},!0}}:void 0),Gr||(Gr=!1,ap(e,0))}function up(r,e){let t,n=2e8,i,o=0,a=e.top,u=e.top,f,d;for(let p=r.firstChild,m=0;p;p=p.nextSibling,m++){let y;if(p.nodeType==1)y=p.getClientRects();else if(p.nodeType==3)y=An(p).getClientRects();else continue;for(let v=0;v<y.length;v++){let x=y[v];if(x.top<=a&&x.bottom>=u){a=Math.max(x.bottom,a),u=Math.min(x.top,u);let b=x.left>e.left?x.left-e.left:x.right<e.left?e.left-x.right:0;if(b<n){t=p,n=b,i=b&&t.nodeType==3?{left:x.right<e.left?x.right:x.left,top:e.top}:e,p.nodeType==1&&b&&(o=m+(e.left>=(x.left+x.right)/2?1:0));continue}}else x.top>e.top&&!f&&x.left<=e.left&&x.right>=e.left&&(f=p,d={left:Math.max(x.left,Math.min(x.right,e.left)),top:x.top});!t&&(e.left>=x.right&&e.top>=x.top||e.left>=x.left&&e.top>=x.bottom)&&(o=m+1)}}return!t&&f&&(t=f,i=d,n=0),t&&t.nodeType==3?N_(t,i):!t||n&&t.nodeType==1?{node:r,offset:o}:up(t,i)}function N_(r,e){let t=r.nodeValue.length,n=document.createRange();for(let i=0;i<t;i++){n.setEnd(r,i+1),n.setStart(r,i);let o=qn(n,1);if(o.top!=o.bottom&&ru(e,o))return{node:r,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:r,offset:0}}function ru(r,e){return r.left>=e.left-1&&r.left<=e.right+1&&r.top>=e.top-1&&r.top<=e.bottom+1}function I_(r,e){let t=r.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<r.getBoundingClientRect().left?t:r}function R_(r,e,t){let{node:n,offset:i}=up(e,t),o=-1;if(n.nodeType==1&&!n.firstChild){let a=n.getBoundingClientRect();o=a.left!=a.right&&t.left>(a.left+a.right)/2?1:-1}return r.docView.posFromDOM(n,i,o)}function P_(r,e,t,n){let i=-1;for(let o=e,a=!1;o!=r.dom;){let u=r.docView.nearestDesc(o,!0),f;if(!u)return null;if(u.dom.nodeType==1&&(u.node.isBlock&&u.parent||!u.contentDOM)&&((f=u.dom.getBoundingClientRect()).width||f.height)&&(u.node.isBlock&&u.parent&&(!a&&f.left>n.left||f.top>n.top?i=u.posBefore:(!a&&f.right<n.left||f.bottom<n.top)&&(i=u.posAfter),a=!0),!u.contentDOM&&i<0&&!u.node.isText))return(u.node.isBlock?n.top<(f.top+f.bottom)/2:n.left<(f.left+f.right)/2)?u.posBefore:u.posAfter;o=u.dom.parentNode}return i>-1?i:r.docView.posFromDOM(e,t,-1)}function cp(r,e,t){let n=r.childNodes.length;if(n&&t.top<t.bottom)for(let i=Math.max(0,Math.min(n-1,Math.floor(n*(e.top-t.top)/(t.bottom-t.top))-2)),o=i;;){let a=r.childNodes[o];if(a.nodeType==1){let u=a.getClientRects();for(let f=0;f<u.length;f++){let d=u[f];if(ru(e,d))return cp(a,e,d)}}if((o=(o+1)%n)==i)break}return r}function L_(r,e){let t=r.dom.ownerDocument,n,i=0,o=S_(t,e.left,e.top);o&&({node:n,offset:i}=o);let a=(r.root.elementFromPoint?r.root:t).elementFromPoint(e.left,e.top),u;if(!a||!r.dom.contains(a.nodeType!=1?a.parentNode:a)){let d=r.dom.getBoundingClientRect();if(!ru(e,d)||(a=cp(r.dom,e,d),!a))return null}if(bt)for(let d=a;n&&d;d=si(d))d.draggable&&(n=void 0);if(a=I_(a,e),n){if(an&&n.nodeType==1&&(i=Math.min(i,n.childNodes.length),i<n.childNodes.length)){let p=n.childNodes[i],m;p.nodeName=="IMG"&&(m=p.getBoundingClientRect()).right<=e.left&&m.bottom>e.top&&i++}let d;ts&&i&&n.nodeType==1&&(d=n.childNodes[i-1]).nodeType==1&&d.contentEditable=="false"&&d.getBoundingClientRect().top>=e.top&&i--,n==r.dom&&i==n.childNodes.length-1&&n.lastChild.nodeType==1&&e.top>n.lastChild.getBoundingClientRect().bottom?u=r.state.doc.content.size:(i==0||n.nodeType!=1||n.childNodes[i-1].nodeName!="BR")&&(u=P_(r,n,i,e))}u==null&&(u=R_(r,a,e));let f=r.docView.nearestDesc(a,!0);return{pos:u,inside:f?f.posAtStart-f.border:-1}}function Md(r){return r.top<r.bottom||r.left<r.right}function qn(r,e){let t=r.getClientRects();if(t.length){let n=t[e<0?0:t.length-1];if(Md(n))return n}return Array.prototype.find.call(t,Md)||r.getBoundingClientRect()}const B_=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function fp(r,e,t){let{node:n,offset:i,atom:o}=r.docView.domFromPos(e,t<0?-1:1),a=ts||an;if(n.nodeType==3)if(a&&(B_.test(n.nodeValue)||(t<0?!i:i==n.nodeValue.length))){let f=qn(An(n,i,i),t);if(an&&i&&/\s/.test(n.nodeValue[i-1])&&i<n.nodeValue.length){let d=qn(An(n,i-1,i-1),-1);if(d.top==f.top){let p=qn(An(n,i,i+1),-1);if(p.top!=f.top)return Ni(p,p.left<d.left)}}return f}else{let f=i,d=i,p=t<0?1:-1;return t<0&&!i?(d++,p=-1):t>=0&&i==n.nodeValue.length?(f--,p=1):t<0?f--:d++,Ni(qn(An(n,f,d),p),p<0)}if(!r.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(t<0||i==Zt(n))){let f=n.childNodes[i-1];if(f.nodeType==1)return ma(f.getBoundingClientRect(),!1)}if(o==null&&i<Zt(n)){let f=n.childNodes[i];if(f.nodeType==1)return ma(f.getBoundingClientRect(),!0)}return ma(n.getBoundingClientRect(),t>=0)}if(o==null&&i&&(t<0||i==Zt(n))){let f=n.childNodes[i-1],d=f.nodeType==3?An(f,Zt(f)-(a?0:1)):f.nodeType==1&&(f.nodeName!="BR"||!f.nextSibling)?f:null;if(d)return Ni(qn(d,1),!1)}if(o==null&&i<Zt(n)){let f=n.childNodes[i];for(;f.pmViewDesc&&f.pmViewDesc.ignoreForCoords;)f=f.nextSibling;let d=f?f.nodeType==3?An(f,0,a?0:1):f.nodeType==1?f:null:null;if(d)return Ni(qn(d,-1),!0)}return Ni(qn(n.nodeType==3?An(n):n,-t),t>=0)}function Ni(r,e){if(r.width==0)return r;let t=e?r.left:r.right;return{top:r.top,bottom:r.bottom,left:t,right:t}}function ma(r,e){if(r.height==0)return r;let t=e?r.top:r.bottom;return{top:t,bottom:t,left:r.left,right:r.right}}function dp(r,e,t){let n=r.state,i=r.root.activeElement;n!=e&&r.updateState(e),i!=r.dom&&r.focus();try{return t()}finally{n!=e&&r.updateState(n),i!=r.dom&&i&&i.focus()}}function F_(r,e,t){let n=e.selection,i=t=="up"?n.$from:n.$to;return dp(r,e,()=>{let{node:o}=r.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let u=r.docView.nearestDesc(o,!0);if(!u)break;if(u.node.isBlock){o=u.contentDOM||u.dom;break}o=u.dom.parentNode}let a=fp(r,i.pos,1);for(let u=o.firstChild;u;u=u.nextSibling){let f;if(u.nodeType==1)f=u.getClientRects();else if(u.nodeType==3)f=An(u,0,u.nodeValue.length).getClientRects();else continue;for(let d=0;d<f.length;d++){let p=f[d];if(p.bottom>p.top+1&&(t=="up"?a.top-p.top>(p.bottom-a.top)*2:p.bottom-a.bottom>(a.bottom-p.top)*2))return!1}}return!0})}const $_=/[\u0590-\u08ac]/;function V_(r,e,t){let{$head:n}=e.selection;if(!n.parent.isTextblock)return!1;let i=n.parentOffset,o=!i,a=i==n.parent.content.size,u=r.domSelection();return u?!$_.test(n.parent.textContent)||!u.modify?t=="left"||t=="backward"?o:a:dp(r,e,()=>{let{focusNode:f,focusOffset:d,anchorNode:p,anchorOffset:m}=r.domSelectionRange(),y=u.caretBidiLevel;u.modify("move",t,"character");let v=n.depth?r.docView.domAfterPos(n.before()):r.dom,{focusNode:x,focusOffset:b}=r.domSelectionRange(),S=x&&!v.contains(x.nodeType==1?x:x.parentNode)||f==x&&d==b;try{u.collapse(p,m),f&&(f!=p||d!=m)&&u.extend&&u.extend(f,d)}catch{}return y!=null&&(u.caretBidiLevel=y),S}):n.pos==n.start()||n.pos==n.end()}let Td=null,Od=null,Ad=!1;function z_(r,e,t){return Td==e&&Od==t?Ad:(Td=e,Od=t,Ad=t=="up"||t=="down"?F_(r,e,t):V_(r,e,t))}const en=0,Ed=1,wr=2,gn=3;class ns{constructor(e,t,n,i){this.parent=e,this.children=t,this.dom=n,this.contentDOM=i,this.dirty=en,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let i=this.children[t];if(i==e)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(n<0){let o,a;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((a=o.pmViewDesc)&&a.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(a)+a.size:this.posAtStart}else{let o,a;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((a=o.pmViewDesc)&&a.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(a):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>lt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??n>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),a;if(o&&(!t||o.node))if(n&&(a=o.nodeDOM)&&!(a.nodeType==1?a.contains(e.nodeType==1?e:e.parentNode):a==e))n=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let i=this.children[t],o=n+i.size;if(n==e&&o!=n){for(;!i.border&&i.children.length;)for(let a=0;a<i.children.length;a++){let u=i.children[a];if(u.size){i=u;break}}return i}if(e<o)return i.descAt(e-n-i.border);n=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,i=0;for(let o=0;n<this.children.length;n++){let a=this.children[n],u=o+a.size;if(u>e||a instanceof pp){i=e-o;break}o=u}if(i)return this.children[n].domFromPos(i-this.children[n].border,t);for(let o;n&&!(o=this.children[n-1]).size&&o instanceof hp&&o.side>=0;n--);if(t<=0){let o,a=!0;for(;o=n?this.children[n-1]:null,!(!o||o.dom.parentNode==this.contentDOM);n--,a=!1);return o&&t&&a&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?lt(o.dom)+1:0}}else{let o,a=!0;for(;o=n<this.children.length?this.children[n]:null,!(!o||o.dom.parentNode==this.contentDOM);n++,a=!1);return o&&a&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?lt(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let a=n,u=0;;u++){let f=this.children[u],d=a+f.size;if(i==-1&&e<=d){let p=a+f.border;if(e>=p&&t<=d-f.border&&f.node&&f.contentDOM&&this.contentDOM.contains(f.contentDOM))return f.parseRange(e,t,p);e=a;for(let m=u;m>0;m--){let y=this.children[m-1];if(y.size&&y.dom.parentNode==this.contentDOM&&!y.emptyChildAt(1)){i=lt(y.dom)+1;break}e-=y.size}i==-1&&(i=0)}if(i>-1&&(d>t||u==this.children.length-1)){t=d;for(let p=u+1;p<this.children.length;p++){let m=this.children[p];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(-1)){o=lt(m.dom);break}t+=m.size}o==-1&&(o=this.contentDOM.childNodes.length);break}a=d}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(t.nodeType!=1||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,i=!1){let o=Math.min(e,t),a=Math.max(e,t);for(let v=0,x=0;v<this.children.length;v++){let b=this.children[v],S=x+b.size;if(o>x&&a<S)return b.setSelection(e-x-b.border,t-x-b.border,n,i);x=S}let u=this.domFromPos(e,e?-1:1),f=t==e?u:this.domFromPos(t,t?-1:1),d=n.root.getSelection(),p=n.domSelectionRange(),m=!1;if((an||bt)&&e==t){let{node:v,offset:x}=u;if(v.nodeType==3){if(m=!!(x&&v.nodeValue[x-1]==`
`),m&&x==v.nodeValue.length)for(let b=v,S;b;b=b.parentNode){if(S=b.nextSibling){S.nodeName=="BR"&&(u=f={node:S.parentNode,offset:lt(S)+1});break}let E=b.pmViewDesc;if(E&&E.node&&E.node.isBlock)break}}else{let b=v.childNodes[x-1];m=b&&(b.nodeName=="BR"||b.contentEditable=="false")}}if(an&&p.focusNode&&p.focusNode!=f.node&&p.focusNode.nodeType==1){let v=p.focusNode.childNodes[p.focusOffset];v&&v.contentEditable=="false"&&(i=!0)}if(!(i||m&&bt)&&Er(u.node,u.offset,p.anchorNode,p.anchorOffset)&&Er(f.node,f.offset,p.focusNode,p.focusOffset))return;let y=!1;if((d.extend||e==t)&&!m){d.collapse(u.node,u.offset);try{e!=t&&d.extend(f.node,f.offset),y=!0}catch{}}if(!y){if(e>t){let x=u;u=f,f=x}let v=document.createRange();v.setEnd(f.node,f.offset),v.setStart(u.node,u.offset),d.removeAllRanges(),d.addRange(v)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,i=0;i<this.children.length;i++){let o=this.children[i],a=n+o.size;if(n==a?e<=a&&t>=n:e<a&&t>n){let u=n+o.border,f=a-o.border;if(e>=u&&t<=f){this.dirty=e==n||t==a?wr:Ed,e==u&&t==f&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=gn:o.markDirty(e-u,t-u);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?wr:gn}n=a}this.dirty=wr}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=e==1?wr:Ed;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class hp extends ns{constructor(e,t,n,i){let o,a=t.type.toDOM;if(typeof a=="function"&&(a=a(n,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(a.nodeType!=1){let u=document.createElement("span");u.appendChild(a),a=u}a.contentEditable="false",a.classList.add("ProseMirror-widget")}super(e,[],a,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==en&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class W_ extends ns{constructor(e,t,n,i){super(e,[],t,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Dr extends ns{constructor(e,t,n,i,o){super(e,[],n,i),this.mark=t,this.spec=o}static create(e,t,n,i){let o=i.nodeViews[t.type.name],a=o&&o(t,i,n);return(!a||!a.dom)&&(a=Nr.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new Dr(e,t,a.dom,a.contentDOM||a.dom,a)}parseRule(){return this.dirty&gn||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=gn&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=en){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=en}}slice(e,t,n){let i=Dr.create(this.parent,this.mark,!0,n),o=this.children,a=this.size;t<a&&(o=Va(o,t,a,n)),e>0&&(o=Va(o,0,e,n));for(let u=0;u<o.length;u++)o[u].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Qn extends ns{constructor(e,t,n,i,o,a,u,f,d){super(e,[],o,a),this.node=t,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=u}static create(e,t,n,i,o,a){let u=o.nodeViews[t.type.name],f,d=u&&u(t,o,()=>{if(!f)return a;if(f.parent)return f.parent.posBeforeChild(f)},n,i),p=d&&d.dom,m=d&&d.contentDOM;if(t.isText){if(!p)p=document.createTextNode(t.text);else if(p.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else p||({dom:p,contentDOM:m}=Nr.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!m&&!t.isText&&p.nodeName!="BR"&&(p.hasAttribute("contenteditable")||(p.contentEditable="false"),t.type.spec.draggable&&(p.draggable=!0));let y=p;return p=yp(p,n,t),d?f=new q_(e,t,n,i,p,m||null,y,d,o,a+1):t.isText?new Do(e,t,n,i,p,y,o):new Qn(e,t,n,i,p,m||null,y,o,a+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>$.empty)}return e}matchesNode(e,t,n){return this.dirty==en&&e.eq(this.node)&&ho(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,i=t,o=e.composing?this.localCompositionInfo(e,t):null,a=o&&o.pos>-1?o:null,u=o&&o.pos<0,f=new U_(this,a&&a.node,e);G_(this.node,this.innerDeco,(d,p,m)=>{d.spec.marks?f.syncToMarks(d.spec.marks,n,e):d.type.side>=0&&!m&&f.syncToMarks(p==this.node.childCount?Ne.none:this.node.child(p).marks,n,e),f.placeWidget(d,e,i)},(d,p,m,y)=>{f.syncToMarks(d.marks,n,e);let v;f.findNodeMatch(d,p,m,y)||u&&e.state.selection.from>i&&e.state.selection.to<i+d.nodeSize&&(v=f.findIndexWithChild(o.node))>-1&&f.updateNodeAt(d,p,m,v,e)||f.updateNextNode(d,p,m,e,y,i)||f.addNode(d,p,m,e,i),i+=d.nodeSize}),f.syncToMarks([],n,e),this.node.isTextblock&&f.addTextblockHacks(),f.destroyRest(),(f.changed||this.dirty==wr)&&(a&&this.protectLocalComposition(e,a),mp(this.contentDOM,this.children,e),oi&&Y_(this.dom))}localCompositionInfo(e,t){let{from:n,to:i}=e.state.selection;if(!(e.state.selection instanceof ae)||n<t||i>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let a=o.nodeValue,u=j_(this.node.content,a,n-t,i-t);return u<0?null:{node:o,pos:u,text:a}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:n,text:i}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let a=new W_(this,o,t,i);e.input.compositionNodes.push(a),this.children=Va(this.children,n,n+i.length,e,a)}update(e,t,n,i){return this.dirty==gn||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,n,i),!0)}updateInner(e,t,n,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=en}updateOuterDeco(e){if(ho(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=gp(this.dom,this.nodeDOM,$a(this.outerDeco,this.node,t),$a(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Dd(r,e,t,n,i){yp(n,e,r);let o=new Qn(void 0,r,e,t,n,n,n,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class Do extends Qn{constructor(e,t,n,i,o,a,u){super(e,t,n,i,o,null,a,u,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,i){return this.dirty==gn||this.dirty!=en&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=en||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=en,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,n){let i=this.node.cut(e,t),o=document.createTextNode(i.text);return new Do(this.parent,i,this.outerDeco,this.innerDeco,o,o,n)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=gn)}get domAtom(){return!1}isText(e){return this.node.text==e}}class pp extends ns{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==en&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class q_ extends Qn{constructor(e,t,n,i,o,a,u,f,d,p){super(e,t,n,i,o,a,u,d,p),this.spec=f}update(e,t,n,i){if(this.dirty==gn)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,n);return o&&this.updateInner(e,t,n,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,i){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function mp(r,e,t){let n=r.firstChild,i=!1;for(let o=0;o<e.length;o++){let a=e[o],u=a.dom;if(u.parentNode==r){for(;u!=n;)n=Nd(n),i=!0;n=n.nextSibling}else i=!0,r.insertBefore(u,n);if(a instanceof Dr){let f=n?n.previousSibling:r.lastChild;mp(a.contentDOM,a.children,t),n=f?f.nextSibling:r.firstChild}}for(;n;)n=Nd(n),i=!0;i&&t.trackWrites==r&&(t.trackWrites=null)}const Bi=function(r){r&&(this.nodeName=r)};Bi.prototype=Object.create(null);const xr=[new Bi];function $a(r,e,t){if(r.length==0)return xr;let n=t?xr[0]:new Bi,i=[n];for(let o=0;o<r.length;o++){let a=r[o].type.attrs;if(a){a.nodeName&&i.push(n=new Bi(a.nodeName));for(let u in a){let f=a[u];f!=null&&(t&&i.length==1&&i.push(n=new Bi(e.isInline?"span":"div")),u=="class"?n.class=(n.class?n.class+" ":"")+f:u=="style"?n.style=(n.style?n.style+";":"")+f:u!="nodeName"&&(n[u]=f))}}}return i}function gp(r,e,t,n){if(t==xr&&n==xr)return e;let i=e;for(let o=0;o<n.length;o++){let a=n[o],u=t[o];if(o){let f;u&&u.nodeName==a.nodeName&&i!=r&&(f=i.parentNode)&&f.nodeName.toLowerCase()==a.nodeName||(f=document.createElement(a.nodeName),f.pmIsDeco=!0,f.appendChild(i),u=xr[0]),i=f}H_(i,u||xr[0],a)}return i}function H_(r,e,t){for(let n in e)n!="class"&&n!="style"&&n!="nodeName"&&!(n in t)&&r.removeAttribute(n);for(let n in t)n!="class"&&n!="style"&&n!="nodeName"&&t[n]!=e[n]&&r.setAttribute(n,t[n]);if(e.class!=t.class){let n=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<n.length;o++)i.indexOf(n[o])==-1&&r.classList.remove(n[o]);for(let o=0;o<i.length;o++)n.indexOf(i[o])==-1&&r.classList.add(i[o]);r.classList.length==0&&r.removeAttribute("class")}if(e.style!=t.style){if(e.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=n.exec(e.style);)r.style.removeProperty(i[1])}t.style&&(r.style.cssText+=t.style)}}function yp(r,e,t){return gp(r,r,xr,$a(e,t,r.nodeType!=1))}function ho(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].type.eq(e[t].type))return!1;return!0}function Nd(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class U_{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=J_(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let i=0,o=this.stack.length>>1,a=Math.min(o,e.length);for(;i<a&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=en,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let u=-1;for(let f=this.index;f<Math.min(this.index+3,this.top.children.length);f++){let d=this.top.children[f];if(d.matchesMark(e[o])&&!this.isLocked(d.dom)){u=f;break}}if(u>-1)u>this.index&&(this.changed=!0,this.destroyBetween(this.index,u)),this.top=this.top.children[this.index];else{let f=Dr.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,f),this.top=f,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,n,i){let o=-1,a;if(i>=this.preMatch.index&&(a=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&a.matchesNode(e,t,n))o=this.top.children.indexOf(a,this.index);else for(let u=this.index,f=Math.min(this.top.children.length,u+5);u<f;u++){let d=this.top.children[u];if(d.matchesNode(e,t,n)&&!this.preMatch.matched.has(d)){o=u;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,n,i,o){let a=this.top.children[i];return a.dirty==gn&&a.dom==a.contentDOM&&(a.dirty=wr),a.update(e,t,n,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let n=e.pmViewDesc;if(n){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==n)return i}return-1}e=t}}updateNextNode(e,t,n,i,o,a){for(let u=this.index;u<this.top.children.length;u++){let f=this.top.children[u];if(f instanceof Qn){let d=this.preMatch.matched.get(f);if(d!=null&&d!=o)return!1;let p=f.dom,m,y=this.isLocked(p)&&!(e.isText&&f.node&&f.node.isText&&f.nodeDOM.nodeValue==e.text&&f.dirty!=gn&&ho(t,f.outerDeco));if(!y&&f.update(e,t,n,i))return this.destroyBetween(this.index,u),f.dom!=p&&(this.changed=!0),this.index++,!0;if(!y&&(m=this.recreateWrapper(f,e,t,n,i,a)))return this.destroyBetween(this.index,u),this.top.children[this.index]=m,m.contentDOM&&(m.dirty=wr,m.updateChildren(i,a+1),m.dirty=en),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,i,o,a){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!ho(n,e.outerDeco)||!i.eq(e.innerDeco))return null;let u=Qn.create(this.top,t,n,i,o,a);if(u.contentDOM){u.children=e.children,e.children=[];for(let f of u.children)f.parent=u}return e.destroy(),u}addNode(e,t,n,i,o){let a=Qn.create(this.top,e,t,n,i,o);a.contentDOM&&a.updateChildren(i,o+1),this.top.children.splice(this.index++,0,a),this.changed=!0}placeWidget(e,t,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new hp(this.top,e,t,n);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Dr;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Do)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((bt||ht)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);e=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),e=="BR"&&(n.className="ProseMirror-trailingBreak");let i=new pp(this.top,[],n,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function J_(r,e){let t=e,n=t.children.length,i=r.childCount,o=new Map,a=[];e:for(;i>0;){let u;for(;;)if(n){let d=t.children[n-1];if(d instanceof Dr)t=d,n=d.children.length;else{u=d,n--;break}}else{if(t==e)break e;n=t.parent.children.indexOf(t),t=t.parent}let f=u.node;if(f){if(f!=r.child(i-1))break;--i,o.set(u,i),a.push(u)}}return{index:i,matched:o,matches:a.reverse()}}function K_(r,e){return r.type.side-e.type.side}function G_(r,e,t,n){let i=e.locals(r),o=0;if(i.length==0){for(let d=0;d<r.childCount;d++){let p=r.child(d);n(p,i,e.forChild(o,p),d),o+=p.nodeSize}return}let a=0,u=[],f=null;for(let d=0;;){let p,m;for(;a<i.length&&i[a].to==o;){let S=i[a++];S.widget&&(p?(m||(m=[p])).push(S):p=S)}if(p)if(m){m.sort(K_);for(let S=0;S<m.length;S++)t(m[S],d,!!f)}else t(p,d,!!f);let y,v;if(f)v=-1,y=f,f=null;else if(d<r.childCount)v=d,y=r.child(d++);else break;for(let S=0;S<u.length;S++)u[S].to<=o&&u.splice(S--,1);for(;a<i.length&&i[a].from<=o&&i[a].to>o;)u.push(i[a++]);let x=o+y.nodeSize;if(y.isText){let S=x;a<i.length&&i[a].from<S&&(S=i[a].from);for(let E=0;E<u.length;E++)u[E].to<S&&(S=u[E].to);S<x&&(f=y.cut(S-o),y=y.cut(0,S-o),x=S,v=-1)}else for(;a<i.length&&i[a].to<x;)a++;let b=y.isInline&&!y.isLeaf?u.filter(S=>!S.inline):u.slice();n(y,b,e.forChild(o,y),v),o=x}}function Y_(r){if(r.nodeName=="UL"||r.nodeName=="OL"){let e=r.style.cssText;r.style.cssText=e+"; list-style: square !important",window.getComputedStyle(r).listStyle,r.style.cssText=e}}function j_(r,e,t,n){for(let i=0,o=0;i<r.childCount&&o<=n;){let a=r.child(i++),u=o;if(o+=a.nodeSize,!a.isText)continue;let f=a.text;for(;i<r.childCount;){let d=r.child(i++);if(o+=d.nodeSize,!d.isText)break;f+=d.text}if(o>=t){if(o>=n&&f.slice(n-e.length-u,n-u)==e)return n-e.length;let d=u<n?f.lastIndexOf(e,n-u-1):-1;if(d>=0&&d+e.length+u>=t)return u+d;if(t==n&&f.length>=n+e.length-u&&f.slice(n-u,n-u+e.length)==e)return n}}return-1}function Va(r,e,t,n,i){let o=[];for(let a=0,u=0;a<r.length;a++){let f=r[a],d=u,p=u+=f.size;d>=t||p<=e?o.push(f):(d<e&&o.push(f.slice(0,e-d,n)),i&&(o.push(i),i=void 0),p>t&&o.push(f.slice(t-d,f.size,n)))}return o}function iu(r,e=null){let t=r.domSelectionRange(),n=r.state.doc;if(!t.focusNode)return null;let i=r.docView.nearestDesc(t.focusNode),o=i&&i.size==0,a=r.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(a<0)return null;let u=n.resolve(a),f,d;if(Eo(t)){for(f=a;i&&!i.node;)i=i.parent;let m=i.node;if(i&&m.isAtom&&re.isSelectable(m)&&i.parent&&!(m.isInline&&__(t.focusNode,t.focusOffset,i.dom))){let y=i.posBefore;d=new re(a==y?u:n.resolve(y))}}else{if(t instanceof r.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let m=a,y=a;for(let v=0;v<t.rangeCount;v++){let x=t.getRangeAt(v);m=Math.min(m,r.docView.posFromDOM(x.startContainer,x.startOffset,1)),y=Math.max(y,r.docView.posFromDOM(x.endContainer,x.endOffset,-1))}if(m<0)return null;[f,a]=y==r.state.selection.anchor?[y,m]:[m,y],u=n.resolve(a)}else f=r.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(f<0)return null}let p=n.resolve(f);if(!d){let m=e=="pointer"||r.state.selection.head<u.pos&&!o?1:-1;d=su(r,p,u,m)}return d}function vp(r){return r.editable?r.hasFocus():wp(r)&&document.activeElement&&document.activeElement.contains(r.dom)}function Nn(r,e=!1){let t=r.state.selection;if(bp(r,t),!!vp(r)){if(!e&&r.input.mouseDown&&r.input.mouseDown.allowDefault&&ht){let n=r.domSelectionRange(),i=r.domObserver.currentSelection;if(n.anchorNode&&i.anchorNode&&Er(n.anchorNode,n.anchorOffset,i.anchorNode,i.anchorOffset)){r.input.mouseDown.delayedSelectionSync=!0,r.domObserver.setCurSelection();return}}if(r.domObserver.disconnectSelection(),r.cursorWrapper)Z_(r);else{let{anchor:n,head:i}=t,o,a;Id&&!(t instanceof ae)&&(t.$from.parent.inlineContent||(o=Rd(r,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(a=Rd(r,t.to))),r.docView.setSelection(n,i,r,e),Id&&(o&&Pd(o),a&&Pd(a)),t.visible?r.dom.classList.remove("ProseMirror-hideselection"):(r.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&X_(r))}r.domObserver.setCurSelection(),r.domObserver.connectSelection()}}const Id=bt||ht&&op<63;function Rd(r,e){let{node:t,offset:n}=r.docView.domFromPos(e,0),i=n<t.childNodes.length?t.childNodes[n]:null,o=n?t.childNodes[n-1]:null;if(bt&&i&&i.contentEditable=="false")return ga(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return ga(i);if(o)return ga(o)}}function ga(r){return r.contentEditable="true",bt&&r.draggable&&(r.draggable=!1,r.wasDraggable=!0),r}function Pd(r){r.contentEditable="false",r.wasDraggable&&(r.draggable=!0,r.wasDraggable=null)}function X_(r){let e=r.dom.ownerDocument;e.removeEventListener("selectionchange",r.input.hideSelectionGuard);let t=r.domSelectionRange(),n=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",r.input.hideSelectionGuard=()=>{(t.anchorNode!=n||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",r.input.hideSelectionGuard),setTimeout(()=>{(!vp(r)||r.state.selection.visible)&&r.dom.classList.remove("ProseMirror-hideselection")},20))})}function Z_(r){let e=r.domSelection(),t=document.createRange();if(!e)return;let n=r.cursorWrapper.dom,i=n.nodeName=="IMG";i?t.setStart(n.parentNode,lt(n)+1):t.setStart(n,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!i&&!r.state.selection.visible&&Dt&&Zn<=11&&(n.disabled=!0,n.disabled=!1)}function bp(r,e){if(e instanceof re){let t=r.docView.descAt(e.from);t!=r.lastSelectedViewDesc&&(Ld(r),t&&t.selectNode(),r.lastSelectedViewDesc=t)}else Ld(r)}function Ld(r){r.lastSelectedViewDesc&&(r.lastSelectedViewDesc.parent&&r.lastSelectedViewDesc.deselectNode(),r.lastSelectedViewDesc=void 0)}function su(r,e,t,n){return r.someProp("createSelectionBetween",i=>i(r,e,t))||ae.between(e,t,n)}function Bd(r){return r.editable&&!r.hasFocus()?!1:wp(r)}function wp(r){let e=r.domSelectionRange();if(!e.anchorNode)return!1;try{return r.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(r.editable||r.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Q_(r){let e=r.docView.domFromPos(r.state.selection.anchor,0),t=r.domSelectionRange();return Er(e.node,e.offset,t.anchorNode,t.anchorOffset)}function za(r,e){let{$anchor:t,$head:n}=r.selection,i=e>0?t.max(n):t.min(n),o=i.parent.inlineContent?i.depth?r.doc.resolve(e>0?i.after():i.before()):null:i;return o&&he.findFrom(o,e)}function Hn(r,e){return r.dispatch(r.state.tr.setSelection(e).scrollIntoView()),!0}function Fd(r,e,t){let n=r.state.selection;if(n instanceof ae)if(t.indexOf("s")>-1){let{$head:i}=n,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let a=r.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return Hn(r,new ae(n.$anchor,a))}else if(n.empty){if(r.endOfTextblock(e>0?"forward":"backward")){let i=za(r.state,e);return i&&i instanceof re?Hn(r,i):!1}else if(!(Xt&&t.indexOf("m")>-1)){let i=n.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,a;if(!o||o.isText)return!1;let u=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(a=r.docView.descAt(u))&&!a.contentDOM?re.isSelectable(o)?Hn(r,new re(e<0?r.state.doc.resolve(i.pos-o.nodeSize):i)):ts?Hn(r,new ae(r.state.doc.resolve(e<0?u:u+o.nodeSize))):!1:!1}}else return!1;else{if(n instanceof re&&n.node.isInline)return Hn(r,new ae(e>0?n.$to:n.$from));{let i=za(r.state,e);return i?Hn(r,i):!1}}}function po(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function Fi(r,e){let t=r.pmViewDesc;return t&&t.size==0&&(e<0||r.nextSibling||r.nodeName!="BR")}function Yr(r,e){return e<0?ek(r):tk(r)}function ek(r){let e=r.domSelectionRange(),t=e.focusNode,n=e.focusOffset;if(!t)return;let i,o,a=!1;for(an&&t.nodeType==1&&n<po(t)&&Fi(t.childNodes[n],-1)&&(a=!0);;)if(n>0){if(t.nodeType!=1)break;{let u=t.childNodes[n-1];if(Fi(u,-1))i=t,o=--n;else if(u.nodeType==3)t=u,n=t.nodeValue.length;else break}}else{if(xp(t))break;{let u=t.previousSibling;for(;u&&Fi(u,-1);)i=t.parentNode,o=lt(u),u=u.previousSibling;if(u)t=u,n=po(t);else{if(t=t.parentNode,t==r.dom)break;n=0}}}a?Wa(r,t,n):i&&Wa(r,i,o)}function tk(r){let e=r.domSelectionRange(),t=e.focusNode,n=e.focusOffset;if(!t)return;let i=po(t),o,a;for(;;)if(n<i){if(t.nodeType!=1)break;let u=t.childNodes[n];if(Fi(u,1))o=t,a=++n;else break}else{if(xp(t))break;{let u=t.nextSibling;for(;u&&Fi(u,1);)o=u.parentNode,a=lt(u)+1,u=u.nextSibling;if(u)t=u,n=0,i=po(t);else{if(t=t.parentNode,t==r.dom)break;n=i=0}}}o&&Wa(r,o,a)}function xp(r){let e=r.pmViewDesc;return e&&e.node&&e.node.isBlock}function nk(r,e){for(;r&&e==r.childNodes.length&&!es(r);)e=lt(r)+1,r=r.parentNode;for(;r&&e<r.childNodes.length;){let t=r.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;r=t,e=0}}function rk(r,e){for(;r&&!e&&!es(r);)e=lt(r),r=r.parentNode;for(;r&&e;){let t=r.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;r=t,e=r.childNodes.length}}function Wa(r,e,t){if(e.nodeType!=3){let o,a;(a=nk(e,t))?(e=a,t=0):(o=rk(e,t))&&(e=o,t=o.nodeValue.length)}let n=r.domSelection();if(!n)return;if(Eo(n)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),n.removeAllRanges(),n.addRange(o)}else n.extend&&n.extend(e,t);r.domObserver.setCurSelection();let{state:i}=r;setTimeout(()=>{r.state==i&&Nn(r)},50)}function $d(r,e){let t=r.state.doc.resolve(e);if(!(ht||C_)&&t.parent.inlineContent){let i=r.coordsAtPos(e);if(e>t.start()){let o=r.coordsAtPos(e-1),a=(o.top+o.bottom)/2;if(a>i.top&&a<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=r.coordsAtPos(e+1),a=(o.top+o.bottom)/2;if(a>i.top&&a<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(r.dom).direction=="rtl"?"rtl":"ltr"}function Vd(r,e,t){let n=r.state.selection;if(n instanceof ae&&!n.empty||t.indexOf("s")>-1||Xt&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=n;if(!i.parent.inlineContent||r.endOfTextblock(e<0?"up":"down")){let a=za(r.state,e);if(a&&a instanceof re)return Hn(r,a)}if(!i.parent.inlineContent){let a=e<0?i:o,u=n instanceof zt?he.near(a,e):he.findFrom(a,e);return u?Hn(r,u):!1}return!1}function zd(r,e){if(!(r.state.selection instanceof ae))return!0;let{$head:t,$anchor:n,empty:i}=r.state.selection;if(!t.sameParent(n))return!0;if(!i)return!1;if(r.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let a=r.state.tr;return e<0?a.delete(t.pos-o.nodeSize,t.pos):a.delete(t.pos,t.pos+o.nodeSize),r.dispatch(a),!0}return!1}function Wd(r,e,t){r.domObserver.stop(),e.contentEditable=t,r.domObserver.start()}function ik(r){if(!bt||r.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=r.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let n=e.firstChild;Wd(r,n,"true"),setTimeout(()=>Wd(r,n,"false"),20)}return!1}function sk(r){let e="";return r.ctrlKey&&(e+="c"),r.metaKey&&(e+="m"),r.altKey&&(e+="a"),r.shiftKey&&(e+="s"),e}function ok(r,e){let t=e.keyCode,n=sk(e);if(t==8||Xt&&t==72&&n=="c")return zd(r,-1)||Yr(r,-1);if(t==46&&!e.shiftKey||Xt&&t==68&&n=="c")return zd(r,1)||Yr(r,1);if(t==13||t==27)return!0;if(t==37||Xt&&t==66&&n=="c"){let i=t==37?$d(r,r.state.selection.from)=="ltr"?-1:1:-1;return Fd(r,i,n)||Yr(r,i)}else if(t==39||Xt&&t==70&&n=="c"){let i=t==39?$d(r,r.state.selection.from)=="ltr"?1:-1:1;return Fd(r,i,n)||Yr(r,i)}else{if(t==38||Xt&&t==80&&n=="c")return Vd(r,-1,n)||Yr(r,-1);if(t==40||Xt&&t==78&&n=="c")return ik(r)||Vd(r,1,n)||Yr(r,1);if(n==(Xt?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function ou(r,e){r.someProp("transformCopied",v=>{e=v(e,r)});let t=[],{content:n,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&n.childCount==1&&n.firstChild.childCount==1;){i--,o--;let v=n.firstChild;t.push(v.type.name,v.attrs!=v.type.defaultAttrs?v.attrs:null),n=v.content}let a=r.someProp("clipboardSerializer")||Nr.fromSchema(r.state.schema),u=Tp(),f=u.createElement("div");f.appendChild(a.serializeFragment(n,{document:u}));let d=f.firstChild,p,m=0;for(;d&&d.nodeType==1&&(p=Mp[d.nodeName.toLowerCase()]);){for(let v=p.length-1;v>=0;v--){let x=u.createElement(p[v]);for(;f.firstChild;)x.appendChild(f.firstChild);f.appendChild(x),m++}d=f.firstChild}d&&d.nodeType==1&&d.setAttribute("data-pm-slice",`${i} ${o}${m?` -${m}`:""} ${JSON.stringify(t)}`);let y=r.someProp("clipboardTextSerializer",v=>v(e,r))||e.content.textBetween(0,e.content.size,`

`);return{dom:f,text:y,slice:e}}function _p(r,e,t,n,i){let o=i.parent.type.spec.code,a,u;if(!t&&!e)return null;let f=e&&(n||o||!t);if(f){if(r.someProp("transformPastedText",y=>{e=y(e,o||n,r)}),o)return e?new U($.from(r.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):U.empty;let m=r.someProp("clipboardTextParser",y=>y(e,i,n,r));if(m)u=m;else{let y=i.marks(),{schema:v}=r.state,x=Nr.fromSchema(v);a=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(b=>{let S=a.appendChild(document.createElement("p"));b&&S.appendChild(x.serializeNode(v.text(b,y)))})}}else r.someProp("transformPastedHTML",m=>{t=m(t,r)}),a=ck(t),ts&&fk(a);let d=a&&a.querySelector("[data-pm-slice]"),p=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(p&&p[3])for(let m=+p[3];m>0;m--){let y=a.firstChild;for(;y&&y.nodeType!=1;)y=y.nextSibling;if(!y)break;a=y}if(u||(u=(r.someProp("clipboardParser")||r.someProp("domParser")||Xn.fromSchema(r.state.schema)).parseSlice(a,{preserveWhitespace:!!(f||p),context:i,ruleFromNode(y){return y.nodeName=="BR"&&!y.nextSibling&&y.parentNode&&!lk.test(y.parentNode.nodeName)?{ignore:!0}:null}})),p)u=dk(qd(u,+p[1],+p[2]),p[4]);else if(u=U.maxOpen(ak(u.content,i),!0),u.openStart||u.openEnd){let m=0,y=0;for(let v=u.content.firstChild;m<u.openStart&&!v.type.spec.isolating;m++,v=v.firstChild);for(let v=u.content.lastChild;y<u.openEnd&&!v.type.spec.isolating;y++,v=v.lastChild);u=qd(u,m,y)}return r.someProp("transformPasted",m=>{u=m(u,r)}),u}const lk=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function ak(r,e){if(r.childCount<2)return r;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,a=[];if(r.forEach(u=>{if(!a)return;let f=i.findWrapping(u.type),d;if(!f)return a=null;if(d=a.length&&o.length&&Sp(f,o,u,a[a.length-1],0))a[a.length-1]=d;else{a.length&&(a[a.length-1]=Cp(a[a.length-1],o.length));let p=kp(u,f);a.push(p),i=i.matchType(p.type),o=f}}),a)return $.from(a)}return r}function kp(r,e,t=0){for(let n=e.length-1;n>=t;n--)r=e[n].create(null,$.from(r));return r}function Sp(r,e,t,n,i){if(i<r.length&&i<e.length&&r[i]==e[i]){let o=Sp(r,e,t,n.lastChild,i+1);if(o)return n.copy(n.content.replaceChild(n.childCount-1,o));if(n.contentMatchAt(n.childCount).matchType(i==r.length-1?t.type:r[i+1]))return n.copy(n.content.append($.from(kp(t,r,i+1))))}}function Cp(r,e){if(e==0)return r;let t=r.content.replaceChild(r.childCount-1,Cp(r.lastChild,e-1)),n=r.contentMatchAt(r.childCount).fillBefore($.empty,!0);return r.copy(t.append(n))}function qa(r,e,t,n,i,o){let a=e<0?r.firstChild:r.lastChild,u=a.content;return r.childCount>1&&(o=0),i<n-1&&(u=qa(u,e,t,n,i+1,o)),i>=t&&(u=e<0?a.contentMatchAt(0).fillBefore(u,o<=i).append(u):u.append(a.contentMatchAt(a.childCount).fillBefore($.empty,!0))),r.replaceChild(e<0?0:r.childCount-1,a.copy(u))}function qd(r,e,t){return e<r.openStart&&(r=new U(qa(r.content,-1,e,r.openStart,0,r.openEnd),e,r.openEnd)),t<r.openEnd&&(r=new U(qa(r.content,1,t,r.openEnd,0,0),r.openStart,t)),r}const Mp={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Hd=null;function Tp(){return Hd||(Hd=document.implementation.createHTMLDocument("title"))}let ya=null;function uk(r){let e=window.trustedTypes;return e?(ya||(ya=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),ya.createHTML(r)):r}function ck(r){let e=/^(\s*<meta [^>]*>)*/.exec(r);e&&(r=r.slice(e[0].length));let t=Tp().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(r),i;if((i=n&&Mp[n[1].toLowerCase()])&&(r=i.map(o=>"<"+o+">").join("")+r+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=uk(r),i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function fk(r){let e=r.querySelectorAll(ht?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let n=e[t];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(r.ownerDocument.createTextNode(" "),n)}}function dk(r,e){if(!r.size)return r;let t=r.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return r}let{content:i,openStart:o,openEnd:a}=r;for(let u=n.length-2;u>=0;u-=2){let f=t.nodes[n[u]];if(!f||f.hasRequiredAttrs())break;i=$.from(f.create(n[u+1],i)),o++,a++}return new U(i,o,a)}const wt={},xt={},hk={touchstart:!0,touchmove:!0};class pk{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function mk(r){for(let e in wt){let t=wt[e];r.dom.addEventListener(e,r.input.eventHandlers[e]=n=>{yk(r,n)&&!lu(r,n)&&(r.editable||!(n.type in xt))&&t(r,n)},hk[e]?{passive:!0}:void 0)}bt&&r.dom.addEventListener("input",()=>null),Ha(r)}function Yn(r,e){r.input.lastSelectionOrigin=e,r.input.lastSelectionTime=Date.now()}function gk(r){r.domObserver.stop();for(let e in r.input.eventHandlers)r.dom.removeEventListener(e,r.input.eventHandlers[e]);clearTimeout(r.input.composingTimeout),clearTimeout(r.input.lastIOSEnterFallbackTimeout)}function Ha(r){r.someProp("handleDOMEvents",e=>{for(let t in e)r.input.eventHandlers[t]||r.dom.addEventListener(t,r.input.eventHandlers[t]=n=>lu(r,n))})}function lu(r,e){return r.someProp("handleDOMEvents",t=>{let n=t[e.type];return n?n(r,e)||e.defaultPrevented:!1})}function yk(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=r.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function vk(r,e){!lu(r,e)&&wt[e.type]&&(r.editable||!(e.type in xt))&&wt[e.type](r,e)}xt.keydown=(r,e)=>{let t=e;if(r.input.shiftKey=t.keyCode==16||t.shiftKey,!Ap(r,t)&&(r.input.lastKeyCode=t.keyCode,r.input.lastKeyCodeTime=Date.now(),!(En&&ht&&t.keyCode==13)))if(t.keyCode!=229&&r.domObserver.forceFlush(),oi&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let n=Date.now();r.input.lastIOSEnter=n,r.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{r.input.lastIOSEnter==n&&(r.someProp("handleKeyDown",i=>i(r,yr(13,"Enter"))),r.input.lastIOSEnter=0)},200)}else r.someProp("handleKeyDown",n=>n(r,t))||ok(r,t)?t.preventDefault():Yn(r,"key")};xt.keyup=(r,e)=>{e.keyCode==16&&(r.input.shiftKey=!1)};xt.keypress=(r,e)=>{let t=e;if(Ap(r,t)||!t.charCode||t.ctrlKey&&!t.altKey||Xt&&t.metaKey)return;if(r.someProp("handleKeyPress",i=>i(r,t))){t.preventDefault();return}let n=r.state.selection;if(!(n instanceof ae)||!n.$from.sameParent(n.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!r.someProp("handleTextInput",o=>o(r,n.$from.pos,n.$to.pos,i))&&r.dispatch(r.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function No(r){return{left:r.clientX,top:r.clientY}}function bk(r,e){let t=e.x-r.clientX,n=e.y-r.clientY;return t*t+n*n<100}function au(r,e,t,n,i){if(n==-1)return!1;let o=r.state.doc.resolve(n);for(let a=o.depth+1;a>0;a--)if(r.someProp(e,u=>a>o.depth?u(r,t,o.nodeAfter,o.before(a),i,!0):u(r,t,o.node(a),o.before(a),i,!1)))return!0;return!1}function ni(r,e,t){if(r.focused||r.focus(),r.state.selection.eq(e))return;let n=r.state.tr.setSelection(e);n.setMeta("pointer",!0),r.dispatch(n)}function wk(r,e){if(e==-1)return!1;let t=r.state.doc.resolve(e),n=t.nodeAfter;return n&&n.isAtom&&re.isSelectable(n)?(ni(r,new re(t)),!0):!1}function xk(r,e){if(e==-1)return!1;let t=r.state.selection,n,i;t instanceof re&&(n=t.node);let o=r.state.doc.resolve(e);for(let a=o.depth+1;a>0;a--){let u=a>o.depth?o.nodeAfter:o.node(a);if(re.isSelectable(u)){n&&t.$from.depth>0&&a>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(a);break}}return i!=null?(ni(r,re.create(r.state.doc,i)),!0):!1}function _k(r,e,t,n,i){return au(r,"handleClickOn",e,t,n)||r.someProp("handleClick",o=>o(r,e,n))||(i?xk(r,t):wk(r,t))}function kk(r,e,t,n){return au(r,"handleDoubleClickOn",e,t,n)||r.someProp("handleDoubleClick",i=>i(r,e,n))}function Sk(r,e,t,n){return au(r,"handleTripleClickOn",e,t,n)||r.someProp("handleTripleClick",i=>i(r,e,n))||Ck(r,t,n)}function Ck(r,e,t){if(t.button!=0)return!1;let n=r.state.doc;if(e==-1)return n.inlineContent?(ni(r,ae.create(n,0,n.content.size)),!0):!1;let i=n.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o),u=i.before(o);if(a.inlineContent)ni(r,ae.create(n,u+1,u+1+a.content.size));else if(re.isSelectable(a))ni(r,re.create(n,u));else continue;return!0}}function uu(r){return mo(r)}const Op=Xt?"metaKey":"ctrlKey";wt.mousedown=(r,e)=>{let t=e;r.input.shiftKey=t.shiftKey;let n=uu(r),i=Date.now(),o="singleClick";i-r.input.lastClick.time<500&&bk(t,r.input.lastClick)&&!t[Op]&&r.input.lastClick.button==t.button&&(r.input.lastClick.type=="singleClick"?o="doubleClick":r.input.lastClick.type=="doubleClick"&&(o="tripleClick")),r.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o,button:t.button};let a=r.posAtCoords(No(t));a&&(o=="singleClick"?(r.input.mouseDown&&r.input.mouseDown.done(),r.input.mouseDown=new Mk(r,a,t,!!n)):(o=="doubleClick"?kk:Sk)(r,a.pos,a.inside,t)?t.preventDefault():Yn(r,"pointer"))};class Mk{constructor(e,t,n,i){this.view=e,this.pos=t,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[Op],this.allowDefault=n.shiftKey;let o,a;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),a=t.inside;else{let p=e.state.doc.resolve(t.pos);o=p.parent,a=p.depth?p.before():0}const u=i?null:n.target,f=u?e.docView.nearestDesc(u,!0):null;this.target=f&&f.dom.nodeType==1?f.dom:null;let{selection:d}=e.state;(n.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||d instanceof re&&d.from<=a&&d.to>a)&&(this.mightDrag={node:o,pos:a,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&an&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Yn(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Nn(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(No(e))),this.updateAllowDefault(e),this.allowDefault||!t?Yn(this.view,"pointer"):_k(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||bt&&this.mightDrag&&!this.mightDrag.node.isAtom||ht&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(ni(this.view,he.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):Yn(this.view,"pointer")}move(e){this.updateAllowDefault(e),Yn(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}wt.touchstart=r=>{r.input.lastTouch=Date.now(),uu(r),Yn(r,"pointer")};wt.touchmove=r=>{r.input.lastTouch=Date.now(),Yn(r,"pointer")};wt.contextmenu=r=>uu(r);function Ap(r,e){return r.composing?!0:bt&&Math.abs(e.timeStamp-r.input.compositionEndedAt)<500?(r.input.compositionEndedAt=-2e8,!0):!1}const Tk=En?5e3:-1;xt.compositionstart=xt.compositionupdate=r=>{if(!r.composing){r.domObserver.flush();let{state:e}=r,t=e.selection.$to;if(e.selection instanceof ae&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)))r.markCursor=r.state.storedMarks||t.marks(),mo(r,!0),r.markCursor=null;else if(mo(r,!e.selection.empty),an&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let n=r.domSelectionRange();for(let i=n.focusNode,o=n.focusOffset;i&&i.nodeType==1&&o!=0;){let a=o<0?i.lastChild:i.childNodes[o-1];if(!a)break;if(a.nodeType==3){let u=r.domSelection();u&&u.collapse(a,a.nodeValue.length);break}else i=a,o=-1}}r.input.composing=!0}Ep(r,Tk)};xt.compositionend=(r,e)=>{r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=e.timeStamp,r.input.compositionPendingChanges=r.domObserver.pendingRecords().length?r.input.compositionID:0,r.input.compositionNode=null,r.input.compositionPendingChanges&&Promise.resolve().then(()=>r.domObserver.flush()),r.input.compositionID++,Ep(r,20))};function Ep(r,e){clearTimeout(r.input.composingTimeout),e>-1&&(r.input.composingTimeout=setTimeout(()=>mo(r),e))}function Dp(r){for(r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=Ak());r.input.compositionNodes.length>0;)r.input.compositionNodes.pop().markParentsDirty()}function Ok(r){let e=r.domSelectionRange();if(!e.focusNode)return null;let t=w_(e.focusNode,e.focusOffset),n=x_(e.focusNode,e.focusOffset);if(t&&n&&t!=n){let i=n.pmViewDesc,o=r.domObserver.lastChangedTextNode;if(t==o||n==o)return o;if(!i||!i.isText(n.nodeValue))return n;if(r.input.compositionNode==n){let a=t.pmViewDesc;if(!(!a||!a.isText(t.nodeValue)))return n}}return t||n}function Ak(){let r=document.createEvent("Event");return r.initEvent("event",!0,!0),r.timeStamp}function mo(r,e=!1){if(!(En&&r.domObserver.flushingSoon>=0)){if(r.domObserver.forceFlush(),Dp(r),e||r.docView&&r.docView.dirty){let t=iu(r),n=r.state.selection;return t&&!t.eq(n)?r.dispatch(r.state.tr.setSelection(t)):(r.markCursor||e)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?r.dispatch(r.state.tr.deleteSelection()):r.updateState(r.state),!0}return!1}}function Ek(r,e){if(!r.dom.parentNode)return;let t=r.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),i=document.createRange();i.selectNodeContents(e),r.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),r.focus()},50)}const Ji=Dt&&Zn<15||oi&&M_<604;wt.copy=xt.cut=(r,e)=>{let t=e,n=r.state.selection,i=t.type=="cut";if(n.empty)return;let o=Ji?null:t.clipboardData,a=n.content(),{dom:u,text:f}=ou(r,a);o?(t.preventDefault(),o.clearData(),o.setData("text/html",u.innerHTML),o.setData("text/plain",f)):Ek(r,u),i&&r.dispatch(r.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Dk(r){return r.openStart==0&&r.openEnd==0&&r.content.childCount==1?r.content.firstChild:null}function Nk(r,e){if(!r.dom.parentNode)return;let t=r.input.shiftKey||r.state.selection.$from.parent.type.spec.code,n=r.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let i=r.input.shiftKey&&r.input.lastKeyCode!=45;setTimeout(()=>{r.focus(),n.parentNode&&n.parentNode.removeChild(n),t?Ki(r,n.value,null,i,e):Ki(r,n.textContent,n.innerHTML,i,e)},50)}function Ki(r,e,t,n,i){let o=_p(r,e,t,n,r.state.selection.$from);if(r.someProp("handlePaste",f=>f(r,i,o||U.empty)))return!0;if(!o)return!1;let a=Dk(o),u=a?r.state.tr.replaceSelectionWith(a,n):r.state.tr.replaceSelection(o);return r.dispatch(u.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Np(r){let e=r.getData("text/plain")||r.getData("Text");if(e)return e;let t=r.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}xt.paste=(r,e)=>{let t=e;if(r.composing&&!En)return;let n=Ji?null:t.clipboardData,i=r.input.shiftKey&&r.input.lastKeyCode!=45;n&&Ki(r,Np(n),n.getData("text/html"),i,t)?t.preventDefault():Nk(r,t)};class Ip{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}const Ik=Xt?"altKey":"ctrlKey";function Rp(r,e){let t=r.someProp("dragCopies",n=>!n(e));return t??!e[Ik]}wt.dragstart=(r,e)=>{let t=e,n=r.input.mouseDown;if(n&&n.done(),!t.dataTransfer)return;let i=r.state.selection,o=i.empty?null:r.posAtCoords(No(t)),a;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof re?i.to-1:i.to))){if(n&&n.mightDrag)a=re.create(r.state.doc,n.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let m=r.docView.nearestDesc(t.target,!0);m&&m.node.type.spec.draggable&&m!=r.docView&&(a=re.create(r.state.doc,m.posBefore))}}let u=(a||r.state.selection).content(),{dom:f,text:d,slice:p}=ou(r,u);(!t.dataTransfer.files.length||!ht||op>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(Ji?"Text":"text/html",f.innerHTML),t.dataTransfer.effectAllowed="copyMove",Ji||t.dataTransfer.setData("text/plain",d),r.dragging=new Ip(p,Rp(r,t),a)};wt.dragend=r=>{let e=r.dragging;window.setTimeout(()=>{r.dragging==e&&(r.dragging=null)},50)};xt.dragover=xt.dragenter=(r,e)=>e.preventDefault();xt.drop=(r,e)=>{let t=e,n=r.dragging;if(r.dragging=null,!t.dataTransfer)return;let i=r.posAtCoords(No(t));if(!i)return;let o=r.state.doc.resolve(i.pos),a=n&&n.slice;a?r.someProp("transformPasted",x=>{a=x(a,r)}):a=_p(r,Np(t.dataTransfer),Ji?null:t.dataTransfer.getData("text/html"),!1,o);let u=!!(n&&Rp(r,t));if(r.someProp("handleDrop",x=>x(r,t,a||U.empty,u))){t.preventDefault();return}if(!a)return;t.preventDefault();let f=a?Zh(r.state.doc,o.pos,a):o.pos;f==null&&(f=o.pos);let d=r.state.tr;if(u){let{node:x}=n;x?x.replace(d):d.deleteSelection()}let p=d.mapping.map(f),m=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,y=d.doc;if(m?d.replaceRangeWith(p,p,a.content.firstChild):d.replaceRange(p,p,a),d.doc.eq(y))return;let v=d.doc.resolve(p);if(m&&re.isSelectable(a.content.firstChild)&&v.nodeAfter&&v.nodeAfter.sameMarkup(a.content.firstChild))d.setSelection(new re(v));else{let x=d.mapping.map(f);d.mapping.maps[d.mapping.maps.length-1].forEach((b,S,E,Z)=>x=Z),d.setSelection(su(r,v,d.doc.resolve(x)))}r.focus(),r.dispatch(d.setMeta("uiEvent","drop"))};wt.focus=r=>{r.input.lastFocus=Date.now(),r.focused||(r.domObserver.stop(),r.dom.classList.add("ProseMirror-focused"),r.domObserver.start(),r.focused=!0,setTimeout(()=>{r.docView&&r.hasFocus()&&!r.domObserver.currentSelection.eq(r.domSelectionRange())&&Nn(r)},20))};wt.blur=(r,e)=>{let t=e;r.focused&&(r.domObserver.stop(),r.dom.classList.remove("ProseMirror-focused"),r.domObserver.start(),t.relatedTarget&&r.dom.contains(t.relatedTarget)&&r.domObserver.currentSelection.clear(),r.focused=!1)};wt.beforeinput=(r,e)=>{if(ht&&En&&e.inputType=="deleteContentBackward"){r.domObserver.flushSoon();let{domChangeCount:n}=r.input;setTimeout(()=>{if(r.input.domChangeCount!=n||(r.dom.blur(),r.focus(),r.someProp("handleKeyDown",o=>o(r,yr(8,"Backspace")))))return;let{$cursor:i}=r.state.selection;i&&i.pos>0&&r.dispatch(r.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let r in xt)wt[r]=xt[r];function Gi(r,e){if(r==e)return!0;for(let t in r)if(r[t]!==e[t])return!1;for(let t in e)if(!(t in r))return!1;return!0}class go{constructor(e,t){this.toDOM=e,this.spec=t||Cr,this.side=this.spec.side||0}map(e,t,n,i){let{pos:o,deleted:a}=e.mapResult(t.from+i,this.side<0?-1:1);return a?null:new Qt(o-n,o-n,this)}valid(){return!0}eq(e){return this==e||e instanceof go&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Gi(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class er{constructor(e,t){this.attrs=e,this.spec=t||Cr}map(e,t,n,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-n,a=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-n;return o>=a?null:new Qt(o,a,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof er&&Gi(this.attrs,e.attrs)&&Gi(this.spec,e.spec)}static is(e){return e.type instanceof er}destroy(){}}class cu{constructor(e,t){this.attrs=e,this.spec=t||Cr}map(e,t,n,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let a=e.mapResult(t.to+i,-1);return a.deleted||a.pos<=o.pos?null:new Qt(o.pos-n,a.pos-n,this)}valid(e,t){let{index:n,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(n)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof cu&&Gi(this.attrs,e.attrs)&&Gi(this.spec,e.spec)}destroy(){}}class Qt{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new Qt(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new Qt(e,e,new go(t,n))}static inline(e,t,n,i){return new Qt(e,t,new er(n,i))}static node(e,t,n,i){return new Qt(e,t,new cu(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof er}get widget(){return this.type instanceof go}}const Xr=[],Cr={};class Ye{constructor(e,t){this.local=e.length?e:Xr,this.children=t.length?t:Xr}static create(e,t){return t.length?yo(t,e,0,Cr):ft}find(e,t,n){let i=[];return this.findInner(e??0,t??1e9,i,0,n),i}findInner(e,t,n,i,o){for(let a=0;a<this.local.length;a++){let u=this.local[a];u.from<=t&&u.to>=e&&(!o||o(u.spec))&&n.push(u.copy(u.from+i,u.to+i))}for(let a=0;a<this.children.length;a+=3)if(this.children[a]<t&&this.children[a+1]>e){let u=this.children[a]+1;this.children[a+2].findInner(e-u,t-u,n,i+u,o)}}map(e,t,n){return this==ft||e.maps.length==0?this:this.mapInner(e,t,0,0,n||Cr)}mapInner(e,t,n,i,o){let a;for(let u=0;u<this.local.length;u++){let f=this.local[u].map(e,n,i);f&&f.type.valid(t,f)?(a||(a=[])).push(f):o.onRemove&&o.onRemove(this.local[u].spec)}return this.children.length?Rk(this.children,a||[],e,t,n,i,o):a?new Ye(a.sort(Mr),Xr):ft}add(e,t){return t.length?this==ft?Ye.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let i,o=0;e.forEach((u,f)=>{let d=f+n,p;if(p=Lp(t,u,d)){for(i||(i=this.children.slice());o<i.length&&i[o]<f;)o+=3;i[o]==f?i[o+2]=i[o+2].addInner(u,p,d+1):i.splice(o,0,f,f+u.nodeSize,yo(p,u,d+1,Cr)),o+=3}});let a=Pp(o?Bp(t):t,-n);for(let u=0;u<a.length;u++)a[u].type.valid(e,a[u])||a.splice(u--,1);return new Ye(a.length?this.local.concat(a).sort(Mr):this.local,i||this.children)}remove(e){return e.length==0||this==ft?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,i=this.local;for(let o=0;o<n.length;o+=3){let a,u=n[o]+t,f=n[o+1]+t;for(let p=0,m;p<e.length;p++)(m=e[p])&&m.from>u&&m.to<f&&(e[p]=null,(a||(a=[])).push(m));if(!a)continue;n==this.children&&(n=this.children.slice());let d=n[o+2].removeInner(a,u+1);d!=ft?n[o+2]=d:(n.splice(o,3),o-=3)}if(i.length){for(let o=0,a;o<e.length;o++)if(a=e[o])for(let u=0;u<i.length;u++)i[u].eq(a,t)&&(i==this.local&&(i=this.local.slice()),i.splice(u--,1))}return n==this.children&&i==this.local?this:i.length||n.length?new Ye(i,n):ft}forChild(e,t){if(this==ft)return this;if(t.isLeaf)return Ye.empty;let n,i;for(let u=0;u<this.children.length;u+=3)if(this.children[u]>=e){this.children[u]==e&&(n=this.children[u+2]);break}let o=e+1,a=o+t.content.size;for(let u=0;u<this.local.length;u++){let f=this.local[u];if(f.from<a&&f.to>o&&f.type instanceof er){let d=Math.max(o,f.from)-o,p=Math.min(a,f.to)-o;d<p&&(i||(i=[])).push(f.copy(d,p))}}if(i){let u=new Ye(i.sort(Mr),Xr);return n?new Jn([u,n]):u}return n||ft}eq(e){if(this==e)return!0;if(!(e instanceof Ye)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return fu(this.localsInner(e))}localsInner(e){if(this==ft)return Xr;if(e.inlineContent||!this.local.some(er.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof er||t.push(this.local[n]);return t}forEachSet(e){e(this)}}Ye.empty=new Ye([],[]);Ye.removeOverlap=fu;const ft=Ye.empty;class Jn{constructor(e){this.members=e}map(e,t){const n=this.members.map(i=>i.map(e,t,Cr));return Jn.from(n)}forChild(e,t){if(t.isLeaf)return Ye.empty;let n=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=ft&&(o instanceof Jn?n=n.concat(o.members):n.push(o))}return Jn.from(n)}eq(e){if(!(e instanceof Jn)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{n&&(t=t.slice(),n=!1);for(let a=0;a<o.length;a++)t.push(o[a])}}return t?fu(n?t:t.sort(Mr)):Xr}static from(e){switch(e.length){case 0:return ft;case 1:return e[0];default:return new Jn(e.every(t=>t instanceof Ye)?e:e.reduce((t,n)=>t.concat(n instanceof Ye?n:n.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function Rk(r,e,t,n,i,o,a){let u=r.slice();for(let d=0,p=o;d<t.maps.length;d++){let m=0;t.maps[d].forEach((y,v,x,b)=>{let S=b-x-(v-y);for(let E=0;E<u.length;E+=3){let Z=u[E+1];if(Z<0||y>Z+p-m)continue;let te=u[E]+p-m;v>=te?u[E+1]=y<=te?-2:-1:y>=p&&S&&(u[E]+=S,u[E+1]+=S)}m+=S}),p=t.maps[d].map(p,-1)}let f=!1;for(let d=0;d<u.length;d+=3)if(u[d+1]<0){if(u[d+1]==-2){f=!0,u[d+1]=-1;continue}let p=t.map(r[d]+o),m=p-i;if(m<0||m>=n.content.size){f=!0;continue}let y=t.map(r[d+1]+o,-1),v=y-i,{index:x,offset:b}=n.content.findIndex(m),S=n.maybeChild(x);if(S&&b==m&&b+S.nodeSize==v){let E=u[d+2].mapInner(t,S,p+1,r[d]+o+1,a);E!=ft?(u[d]=m,u[d+1]=v,u[d+2]=E):(u[d+1]=-2,f=!0)}else f=!0}if(f){let d=Pk(u,r,e,t,i,o,a),p=yo(d,n,0,a);e=p.local;for(let m=0;m<u.length;m+=3)u[m+1]<0&&(u.splice(m,3),m-=3);for(let m=0,y=0;m<p.children.length;m+=3){let v=p.children[m];for(;y<u.length&&u[y]<v;)y+=3;u.splice(y,0,p.children[m],p.children[m+1],p.children[m+2])}}return new Ye(e.sort(Mr),u)}function Pp(r,e){if(!e||!r.length)return r;let t=[];for(let n=0;n<r.length;n++){let i=r[n];t.push(new Qt(i.from+e,i.to+e,i.type))}return t}function Pk(r,e,t,n,i,o,a){function u(f,d){for(let p=0;p<f.local.length;p++){let m=f.local[p].map(n,i,d);m?t.push(m):a.onRemove&&a.onRemove(f.local[p].spec)}for(let p=0;p<f.children.length;p+=3)u(f.children[p+2],f.children[p]+d+1)}for(let f=0;f<r.length;f+=3)r[f+1]==-1&&u(r[f+2],e[f]+o+1);return t}function Lp(r,e,t){if(e.isLeaf)return null;let n=t+e.nodeSize,i=null;for(let o=0,a;o<r.length;o++)(a=r[o])&&a.from>t&&a.to<n&&((i||(i=[])).push(a),r[o]=null);return i}function Bp(r){let e=[];for(let t=0;t<r.length;t++)r[t]!=null&&e.push(r[t]);return e}function yo(r,e,t,n){let i=[],o=!1;e.forEach((u,f)=>{let d=Lp(r,u,f+t);if(d){o=!0;let p=yo(d,u,t+f+1,n);p!=ft&&i.push(f,f+u.nodeSize,p)}});let a=Pp(o?Bp(r):r,-t).sort(Mr);for(let u=0;u<a.length;u++)a[u].type.valid(e,a[u])||(n.onRemove&&n.onRemove(a[u].spec),a.splice(u--,1));return a.length||i.length?new Ye(a,i):ft}function Mr(r,e){return r.from-e.from||r.to-e.to}function fu(r){let e=r;for(let t=0;t<e.length-1;t++){let n=e[t];if(n.from!=n.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==n.from){o.to!=n.to&&(e==r&&(e=r.slice()),e[i]=o.copy(o.from,n.to),Ud(e,i+1,o.copy(n.to,o.to)));continue}else{o.from<n.to&&(e==r&&(e=r.slice()),e[t]=n.copy(n.from,o.from),Ud(e,i,n.copy(o.from,n.to)));break}}}return e}function Ud(r,e,t){for(;e<r.length&&Mr(t,r[e])>0;)e++;r.splice(e,0,t)}function va(r){let e=[];return r.someProp("decorations",t=>{let n=t(r.state);n&&n!=ft&&e.push(n)}),r.cursorWrapper&&e.push(Ye.create(r.state.doc,[r.cursorWrapper.deco])),Jn.from(e)}const Lk={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Bk=Dt&&Zn<=11;class Fk{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class $k{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Fk,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let i=0;i<n.length;i++)this.queue.push(n[i]);Dt&&Zn<=11&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),Bk&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Lk)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Bd(this.view)){if(this.suppressingSelectionUpdates)return Nn(this.view);if(Dt&&Zn<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Er(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,n;for(let o=e.focusNode;o;o=si(o))t.add(o);for(let o=e.anchorNode;o;o=si(o))if(t.has(o)){n=o;break}let i=n&&this.view.docView.nearestDesc(n);if(i&&i.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Bd(e)&&!this.ignoreSelectionChange(n),o=-1,a=-1,u=!1,f=[];if(e.editable)for(let p=0;p<t.length;p++){let m=this.registerMutation(t[p],f);m&&(o=o<0?m.from:Math.min(m.from,o),a=a<0?m.to:Math.max(m.to,a),m.typeOver&&(u=!0))}if(an&&f.length){let p=f.filter(m=>m.nodeName=="BR");if(p.length==2){let[m,y]=p;m.parentNode&&m.parentNode.parentNode==y.parentNode?y.remove():m.remove()}else{let{focusNode:m}=this.currentSelection;for(let y of p){let v=y.parentNode;v&&v.nodeName=="LI"&&(!m||Wk(e,m)!=v)&&y.remove()}}}let d=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Eo(n)&&(d=iu(e))&&d.eq(he.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Nn(e),this.currentSelection.set(n),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,a),Vk(e)),this.handleDOMChange(o,a,u,f),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||Nn(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(n==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if(e.type=="childList"){for(let p=0;p<e.addedNodes.length;p++){let m=e.addedNodes[p];t.push(m),m.nodeType==3&&(this.lastChangedTextNode=m)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let i=e.previousSibling,o=e.nextSibling;if(Dt&&Zn<=11&&e.addedNodes.length)for(let p=0;p<e.addedNodes.length;p++){let{previousSibling:m,nextSibling:y}=e.addedNodes[p];(!m||Array.prototype.indexOf.call(e.addedNodes,m)<0)&&(i=m),(!y||Array.prototype.indexOf.call(e.addedNodes,y)<0)&&(o=y)}let a=i&&i.parentNode==e.target?lt(i)+1:0,u=n.localPosFromDOM(e.target,a,-1),f=o&&o.parentNode==e.target?lt(o):e.target.childNodes.length,d=n.localPosFromDOM(e.target,f,1);return{from:u,to:d}}else return e.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Jd=new WeakMap,Kd=!1;function Vk(r){if(!Jd.has(r)&&(Jd.set(r,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(r.dom).whiteSpace)!==-1)){if(r.requiresGeckoHackNode=an,Kd)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Kd=!0}}function Gd(r,e){let t=e.startContainer,n=e.startOffset,i=e.endContainer,o=e.endOffset,a=r.domAtPos(r.state.selection.anchor);return Er(a.node,a.offset,i,o)&&([t,n,i,o]=[i,o,t,n]),{anchorNode:t,anchorOffset:n,focusNode:i,focusOffset:o}}function zk(r,e){if(e.getComposedRanges){let i=e.getComposedRanges(r.root)[0];if(i)return Gd(r,i)}let t;function n(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return r.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),r.dom.removeEventListener("beforeinput",n,!0),t?Gd(r,t):null}function Wk(r,e){for(let t=e.parentNode;t&&t!=r.dom;t=t.parentNode){let n=r.docView.nearestDesc(t,!0);if(n&&n.node.isBlock)return t}return null}function qk(r,e,t){let{node:n,fromOffset:i,toOffset:o,from:a,to:u}=r.docView.parseRange(e,t),f=r.domSelectionRange(),d,p=f.anchorNode;if(p&&r.dom.contains(p.nodeType==1?p:p.parentNode)&&(d=[{node:p,offset:f.anchorOffset}],Eo(f)||d.push({node:f.focusNode,offset:f.focusOffset})),ht&&r.input.lastKeyCode===8)for(let S=o;S>i;S--){let E=n.childNodes[S-1],Z=E.pmViewDesc;if(E.nodeName=="BR"&&!Z){o=S;break}if(!Z||Z.size)break}let m=r.state.doc,y=r.someProp("domParser")||Xn.fromSchema(r.state.schema),v=m.resolve(a),x=null,b=y.parse(n,{topNode:v.parent,topMatch:v.parent.contentMatchAt(v.index()),topOpen:!0,from:i,to:o,preserveWhitespace:v.parent.type.whitespace=="pre"?"full":!0,findPositions:d,ruleFromNode:Hk,context:v});if(d&&d[0].pos!=null){let S=d[0].pos,E=d[1]&&d[1].pos;E==null&&(E=S),x={anchor:S+a,head:E+a}}return{doc:b,sel:x,from:a,to:u}}function Hk(r){let e=r.pmViewDesc;if(e)return e.parseRule();if(r.nodeName=="BR"&&r.parentNode){if(bt&&/^(ul|ol)$/i.test(r.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(r.parentNode.lastChild==r||bt&&/^(tr|table)$/i.test(r.parentNode.nodeName))return{ignore:!0}}else if(r.nodeName=="IMG"&&r.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Uk=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Jk(r,e,t,n,i){let o=r.input.compositionPendingChanges||(r.composing?r.input.compositionID:0);if(r.input.compositionPendingChanges=0,e<0){let j=r.input.lastSelectionTime>Date.now()-50?r.input.lastSelectionOrigin:null,ke=iu(r,j);if(ke&&!r.state.selection.eq(ke)){if(ht&&En&&r.input.lastKeyCode===13&&Date.now()-100<r.input.lastKeyCodeTime&&r.someProp("handleKeyDown",nt=>nt(r,yr(13,"Enter"))))return;let He=r.state.tr.setSelection(ke);j=="pointer"?He.setMeta("pointer",!0):j=="key"&&He.scrollIntoView(),o&&He.setMeta("composition",o),r.dispatch(He)}return}let a=r.state.doc.resolve(e),u=a.sharedDepth(t);e=a.before(u+1),t=r.state.doc.resolve(t).after(u+1);let f=r.state.selection,d=qk(r,e,t),p=r.state.doc,m=p.slice(d.from,d.to),y,v;r.input.lastKeyCode===8&&Date.now()-100<r.input.lastKeyCodeTime?(y=r.state.selection.to,v="end"):(y=r.state.selection.from,v="start"),r.input.lastKeyCode=null;let x=Yk(m.content,d.doc.content,d.from,y,v);if(x&&r.input.domChangeCount++,(oi&&r.input.lastIOSEnter>Date.now()-225||En)&&i.some(j=>j.nodeType==1&&!Uk.test(j.nodeName))&&(!x||x.endA>=x.endB)&&r.someProp("handleKeyDown",j=>j(r,yr(13,"Enter")))){r.input.lastIOSEnter=0;return}if(!x)if(n&&f instanceof ae&&!f.empty&&f.$head.sameParent(f.$anchor)&&!r.composing&&!(d.sel&&d.sel.anchor!=d.sel.head))x={start:f.from,endA:f.to,endB:f.to};else{if(d.sel){let j=Yd(r,r.state.doc,d.sel);if(j&&!j.eq(r.state.selection)){let ke=r.state.tr.setSelection(j);o&&ke.setMeta("composition",o),r.dispatch(ke)}}return}r.state.selection.from<r.state.selection.to&&x.start==x.endB&&r.state.selection instanceof ae&&(x.start>r.state.selection.from&&x.start<=r.state.selection.from+2&&r.state.selection.from>=d.from?x.start=r.state.selection.from:x.endA<r.state.selection.to&&x.endA>=r.state.selection.to-2&&r.state.selection.to<=d.to&&(x.endB+=r.state.selection.to-x.endA,x.endA=r.state.selection.to)),Dt&&Zn<=11&&x.endB==x.start+1&&x.endA==x.start&&x.start>d.from&&d.doc.textBetween(x.start-d.from-1,x.start-d.from+1)==" "&&(x.start--,x.endA--,x.endB--);let b=d.doc.resolveNoCache(x.start-d.from),S=d.doc.resolveNoCache(x.endB-d.from),E=p.resolve(x.start),Z=b.sameParent(S)&&b.parent.inlineContent&&E.end()>=x.endA,te;if((oi&&r.input.lastIOSEnter>Date.now()-225&&(!Z||i.some(j=>j.nodeName=="DIV"||j.nodeName=="P"))||!Z&&b.pos<d.doc.content.size&&(!b.sameParent(S)||!b.parent.inlineContent)&&!/\S/.test(d.doc.textBetween(b.pos,S.pos,"",""))&&(te=he.findFrom(d.doc.resolve(b.pos+1),1,!0))&&te.head>b.pos)&&r.someProp("handleKeyDown",j=>j(r,yr(13,"Enter")))){r.input.lastIOSEnter=0;return}if(r.state.selection.anchor>x.start&&Gk(p,x.start,x.endA,b,S)&&r.someProp("handleKeyDown",j=>j(r,yr(8,"Backspace")))){En&&ht&&r.domObserver.suppressSelectionUpdates();return}ht&&x.endB==x.start&&(r.input.lastChromeDelete=Date.now()),En&&!Z&&b.start()!=S.start()&&S.parentOffset==0&&b.depth==S.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==x.endA&&(x.endB-=2,S=d.doc.resolveNoCache(x.endB-d.from),setTimeout(()=>{r.someProp("handleKeyDown",function(j){return j(r,yr(13,"Enter"))})},20));let ve=x.start,ue=x.endA,K,G,ee;if(Z){if(b.pos==S.pos)Dt&&Zn<=11&&b.parentOffset==0&&(r.domObserver.suppressSelectionUpdates(),setTimeout(()=>Nn(r),20)),K=r.state.tr.delete(ve,ue),G=p.resolve(x.start).marksAcross(p.resolve(x.endA));else if(x.endA==x.endB&&(ee=Kk(b.parent.content.cut(b.parentOffset,S.parentOffset),E.parent.content.cut(E.parentOffset,x.endA-E.start()))))K=r.state.tr,ee.type=="add"?K.addMark(ve,ue,ee.mark):K.removeMark(ve,ue,ee.mark);else if(b.parent.child(b.index()).isText&&b.index()==S.index()-(S.textOffset?0:1)){let j=b.parent.textBetween(b.parentOffset,S.parentOffset);if(r.someProp("handleTextInput",ke=>ke(r,ve,ue,j)))return;K=r.state.tr.insertText(j,ve,ue)}}if(K||(K=r.state.tr.replace(ve,ue,d.doc.slice(x.start-d.from,x.endB-d.from))),d.sel){let j=Yd(r,K.doc,d.sel);j&&!(ht&&r.composing&&j.empty&&(x.start!=x.endB||r.input.lastChromeDelete<Date.now()-100)&&(j.head==ve||j.head==K.mapping.map(ue)-1)||Dt&&j.empty&&j.head==ve)&&K.setSelection(j)}G&&K.ensureMarks(G),o&&K.setMeta("composition",o),r.dispatch(K.scrollIntoView())}function Yd(r,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:su(r,e.resolve(t.anchor),e.resolve(t.head))}function Kk(r,e){let t=r.firstChild.marks,n=e.firstChild.marks,i=t,o=n,a,u,f;for(let p=0;p<n.length;p++)i=n[p].removeFromSet(i);for(let p=0;p<t.length;p++)o=t[p].removeFromSet(o);if(i.length==1&&o.length==0)u=i[0],a="add",f=p=>p.mark(u.addToSet(p.marks));else if(i.length==0&&o.length==1)u=o[0],a="remove",f=p=>p.mark(u.removeFromSet(p.marks));else return null;let d=[];for(let p=0;p<e.childCount;p++)d.push(f(e.child(p)));if($.from(d).eq(r))return{mark:u,type:a}}function Gk(r,e,t,n,i){if(t-e<=i.pos-n.pos||ba(n,!0,!1)<i.pos)return!1;let o=r.resolve(e);if(!n.parent.isTextblock){let u=o.nodeAfter;return u!=null&&t==e+u.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let a=r.resolve(ba(o,!0,!0));return!a.parent.isTextblock||a.pos>t||ba(a,!0,!1)<t?!1:n.parent.content.cut(n.parentOffset).eq(a.parent.content)}function ba(r,e,t){let n=r.depth,i=e?r.end():r.pos;for(;n>0&&(e||r.indexAfter(n)==r.node(n).childCount);)n--,i++,e=!1;if(t){let o=r.node(n).maybeChild(r.indexAfter(n));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function Yk(r,e,t,n,i){let o=r.findDiffStart(e,t);if(o==null)return null;let{a,b:u}=r.findDiffEnd(e,t+r.size,t+e.size);if(i=="end"){let f=Math.max(0,o-Math.min(a,u));n-=a+f-o}if(a<o&&r.size<e.size){let f=n<=o&&n>=a?o-n:0;o-=f,o&&o<e.size&&jd(e.textBetween(o-1,o+1))&&(o+=f?1:-1),u=o+(u-a),a=o}else if(u<o){let f=n<=o&&n>=u?o-n:0;o-=f,o&&o<r.size&&jd(r.textBetween(o-1,o+1))&&(o+=f?1:-1),a=o+(a-u),u=o}return{start:o,endA:a,endB:u}}function jd(r){if(r.length!=2)return!1;let e=r.charCodeAt(0),t=r.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class jk{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new pk,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(th),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Qd(this),Zd(this),this.nodeViews=eh(this),this.docView=Dd(this.state.doc,Xd(this),va(this),this.dom,this),this.domObserver=new $k(this,(n,i,o,a)=>Jk(this,n,i,o,a)),this.domObserver.start(),mk(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Ha(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(th),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n;let i=this.state,o=!1,a=!1;e.storedMarks&&this.composing&&(Dp(this),a=!0),this.state=e;let u=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(u||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let v=eh(this);Zk(v,this.nodeViews)&&(this.nodeViews=v,o=!0)}(u||t.handleDOMEvents!=this._props.handleDOMEvents)&&Ha(this),this.editable=Qd(this),Zd(this);let f=va(this),d=Xd(this),p=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",m=o||!this.docView.matchesNode(e.doc,d,f);(m||!e.selection.eq(i.selection))&&(a=!0);let y=p=="preserve"&&a&&this.dom.style.overflowAnchor==null&&A_(this);if(a){this.domObserver.stop();let v=m&&(Dt||ht)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&Xk(i.selection,e.selection);if(m){let x=ht?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Ok(this)),(o||!this.docView.update(e.doc,d,f,this))&&(this.docView.updateOuterDeco(d),this.docView.destroy(),this.docView=Dd(e.doc,d,f,this.dom,this)),x&&!this.trackWrites&&(v=!0)}v||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Q_(this))?Nn(this,v):(bp(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((n=this.dragging)===null||n===void 0)&&n.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),p=="reset"?this.dom.scrollTop=0:p=="to selection"?this.scrollToSelection():y&&E_(y)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof re){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&Cd(this,t.getBoundingClientRect(),e)}else Cd(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let n=this.directPlugins[t];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let n=this.state.plugins[t];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}}updateDraggedNode(e,t){let n=e.node,i=-1;if(this.state.doc.nodeAt(n.from)==n.node)i=n.from;else{let o=n.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==n.node&&(i=o)}this.dragging=new Ip(e.slice,e.move,i<0?void 0:re.create(this.state.doc,i))}someProp(e,t){let n=this._props&&this._props[e],i;if(n!=null&&(i=t?t(n):n))return i;for(let a=0;a<this.directPlugins.length;a++){let u=this.directPlugins[a].props[e];if(u!=null&&(i=t?t(u):u))return i}let o=this.state.plugins;if(o)for(let a=0;a<o.length;a++){let u=o[a].props[e];if(u!=null&&(i=t?t(u):u))return i}}hasFocus(){if(Dt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&D_(this.dom),Nn(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return L_(this,e)}coordsAtPos(e,t=1){return fp(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let i=this.docView.posFromDOM(e,t,n);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return z_(this,t||this.state,e)}pasteHTML(e,t){return Ki(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Ki(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return ou(this,e)}destroy(){this.docView&&(gk(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],va(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,v_())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return vk(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?bt&&this.root.nodeType===11&&k_(this.dom.ownerDocument)==this.dom&&zk(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function Xd(r){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(r.editable),r.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(r.state)),t)for(let n in t)n=="class"?e.class+=" "+t[n]:n=="style"?e.style=(e.style?e.style+";":"")+t[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(t[n]))}),e.translate||(e.translate="no"),[Qt.node(0,r.state.doc.content.size,e)]}function Zd(r){if(r.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),r.cursorWrapper={dom:e,deco:Qt.widget(r.state.selection.from,e,{raw:!0,marks:r.markCursor})}}else r.cursorWrapper=null}function Qd(r){return!r.someProp("editable",e=>e(r.state)===!1)}function Xk(r,e){let t=Math.min(r.$anchor.sharedDepth(r.head),e.$anchor.sharedDepth(e.head));return r.$anchor.start(t)!=e.$anchor.start(t)}function eh(r){let e=Object.create(null);function t(n){for(let i in n)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=n[i])}return r.someProp("nodeViews",t),r.someProp("markViews",t),e}function Zk(r,e){let t=0,n=0;for(let i in r){if(r[i]!=e[i])return!0;t++}for(let i in e)n++;return t!=n}function th(r){if(r.spec.state||r.spec.filterTransaction||r.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var tr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},vo={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Qk=typeof navigator<"u"&&/Mac/.test(navigator.platform),eS=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var at=0;at<10;at++)tr[48+at]=tr[96+at]=String(at);for(var at=1;at<=24;at++)tr[at+111]="F"+at;for(var at=65;at<=90;at++)tr[at]=String.fromCharCode(at+32),vo[at]=String.fromCharCode(at);for(var wa in tr)vo.hasOwnProperty(wa)||(vo[wa]=tr[wa]);function tS(r){var e=Qk&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||eS&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",t=!e&&r.key||(r.shiftKey?vo:tr)[r.keyCode]||r.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const nS=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),rS=typeof navigator<"u"&&/Win/.test(navigator.platform);function iS(r){let e=r.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let n,i,o,a;for(let u=0;u<e.length-1;u++){let f=e[u];if(/^(cmd|meta|m)$/i.test(f))a=!0;else if(/^a(lt)?$/i.test(f))n=!0;else if(/^(c|ctrl|control)$/i.test(f))i=!0;else if(/^s(hift)?$/i.test(f))o=!0;else if(/^mod$/i.test(f))nS?a=!0:i=!0;else throw new Error("Unrecognized modifier name: "+f)}return n&&(t="Alt-"+t),i&&(t="Ctrl-"+t),a&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function sS(r){let e=Object.create(null);for(let t in r)e[iS(t)]=r[t];return e}function xa(r,e,t=!0){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),t&&e.shiftKey&&(r="Shift-"+r),r}function oS(r){return new It({props:{handleKeyDown:Fp(r)}})}function Fp(r){let e=sS(r);return function(t,n){let i=tS(n),o,a=e[xa(i,n)];if(a&&a(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(n.shiftKey){let u=e[xa(i,n,!1)];if(u&&u(t.state,t.dispatch,t))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(rS&&n.ctrlKey&&n.altKey)&&(o=tr[n.keyCode])&&o!=i){let u=e[xa(o,n)];if(u&&u(t.state,t.dispatch,t))return!0}}return!1}}const du=(r,e)=>r.selection.empty?!1:(e&&e(r.tr.deleteSelection().scrollIntoView()),!0);function $p(r,e){let{$cursor:t}=r.selection;return!t||(e?!e.endOfTextblock("backward",r):t.parentOffset>0)?null:t}const Vp=(r,e,t)=>{let n=$p(r,t);if(!n)return!1;let i=hu(n);if(!i){let a=n.blockRange(),u=a&&fi(a);return u==null?!1:(e&&e(r.tr.lift(a,u).scrollIntoView()),!0)}let o=i.nodeBefore;if(Yp(r,i,e,-1))return!0;if(n.parent.content.size==0&&(li(o,"end")||re.isSelectable(o)))for(let a=n.depth;;a--){let u=Oo(r.doc,n.before(a),n.after(a),U.empty);if(u&&u.slice.size<u.to-u.from){if(e){let f=r.tr.step(u);f.setSelection(li(o,"end")?he.findFrom(f.doc.resolve(f.mapping.map(i.pos,-1)),-1):re.create(f.doc,i.pos-o.nodeSize)),e(f.scrollIntoView())}return!0}if(a==1||n.node(a-1).childCount>1)break}return o.isAtom&&i.depth==n.depth-1?(e&&e(r.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},lS=(r,e,t)=>{let n=$p(r,t);if(!n)return!1;let i=hu(n);return i?zp(r,i,e):!1},aS=(r,e,t)=>{let n=qp(r,t);if(!n)return!1;let i=pu(n);return i?zp(r,i,e):!1};function zp(r,e,t){let n=e.nodeBefore,i=n,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let p=i.lastChild;if(!p)return!1;i=p}let a=e.nodeAfter,u=a,f=e.pos+1;for(;!u.isTextblock;f++){if(u.type.spec.isolating)return!1;let p=u.firstChild;if(!p)return!1;u=p}let d=Oo(r.doc,o,f,U.empty);if(!d||d.from!=o||d instanceof Xe&&d.slice.size>=f-o)return!1;if(t){let p=r.tr.step(d);p.setSelection(ae.create(p.doc,o)),t(p.scrollIntoView())}return!0}function li(r,e,t=!1){for(let n=r;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(t&&n.childCount!=1)return!1}return!1}const Wp=(r,e,t)=>{let{$head:n,empty:i}=r.selection,o=n;if(!i)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("backward",r):n.parentOffset>0)return!1;o=hu(n)}let a=o&&o.nodeBefore;return!a||!re.isSelectable(a)?!1:(e&&e(r.tr.setSelection(re.create(r.doc,o.pos-a.nodeSize)).scrollIntoView()),!0)};function hu(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){if(r.index(e)>0)return r.doc.resolve(r.before(e+1));if(r.node(e).type.spec.isolating)break}return null}function qp(r,e){let{$cursor:t}=r.selection;return!t||(e?!e.endOfTextblock("forward",r):t.parentOffset<t.parent.content.size)?null:t}const Hp=(r,e,t)=>{let n=qp(r,t);if(!n)return!1;let i=pu(n);if(!i)return!1;let o=i.nodeAfter;if(Yp(r,i,e,1))return!0;if(n.parent.content.size==0&&(li(o,"start")||re.isSelectable(o))){let a=Oo(r.doc,n.before(),n.after(),U.empty);if(a&&a.slice.size<a.to-a.from){if(e){let u=r.tr.step(a);u.setSelection(li(o,"start")?he.findFrom(u.doc.resolve(u.mapping.map(i.pos)),1):re.create(u.doc,u.mapping.map(i.pos))),e(u.scrollIntoView())}return!0}}return o.isAtom&&i.depth==n.depth-1?(e&&e(r.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},Up=(r,e,t)=>{let{$head:n,empty:i}=r.selection,o=n;if(!i)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("forward",r):n.parentOffset<n.parent.content.size)return!1;o=pu(n)}let a=o&&o.nodeAfter;return!a||!re.isSelectable(a)?!1:(e&&e(r.tr.setSelection(re.create(r.doc,o.pos)).scrollIntoView()),!0)};function pu(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){let t=r.node(e);if(r.index(e)+1<t.childCount)return r.doc.resolve(r.after(e+1));if(t.type.spec.isolating)break}return null}const uS=(r,e)=>{let t=r.selection,n=t instanceof re,i;if(n){if(t.node.isTextblock||!rr(r.doc,t.from))return!1;i=t.from}else if(i=To(r.doc,t.from,-1),i==null)return!1;if(e){let o=r.tr.join(i);n&&o.setSelection(re.create(o.doc,i-r.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},cS=(r,e)=>{let t=r.selection,n;if(t instanceof re){if(t.node.isTextblock||!rr(r.doc,t.to))return!1;n=t.to}else if(n=To(r.doc,t.to,1),n==null)return!1;return e&&e(r.tr.join(n).scrollIntoView()),!0},fS=(r,e)=>{let{$from:t,$to:n}=r.selection,i=t.blockRange(n),o=i&&fi(i);return o==null?!1:(e&&e(r.tr.lift(i,o).scrollIntoView()),!0)},Jp=(r,e)=>{let{$head:t,$anchor:n}=r.selection;return!t.parent.type.spec.code||!t.sameParent(n)?!1:(e&&e(r.tr.insertText(`
`).scrollIntoView()),!0)};function mu(r){for(let e=0;e<r.edgeCount;e++){let{type:t}=r.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const dS=(r,e)=>{let{$head:t,$anchor:n}=r.selection;if(!t.parent.type.spec.code||!t.sameParent(n))return!1;let i=t.node(-1),o=t.indexAfter(-1),a=mu(i.contentMatchAt(o));if(!a||!i.canReplaceWith(o,o,a))return!1;if(e){let u=t.after(),f=r.tr.replaceWith(u,u,a.createAndFill());f.setSelection(he.near(f.doc.resolve(u),1)),e(f.scrollIntoView())}return!0},Kp=(r,e)=>{let t=r.selection,{$from:n,$to:i}=t;if(t instanceof zt||n.parent.inlineContent||i.parent.inlineContent)return!1;let o=mu(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let a=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,u=r.tr.insert(a,o.createAndFill());u.setSelection(ae.create(u.doc,a+1)),e(u.scrollIntoView())}return!0},Gp=(r,e)=>{let{$cursor:t}=r.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(Dn(r.doc,o))return e&&e(r.tr.split(o).scrollIntoView()),!0}let n=t.blockRange(),i=n&&fi(n);return i==null?!1:(e&&e(r.tr.lift(n,i).scrollIntoView()),!0)};function hS(r){return(e,t)=>{let{$from:n,$to:i}=e.selection;if(e.selection instanceof re&&e.selection.node.isBlock)return!n.parentOffset||!Dn(e.doc,n.pos)?!1:(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let o=[],a,u,f=!1,d=!1;for(let v=n.depth;;v--)if(n.node(v).isBlock){f=n.end(v)==n.pos+(n.depth-v),d=n.start(v)==n.pos-(n.depth-v),u=mu(n.node(v-1).contentMatchAt(n.indexAfter(v-1))),o.unshift(f&&u?{type:u}:null),a=v;break}else{if(v==1)return!1;o.unshift(null)}let p=e.tr;(e.selection instanceof ae||e.selection instanceof zt)&&p.deleteSelection();let m=p.mapping.map(n.pos),y=Dn(p.doc,m,o.length,o);if(y||(o[0]=u?{type:u}:null,y=Dn(p.doc,m,o.length,o)),!y)return!1;if(p.split(m,o.length,o),!f&&d&&n.node(a).type!=u){let v=p.mapping.map(n.before(a)),x=p.doc.resolve(v);u&&n.node(a-1).canReplaceWith(x.index(),x.index()+1,u)&&p.setNodeMarkup(p.mapping.map(n.before(a)),u)}return t&&t(p.scrollIntoView()),!0}}const pS=hS(),mS=(r,e)=>{let{$from:t,to:n}=r.selection,i,o=t.sharedDepth(n);return o==0?!1:(i=t.before(o),e&&e(r.tr.setSelection(re.create(r.doc,i))),!0)};function gS(r,e,t){let n=e.nodeBefore,i=e.nodeAfter,o=e.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&e.parent.canReplace(o-1,o)?(t&&t(r.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||rr(r.doc,e.pos))?!1:(t&&t(r.tr.join(e.pos).scrollIntoView()),!0)}function Yp(r,e,t,n){let i=e.nodeBefore,o=e.nodeAfter,a,u,f=i.type.spec.isolating||o.type.spec.isolating;if(!f&&gS(r,e,t))return!0;let d=!f&&e.parent.canReplace(e.index(),e.index()+1);if(d&&(a=(u=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&u.matchType(a[0]||o.type).validEnd){if(t){let v=e.pos+o.nodeSize,x=$.empty;for(let E=a.length-1;E>=0;E--)x=$.from(a[E].create(null,x));x=$.from(i.copy(x));let b=r.tr.step(new Ze(e.pos-1,v,e.pos,v,new U(x,1,0),a.length,!0)),S=b.doc.resolve(v+2*a.length);S.nodeAfter&&S.nodeAfter.type==i.type&&rr(b.doc,S.pos)&&b.join(S.pos),t(b.scrollIntoView())}return!0}let p=o.type.spec.isolating||n>0&&f?null:he.findFrom(e,1),m=p&&p.$from.blockRange(p.$to),y=m&&fi(m);if(y!=null&&y>=e.depth)return t&&t(r.tr.lift(m,y).scrollIntoView()),!0;if(d&&li(o,"start",!0)&&li(i,"end")){let v=i,x=[];for(;x.push(v),!v.isTextblock;)v=v.lastChild;let b=o,S=1;for(;!b.isTextblock;b=b.firstChild)S++;if(v.canReplace(v.childCount,v.childCount,b.content)){if(t){let E=$.empty;for(let te=x.length-1;te>=0;te--)E=$.from(x[te].copy(E));let Z=r.tr.step(new Ze(e.pos-x.length,e.pos+o.nodeSize,e.pos+S,e.pos+o.nodeSize-S,new U(E,x.length,0),0,!0));t(Z.scrollIntoView())}return!0}}return!1}function jp(r){return function(e,t){let n=e.selection,i=r<0?n.$from:n.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection(ae.create(e.doc,r<0?i.start(o):i.end(o)))),!0):!1}}const yS=jp(-1),vS=jp(1);function bS(r,e=null){return function(t,n){let{$from:i,$to:o}=t.selection,a=i.blockRange(o),u=a&&tu(a,r,e);return u?(n&&n(t.tr.wrap(a,u).scrollIntoView()),!0):!1}}function nh(r,e=null){return function(t,n){let i=!1;for(let o=0;o<t.selection.ranges.length&&!i;o++){let{$from:{pos:a},$to:{pos:u}}=t.selection.ranges[o];t.doc.nodesBetween(a,u,(f,d)=>{if(i)return!1;if(!(!f.isTextblock||f.hasMarkup(r,e)))if(f.type==r)i=!0;else{let p=t.doc.resolve(d),m=p.index();i=p.parent.canReplaceWith(m,m+1,r)}})}if(!i)return!1;if(n){let o=t.tr;for(let a=0;a<t.selection.ranges.length;a++){let{$from:{pos:u},$to:{pos:f}}=t.selection.ranges[a];o.setBlockType(u,f,r,e)}n(o.scrollIntoView())}return!0}}function gu(...r){return function(e,t,n){for(let i=0;i<r.length;i++)if(r[i](e,t,n))return!0;return!1}}gu(du,Vp,Wp);gu(du,Hp,Up);gu(Jp,Kp,Gp,pS);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function wS(r,e=null){return function(t,n){let{$from:i,$to:o}=t.selection,a=i.blockRange(o);if(!a)return!1;let u=n?t.tr:null;return xS(u,a,r,e)?(n&&n(u.scrollIntoView()),!0):!1}}function xS(r,e,t,n=null){let i=!1,o=e,a=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let f=a.resolve(e.start-2);o=new co(f,f,e.depth),e.endIndex<e.parent.childCount&&(e=new co(e.$from,a.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let u=tu(o,t,n,e);return u?(r&&_S(r,e,u,i,t),!0):!1}function _S(r,e,t,n,i){let o=$.empty;for(let p=t.length-1;p>=0;p--)o=$.from(t[p].type.create(t[p].attrs,o));r.step(new Ze(e.start-(n?2:0),e.end,e.start,e.end,new U(o,0,0),t.length,!0));let a=0;for(let p=0;p<t.length;p++)t[p].type==i&&(a=p+1);let u=t.length-a,f=e.start+t.length-(n?2:0),d=e.parent;for(let p=e.startIndex,m=e.endIndex,y=!0;p<m;p++,y=!1)!y&&Dn(r.doc,f,u)&&(r.split(f,u),f+=2*u),f+=d.child(p).nodeSize;return r}function kS(r){return function(e,t){let{$from:n,$to:i}=e.selection,o=n.blockRange(i,a=>a.childCount>0&&a.firstChild.type==r);return o?t?n.node(o.depth-1).type==r?SS(e,t,r,o):CS(e,t,o):!0:!1}}function SS(r,e,t,n){let i=r.tr,o=n.end,a=n.$to.end(n.depth);o<a&&(i.step(new Ze(o-1,a,o,a,new U($.from(t.create(null,n.parent.copy())),1,0),1,!0)),n=new co(i.doc.resolve(n.$from.pos),i.doc.resolve(a),n.depth));const u=fi(n);if(u==null)return!1;i.lift(n,u);let f=i.doc.resolve(i.mapping.map(o,-1)-1);return rr(i.doc,f.pos)&&f.nodeBefore.type==f.nodeAfter.type&&i.join(f.pos),e(i.scrollIntoView()),!0}function CS(r,e,t){let n=r.tr,i=t.parent;for(let v=t.end,x=t.endIndex-1,b=t.startIndex;x>b;x--)v-=i.child(x).nodeSize,n.delete(v-1,v+1);let o=n.doc.resolve(t.start),a=o.nodeAfter;if(n.mapping.map(t.end)!=t.start+o.nodeAfter.nodeSize)return!1;let u=t.startIndex==0,f=t.endIndex==i.childCount,d=o.node(-1),p=o.index(-1);if(!d.canReplace(p+(u?0:1),p+1,a.content.append(f?$.empty:$.from(i))))return!1;let m=o.pos,y=m+a.nodeSize;return n.step(new Ze(m-(u?1:0),y+(f?1:0),m+1,y-1,new U((u?$.empty:$.from(i.copy($.empty))).append(f?$.empty:$.from(i.copy($.empty))),u?0:1,f?0:1),u?0:1)),e(n.scrollIntoView()),!0}function MS(r){return function(e,t){let{$from:n,$to:i}=e.selection,o=n.blockRange(i,d=>d.childCount>0&&d.firstChild.type==r);if(!o)return!1;let a=o.startIndex;if(a==0)return!1;let u=o.parent,f=u.child(a-1);if(f.type!=r)return!1;if(t){let d=f.lastChild&&f.lastChild.type==u.type,p=$.from(d?r.create():null),m=new U($.from(r.create(null,$.from(u.type.create(null,p)))),d?3:1,0),y=o.start,v=o.end;t(e.tr.step(new Ze(y-(d?3:1),v,y,v,m,1,!0)).scrollIntoView())}return!0}}function Io(r){const{state:e,transaction:t}=r;let{selection:n}=t,{doc:i}=t,{storedMarks:o}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return n},get doc(){return i},get tr(){return n=t.selection,i=t.doc,o=t.storedMarks,t}}}class Ro{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:n}=this,{view:i}=t,{tr:o}=n,a=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([u,f])=>[u,(...p)=>{const m=f(...p)(a);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),m}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:n,editor:i,state:o}=this,{view:a}=i,u=[],f=!!e,d=e||o.tr,p=()=>(!f&&t&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(d),u.every(y=>y===!0)),m={...Object.fromEntries(Object.entries(n).map(([y,v])=>[y,(...b)=>{const S=this.buildProps(d,t),E=v(...b)(S);return u.push(E),m}])),run:p};return m}createCan(e){const{rawCommands:t,state:n}=this,i=!1,o=e||n.tr,a=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(t).map(([f,d])=>[f,(...p)=>d(...p)({...a,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,t=!0){const{rawCommands:n,editor:i,state:o}=this,{view:a}=i,u={tr:e,editor:i,view:a,state:Io({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([f,d])=>[f,(...p)=>d(...p)(u)]))}};return u}}class TS{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const n=this.callbacks[e];return n&&n.forEach(i=>i.apply(this,t)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(i=>i!==t):delete this.callbacks[e]),this}once(e,t){const n=(...i)=>{this.off(e,n),t.apply(this,i)};return this.on(e,n)}removeAllListeners(){this.callbacks={}}}function X(r,e,t){return r.config[e]===void 0&&r.parent?X(r.parent,e,t):typeof r.config[e]=="function"?r.config[e].bind({...t,parent:r.parent?X(r.parent,e,t):null}):r.config[e]}function Po(r){const e=r.filter(i=>i.type==="extension"),t=r.filter(i=>i.type==="node"),n=r.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:n}}function Xp(r){const e=[],{nodeExtensions:t,markExtensions:n}=Po(r),i=[...t,...n],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return r.forEach(a=>{const u={name:a.name,options:a.options,storage:a.storage,extensions:i},f=X(a,"addGlobalAttributes",u);if(!f)return;f().forEach(p=>{p.types.forEach(m=>{Object.entries(p.attributes).forEach(([y,v])=>{e.push({type:m,name:y,attribute:{...o,...v}})})})})}),i.forEach(a=>{const u={name:a.name,options:a.options,storage:a.storage},f=X(a,"addAttributes",u);if(!f)return;const d=f();Object.entries(d).forEach(([p,m])=>{const y={...o,...m};typeof(y==null?void 0:y.default)=="function"&&(y.default=y.default()),y!=null&&y.isRequired&&(y==null?void 0:y.default)===void 0&&delete y.default,e.push({type:a.name,name:p,attribute:y})})}),e}function et(r,e){if(typeof r=="string"){if(!e.nodes[r])throw Error(`There is no node type named '${r}'. Maybe you forgot to add the extension?`);return e.nodes[r]}return r}function _t(...r){return r.filter(e=>!!e).reduce((e,t)=>{const n={...e};return Object.entries(t).forEach(([i,o])=>{if(!n[i]){n[i]=o;return}if(i==="class"){const u=o?String(o).split(" "):[],f=n[i]?n[i].split(" "):[],d=u.filter(p=>!f.includes(p));n[i]=[...f,...d].join(" ")}else if(i==="style"){const u=o?o.split(";").map(p=>p.trim()).filter(Boolean):[],f=n[i]?n[i].split(";").map(p=>p.trim()).filter(Boolean):[],d=new Map;f.forEach(p=>{const[m,y]=p.split(":").map(v=>v.trim());d.set(m,y)}),u.forEach(p=>{const[m,y]=p.split(":").map(v=>v.trim());d.set(m,y)}),n[i]=Array.from(d.entries()).map(([p,m])=>`${p}: ${m}`).join("; ")}else n[i]=o}),n},{})}function Ua(r,e){return e.filter(t=>t.type===r.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(r.attrs)||{}:{[t.name]:r.attrs[t.name]}).reduce((t,n)=>_t(t,n),{})}function Zp(r){return typeof r=="function"}function ye(r,e=void 0,...t){return Zp(r)?e?r.bind(e)(...t):r(...t):r}function OS(r={}){return Object.keys(r).length===0&&r.constructor===Object}function AS(r){return typeof r!="string"?r:r.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(r):r==="true"?!0:r==="false"?!1:r}function rh(r,e){return"style"in r?r:{...r,getAttrs:t=>{const n=r.getAttrs?r.getAttrs(t):r.attrs;if(n===!1)return!1;const i=e.reduce((o,a)=>{const u=a.attribute.parseHTML?a.attribute.parseHTML(t):AS(t.getAttribute(a.name));return u==null?o:{...o,[a.name]:u}},{});return{...n,...i}}}}function ih(r){return Object.fromEntries(Object.entries(r).filter(([e,t])=>e==="attrs"&&OS(t)?!1:t!=null))}function ES(r,e){var t;const n=Xp(r),{nodeExtensions:i,markExtensions:o}=Po(r),a=(t=i.find(d=>X(d,"topNode")))===null||t===void 0?void 0:t.name,u=Object.fromEntries(i.map(d=>{const p=n.filter(E=>E.type===d.name),m={name:d.name,options:d.options,storage:d.storage,editor:e},y=r.reduce((E,Z)=>{const te=X(Z,"extendNodeSchema",m);return{...E,...te?te(d):{}}},{}),v=ih({...y,content:ye(X(d,"content",m)),marks:ye(X(d,"marks",m)),group:ye(X(d,"group",m)),inline:ye(X(d,"inline",m)),atom:ye(X(d,"atom",m)),selectable:ye(X(d,"selectable",m)),draggable:ye(X(d,"draggable",m)),code:ye(X(d,"code",m)),whitespace:ye(X(d,"whitespace",m)),linebreakReplacement:ye(X(d,"linebreakReplacement",m)),defining:ye(X(d,"defining",m)),isolating:ye(X(d,"isolating",m)),attrs:Object.fromEntries(p.map(E=>{var Z;return[E.name,{default:(Z=E==null?void 0:E.attribute)===null||Z===void 0?void 0:Z.default}]}))}),x=ye(X(d,"parseHTML",m));x&&(v.parseDOM=x.map(E=>rh(E,p)));const b=X(d,"renderHTML",m);b&&(v.toDOM=E=>b({node:E,HTMLAttributes:Ua(E,p)}));const S=X(d,"renderText",m);return S&&(v.toText=S),[d.name,v]})),f=Object.fromEntries(o.map(d=>{const p=n.filter(S=>S.type===d.name),m={name:d.name,options:d.options,storage:d.storage,editor:e},y=r.reduce((S,E)=>{const Z=X(E,"extendMarkSchema",m);return{...S,...Z?Z(d):{}}},{}),v=ih({...y,inclusive:ye(X(d,"inclusive",m)),excludes:ye(X(d,"excludes",m)),group:ye(X(d,"group",m)),spanning:ye(X(d,"spanning",m)),code:ye(X(d,"code",m)),attrs:Object.fromEntries(p.map(S=>{var E;return[S.name,{default:(E=S==null?void 0:S.attribute)===null||E===void 0?void 0:E.default}]}))}),x=ye(X(d,"parseHTML",m));x&&(v.parseDOM=x.map(S=>rh(S,p)));const b=X(d,"renderHTML",m);return b&&(v.toDOM=S=>b({mark:S,HTMLAttributes:Ua(S,p)})),[d.name,v]}));return new zh({topNode:a,nodes:u,marks:f})}function _a(r,e){return e.nodes[r]||e.marks[r]||null}function sh(r,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===r.name):e}function yu(r,e){const t=Nr.fromSchema(e).serializeFragment(r),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}const DS=(r,e=500)=>{let t="";const n=r.parentOffset;return r.parent.nodesBetween(Math.max(0,n-e),n,(i,o,a,u)=>{var f,d;const p=((d=(f=i.type.spec).toText)===null||d===void 0?void 0:d.call(f,{node:i,pos:o,parent:a,index:u}))||i.textContent||"%leaf%";t+=i.isAtom&&!i.isText?p:p.slice(0,Math.max(0,n-o))}),t};function vu(r){return Object.prototype.toString.call(r)==="[object RegExp]"}class Lo{constructor(e){this.find=e.find,this.handler=e.handler}}const NS=(r,e)=>{if(vu(e))return e.exec(r);const t=e(r);if(!t)return null;const n=[t.text];return n.index=t.index,n.input=r,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(t.replaceWith)),n};function Xs(r){var e;const{editor:t,from:n,to:i,text:o,rules:a,plugin:u}=r,{view:f}=t;if(f.composing)return!1;const d=f.state.doc.resolve(n);if(d.parent.type.spec.code||!((e=d.nodeBefore||d.nodeAfter)===null||e===void 0)&&e.marks.find(y=>y.type.spec.code))return!1;let p=!1;const m=DS(d)+o;return a.forEach(y=>{if(p)return;const v=NS(m,y.find);if(!v)return;const x=f.state.tr,b=Io({state:f.state,transaction:x}),S={from:n-(v[0].length-o.length),to:i},{commands:E,chain:Z,can:te}=new Ro({editor:t,state:b});y.handler({state:b,range:S,match:v,commands:E,chain:Z,can:te})===null||!x.steps.length||(x.setMeta(u,{transform:x,from:n,to:i,text:o}),f.dispatch(x),p=!0)}),p}function IS(r){const{editor:e,rules:t}=r,n=new It({state:{init(){return null},apply(i,o,a){const u=i.getMeta(n);if(u)return u;const f=i.getMeta("applyInputRules");return!!f&&setTimeout(()=>{let{text:p}=f;typeof p=="string"?p=p:p=yu($.from(p),a.schema);const{from:m}=f,y=m+p.length;Xs({editor:e,from:m,to:y,text:p,rules:t,plugin:n})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,a,u){return Xs({editor:e,from:o,to:a,text:u,rules:t,plugin:n})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&Xs({editor:e,from:o.pos,to:o.pos,text:"",rules:t,plugin:n})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:a}=i.state.selection;return a?Xs({editor:e,from:a.pos,to:a.pos,text:`
`,rules:t,plugin:n}):!1}},isInputRules:!0});return n}function RS(r){return Object.prototype.toString.call(r).slice(8,-1)}function Zs(r){return RS(r)!=="Object"?!1:r.constructor===Object&&Object.getPrototypeOf(r)===Object.prototype}function Bo(r,e){const t={...r};return Zs(r)&&Zs(e)&&Object.keys(e).forEach(n=>{Zs(e[n])&&Zs(r[n])?t[n]=Bo(r[n],e[n]):t[n]=e[n]}),t}class nr{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ye(X(this,"addOptions",{name:this.name}))),this.storage=ye(X(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new nr(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Bo(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new nr(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=ye(X(t,"addOptions",{name:t.name})),t.storage=ye(X(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:n}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const a=i.marks();if(!!!a.find(d=>(d==null?void 0:d.type.name)===t.name))return!1;const f=a.find(d=>(d==null?void 0:d.type.name)===t.name);return f&&n.removeStoredMark(f),n.insertText(" ",i.pos),e.view.dispatch(n),!0}return!1}}function PS(r){return typeof r=="number"}class LS{constructor(e){this.find=e.find,this.handler=e.handler}}const BS=(r,e,t)=>{if(vu(e))return[...r.matchAll(e)];const n=e(r,t);return n?n.map(i=>{const o=[i.text];return o.index=i.index,o.input=r,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function FS(r){const{editor:e,state:t,from:n,to:i,rule:o,pasteEvent:a,dropEvent:u}=r,{commands:f,chain:d,can:p}=new Ro({editor:e,state:t}),m=[];return t.doc.nodesBetween(n,i,(v,x)=>{if(!v.isTextblock||v.type.spec.code)return;const b=Math.max(n,x),S=Math.min(i,x+v.content.size),E=v.textBetween(b-x,S-x,void 0,"");BS(E,o.find,a).forEach(te=>{if(te.index===void 0)return;const ve=b+te.index+1,ue=ve+te[0].length,K={from:t.tr.mapping.map(ve),to:t.tr.mapping.map(ue)},G=o.handler({state:t,range:K,match:te,commands:f,chain:d,can:p,pasteEvent:a,dropEvent:u});m.push(G)})}),m.every(v=>v!==null)}let Qs=null;const $S=r=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",r),t};function VS(r){const{editor:e,rules:t}=r;let n=null,i=!1,o=!1,a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,u;try{u=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{u=null}const f=({state:p,from:m,to:y,rule:v,pasteEvt:x})=>{const b=p.tr,S=Io({state:p,transaction:b});if(!(!FS({editor:e,state:S,from:Math.max(m-1,0),to:y.b-1,rule:v,pasteEvent:x,dropEvent:u})||!b.steps.length)){try{u=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{u=null}return a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,b}};return t.map(p=>new It({view(m){const y=x=>{var b;n=!((b=m.dom.parentElement)===null||b===void 0)&&b.contains(x.target)?m.dom.parentElement:null,n&&(Qs=e)},v=()=>{Qs&&(Qs=null)};return window.addEventListener("dragstart",y),window.addEventListener("dragend",v),{destroy(){window.removeEventListener("dragstart",y),window.removeEventListener("dragend",v)}}},props:{handleDOMEvents:{drop:(m,y)=>{if(o=n===m.dom.parentElement,u=y,!o){const v=Qs;v&&setTimeout(()=>{const x=v.state.selection;x&&v.commands.deleteRange({from:x.from,to:x.to})},10)}return!1},paste:(m,y)=>{var v;const x=(v=y.clipboardData)===null||v===void 0?void 0:v.getData("text/html");return a=y,i=!!(x!=null&&x.includes("data-pm-slice")),!1}}},appendTransaction:(m,y,v)=>{const x=m[0],b=x.getMeta("uiEvent")==="paste"&&!i,S=x.getMeta("uiEvent")==="drop"&&!o,E=x.getMeta("applyPasteRules"),Z=!!E;if(!b&&!S&&!Z)return;if(Z){let{text:ue}=E;typeof ue=="string"?ue=ue:ue=yu($.from(ue),v.schema);const{from:K}=E,G=K+ue.length,ee=$S(ue);return f({rule:p,state:v,from:K,to:{b:G},pasteEvt:ee})}const te=y.doc.content.findDiffStart(v.doc.content),ve=y.doc.content.findDiffEnd(v.doc.content);if(!(!PS(te)||!ve||te===ve.b))return f({rule:p,state:v,from:te,to:ve,pasteEvt:a})}}))}function zS(r){const e=r.filter((t,n)=>r.indexOf(t)!==n);return Array.from(new Set(e))}class ei{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=ei.resolve(e),this.schema=ES(this.extensions,t),this.setupExtensions()}static resolve(e){const t=ei.sort(ei.flatten(e)),n=zS(t.map(i=>i.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const n={name:t.name,options:t.options,storage:t.storage},i=X(t,"addExtensions",n);return i?[t,...this.flatten(i())]:t}).flat(10)}static sort(e){return e.sort((n,i)=>{const o=X(n,"priority")||100,a=X(i,"priority")||100;return o>a?-1:o<a?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:_a(t.name,this.schema)},i=X(t,"addCommands",n);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,t=ei.sort([...this.extensions].reverse()),n=[],i=[],o=t.map(a=>{const u={name:a.name,options:a.options,storage:a.storage,editor:e,type:_a(a.name,this.schema)},f=[],d=X(a,"addKeyboardShortcuts",u);let p={};if(a.type==="mark"&&X(a,"exitable",u)&&(p.ArrowRight=()=>nr.handleExit({editor:e,mark:a})),d){const b=Object.fromEntries(Object.entries(d()).map(([S,E])=>[S,()=>E({editor:e})]));p={...p,...b}}const m=oS(p);f.push(m);const y=X(a,"addInputRules",u);sh(a,e.options.enableInputRules)&&y&&n.push(...y());const v=X(a,"addPasteRules",u);sh(a,e.options.enablePasteRules)&&v&&i.push(...v());const x=X(a,"addProseMirrorPlugins",u);if(x){const b=x();f.push(...b)}return f}).flat();return[IS({editor:e,rules:n}),...VS({editor:e,rules:i}),...o]}get attributes(){return Xp(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Po(this.extensions);return Object.fromEntries(t.filter(n=>!!X(n,"addNodeView")).map(n=>{const i=this.attributes.filter(f=>f.type===n.name),o={name:n.name,options:n.options,storage:n.storage,editor:e,type:et(n.name,this.schema)},a=X(n,"addNodeView",o);if(!a)return[];const u=(f,d,p,m,y)=>{const v=Ua(f,i);return a()({node:f,view:d,getPos:p,decorations:m,innerDecorations:y,editor:e,extension:n,HTMLAttributes:v})};return[n.name,u]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:_a(e.name,this.schema)};e.type==="mark"&&(!((t=ye(X(e,"keepOnSplit",n)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const i=X(e,"onBeforeCreate",n),o=X(e,"onCreate",n),a=X(e,"onUpdate",n),u=X(e,"onSelectionUpdate",n),f=X(e,"onTransaction",n),d=X(e,"onFocus",n),p=X(e,"onBlur",n),m=X(e,"onDestroy",n);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),a&&this.editor.on("update",a),u&&this.editor.on("selectionUpdate",u),f&&this.editor.on("transaction",f),d&&this.editor.on("focus",d),p&&this.editor.on("blur",p),m&&this.editor.on("destroy",m)})}}class kt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ye(X(this,"addOptions",{name:this.name}))),this.storage=ye(X(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new kt(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Bo(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new kt({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=ye(X(t,"addOptions",{name:t.name})),t.storage=ye(X(t,"addStorage",{name:t.name,options:t.options})),t}}function Qp(r,e,t){const{from:n,to:i}=e,{blockSeparator:o=`

`,textSerializers:a={}}=t||{};let u="";return r.nodesBetween(n,i,(f,d,p,m)=>{var y;f.isBlock&&d>n&&(u+=o);const v=a==null?void 0:a[f.type.name];if(v)return p&&(u+=v({node:f,pos:d,parent:p,index:m,range:e})),!1;f.isText&&(u+=(y=f==null?void 0:f.text)===null||y===void 0?void 0:y.slice(Math.max(n,d)-d,i-d))}),u}function em(r){return Object.fromEntries(Object.entries(r.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const WS=kt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new It({key:new yn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:r}=this,{state:e,schema:t}=r,{doc:n,selection:i}=e,{ranges:o}=i,a=Math.min(...o.map(p=>p.$from.pos)),u=Math.max(...o.map(p=>p.$to.pos)),f=em(t);return Qp(n,{from:a,to:u},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:f})}}})]}}),qS=()=>({editor:r,view:e})=>(requestAnimationFrame(()=>{var t;r.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),HS=(r=!1)=>({commands:e})=>e.setContent("",r),US=()=>({state:r,tr:e,dispatch:t})=>{const{selection:n}=e,{ranges:i}=n;return t&&i.forEach(({$from:o,$to:a})=>{r.doc.nodesBetween(o.pos,a.pos,(u,f)=>{if(u.type.isText)return;const{doc:d,mapping:p}=e,m=d.resolve(p.map(f)),y=d.resolve(p.map(f+u.nodeSize)),v=m.blockRange(y);if(!v)return;const x=fi(v);if(u.type.isTextblock){const{defaultType:b}=m.parent.contentMatchAt(m.index());e.setNodeMarkup(v.start,b)}(x||x===0)&&e.lift(v,x)})}),!0},JS=r=>e=>r(e),KS=()=>({state:r,dispatch:e})=>Kp(r,e),GS=(r,e)=>({editor:t,tr:n})=>{const{state:i}=t,o=i.doc.slice(r.from,r.to);n.deleteRange(r.from,r.to);const a=n.mapping.map(e);return n.insert(a,o.content),n.setSelection(new ae(n.doc.resolve(a-1))),!0},YS=()=>({tr:r,dispatch:e})=>{const{selection:t}=r,n=t.$anchor.node();if(n.content.size>0)return!1;const i=r.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===n.type){if(e){const u=i.before(o),f=i.after(o);r.delete(u,f).scrollIntoView()}return!0}return!1},jS=r=>({tr:e,state:t,dispatch:n})=>{const i=et(r,t.schema),o=e.selection.$anchor;for(let a=o.depth;a>0;a-=1)if(o.node(a).type===i){if(n){const f=o.before(a),d=o.after(a);e.delete(f,d).scrollIntoView()}return!0}return!1},XS=r=>({tr:e,dispatch:t})=>{const{from:n,to:i}=r;return t&&e.delete(n,i),!0},ZS=()=>({state:r,dispatch:e})=>du(r,e),QS=()=>({commands:r})=>r.keyboardShortcut("Enter"),eC=()=>({state:r,dispatch:e})=>dS(r,e);function bo(r,e,t={strict:!0}){const n=Object.keys(e);return n.length?n.every(i=>t.strict?e[i]===r[i]:vu(e[i])?e[i].test(r[i]):e[i]===r[i]):!0}function tm(r,e,t={}){return r.find(n=>n.type===e&&bo(Object.fromEntries(Object.keys(t).map(i=>[i,n.attrs[i]])),t))}function oh(r,e,t={}){return!!tm(r,e,t)}function bu(r,e,t){var n;if(!r||!e)return;let i=r.parent.childAfter(r.parentOffset);if((!i.node||!i.node.marks.some(p=>p.type===e))&&(i=r.parent.childBefore(r.parentOffset)),!i.node||!i.node.marks.some(p=>p.type===e)||(t=t||((n=i.node.marks[0])===null||n===void 0?void 0:n.attrs),!tm([...i.node.marks],e,t)))return;let a=i.index,u=r.start()+i.offset,f=a+1,d=u+i.node.nodeSize;for(;a>0&&oh([...r.parent.child(a-1).marks],e,t);)a-=1,u-=r.parent.child(a).nodeSize;for(;f<r.parent.childCount&&oh([...r.parent.child(f).marks],e,t);)d+=r.parent.child(f).nodeSize,f+=1;return{from:u,to:d}}function sr(r,e){if(typeof r=="string"){if(!e.marks[r])throw Error(`There is no mark type named '${r}'. Maybe you forgot to add the extension?`);return e.marks[r]}return r}const tC=(r,e={})=>({tr:t,state:n,dispatch:i})=>{const o=sr(r,n.schema),{doc:a,selection:u}=t,{$from:f,from:d,to:p}=u;if(i){const m=bu(f,o,e);if(m&&m.from<=d&&m.to>=p){const y=ae.create(a,m.from,m.to);t.setSelection(y)}}return!0},nC=r=>e=>{const t=typeof r=="function"?r(e):r;for(let n=0;n<t.length;n+=1)if(t[n](e))return!0;return!1};function nm(r){return r instanceof ae}function _r(r=0,e=0,t=0){return Math.min(Math.max(r,e),t)}function rm(r,e=null){if(!e)return null;const t=he.atStart(r),n=he.atEnd(r);if(e==="start"||e===!0)return t;if(e==="end")return n;const i=t.from,o=n.to;return e==="all"?ae.create(r,_r(0,i,o),_r(r.content.size,i,o)):ae.create(r,_r(e,i,o),_r(e,i,o))}function rC(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function wu(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const iC=(r=null,e={})=>({editor:t,view:n,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const a=()=>{(wu()||rC())&&n.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(n.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(n.hasFocus()&&r===null||r===!1)return!0;if(o&&r===null&&!nm(t.state.selection))return a(),!0;const u=rm(i.doc,r)||t.state.selection,f=t.state.selection.eq(u);return o&&(f||i.setSelection(u),f&&i.storedMarks&&i.setStoredMarks(i.storedMarks),a()),!0},sC=(r,e)=>t=>r.every((n,i)=>e(n,{...t,index:i})),oC=(r,e)=>({tr:t,commands:n})=>n.insertContentAt({from:t.selection.from,to:t.selection.to},r,e),im=r=>{const e=r.childNodes;for(let t=e.length-1;t>=0;t-=1){const n=e[t];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?r.removeChild(n):n.nodeType===1&&im(n)}return r};function eo(r){const e=`<body>${r}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return im(t)}function wo(r,e,t){if(r instanceof jn||r instanceof $)return r;t={slice:!0,parseOptions:{},...t};const n=typeof r=="object"&&r!==null,i=typeof r=="string";if(n)try{if(Array.isArray(r)&&r.length>0)return $.fromArray(r.map(u=>e.nodeFromJSON(u)));const a=e.nodeFromJSON(r);return t.errorOnInvalidContent&&a.check(),a}catch(o){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",r,"Error:",o),wo("",e,t)}if(i){if(t.errorOnInvalidContent){let a=!1,u="";const f=new zh({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:d=>(a=!0,u=typeof d=="string"?d:d.outerHTML,null)}]}})});if(t.slice?Xn.fromSchema(f).parseSlice(eo(r),t.parseOptions):Xn.fromSchema(f).parse(eo(r),t.parseOptions),t.errorOnInvalidContent&&a)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${u}`)})}const o=Xn.fromSchema(e);return t.slice?o.parseSlice(eo(r),t.parseOptions).content:o.parse(eo(r),t.parseOptions)}return wo("",e,t)}function lC(r,e,t){const n=r.steps.length-1;if(n<e)return;const i=r.steps[n];if(!(i instanceof Xe||i instanceof Ze))return;const o=r.mapping.maps[n];let a=0;o.forEach((u,f,d,p)=>{a===0&&(a=p)}),r.setSelection(he.near(r.doc.resolve(a),t))}const aC=r=>!("type"in r),uC=(r,e,t)=>({tr:n,dispatch:i,editor:o})=>{var a;if(i){t={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let u;try{u=wo(e,o.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions},errorOnInvalidContent:(a=t.errorOnInvalidContent)!==null&&a!==void 0?a:o.options.enableContentCheck})}catch(x){return o.emit("contentError",{editor:o,error:x,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}}),!1}let{from:f,to:d}=typeof r=="number"?{from:r,to:r}:{from:r.from,to:r.to},p=!0,m=!0;if((aC(u)?u:[u]).forEach(x=>{x.check(),p=p?x.isText&&x.marks.length===0:!1,m=m?x.isBlock:!1}),f===d&&m){const{parent:x}=n.doc.resolve(f);x.isTextblock&&!x.type.spec.code&&!x.childCount&&(f-=1,d+=1)}let v;if(p){if(Array.isArray(e))v=e.map(x=>x.text||"").join("");else if(e instanceof $){let x="";e.forEach(b=>{b.text&&(x+=b.text)}),v=x}else typeof e=="object"&&e&&e.text?v=e.text:v=e;n.insertText(v,f,d)}else v=u,n.replaceWith(f,d,v);t.updateSelection&&lC(n,n.steps.length-1,-1),t.applyInputRules&&n.setMeta("applyInputRules",{from:f,text:v}),t.applyPasteRules&&n.setMeta("applyPasteRules",{from:f,text:v})}return!0},cC=()=>({state:r,dispatch:e})=>uS(r,e),fC=()=>({state:r,dispatch:e})=>cS(r,e),dC=()=>({state:r,dispatch:e})=>Vp(r,e),hC=()=>({state:r,dispatch:e})=>Hp(r,e),pC=()=>({state:r,dispatch:e,tr:t})=>{try{const n=To(r.doc,r.selection.$from.pos,-1);return n==null?!1:(t.join(n,2),e&&e(t),!0)}catch{return!1}},mC=()=>({state:r,dispatch:e,tr:t})=>{try{const n=To(r.doc,r.selection.$from.pos,1);return n==null?!1:(t.join(n,2),e&&e(t),!0)}catch{return!1}},gC=()=>({state:r,dispatch:e})=>lS(r,e),yC=()=>({state:r,dispatch:e})=>aS(r,e);function sm(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function vC(r){const e=r.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let n,i,o,a;for(let u=0;u<e.length-1;u+=1){const f=e[u];if(/^(cmd|meta|m)$/i.test(f))a=!0;else if(/^a(lt)?$/i.test(f))n=!0;else if(/^(c|ctrl|control)$/i.test(f))i=!0;else if(/^s(hift)?$/i.test(f))o=!0;else if(/^mod$/i.test(f))wu()||sm()?a=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${f}`)}return n&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),a&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}const bC=r=>({editor:e,view:t,tr:n,dispatch:i})=>{const o=vC(r).split(/-(?!$)/),a=o.find(d=>!["Alt","Ctrl","Meta","Shift"].includes(d)),u=new KeyboardEvent("keydown",{key:a==="Space"?" ":a,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),f=e.captureTransaction(()=>{t.someProp("handleKeyDown",d=>d(t,u))});return f==null||f.steps.forEach(d=>{const p=d.map(n.mapping);p&&i&&n.maybeStep(p)}),!0};function Yi(r,e,t={}){const{from:n,to:i,empty:o}=r.selection,a=e?et(e,r.schema):null,u=[];r.doc.nodesBetween(n,i,(m,y)=>{if(m.isText)return;const v=Math.max(n,y),x=Math.min(i,y+m.nodeSize);u.push({node:m,from:v,to:x})});const f=i-n,d=u.filter(m=>a?a.name===m.node.type.name:!0).filter(m=>bo(m.node.attrs,t,{strict:!1}));return o?!!d.length:d.reduce((m,y)=>m+y.to-y.from,0)>=f}const wC=(r,e={})=>({state:t,dispatch:n})=>{const i=et(r,t.schema);return Yi(t,i,e)?fS(t,n):!1},xC=()=>({state:r,dispatch:e})=>Gp(r,e),_C=r=>({state:e,dispatch:t})=>{const n=et(r,e.schema);return kS(n)(e,t)},kC=()=>({state:r,dispatch:e})=>Jp(r,e);function Fo(r,e){return e.nodes[r]?"node":e.marks[r]?"mark":null}function lh(r,e){const t=typeof e=="string"?[e]:e;return Object.keys(r).reduce((n,i)=>(t.includes(i)||(n[i]=r[i]),n),{})}const SC=(r,e)=>({tr:t,state:n,dispatch:i})=>{let o=null,a=null;const u=Fo(typeof r=="string"?r:r.name,n.schema);return u?(u==="node"&&(o=et(r,n.schema)),u==="mark"&&(a=sr(r,n.schema)),i&&t.selection.ranges.forEach(f=>{n.doc.nodesBetween(f.$from.pos,f.$to.pos,(d,p)=>{o&&o===d.type&&t.setNodeMarkup(p,void 0,lh(d.attrs,e)),a&&d.marks.length&&d.marks.forEach(m=>{a===m.type&&t.addMark(p,p+d.nodeSize,a.create(lh(m.attrs,e)))})})}),!0):!1},CC=()=>({tr:r,dispatch:e})=>(e&&r.scrollIntoView(),!0),MC=()=>({tr:r,dispatch:e})=>{if(e){const t=new zt(r.doc);r.setSelection(t)}return!0},TC=()=>({state:r,dispatch:e})=>Wp(r,e),OC=()=>({state:r,dispatch:e})=>Up(r,e),AC=()=>({state:r,dispatch:e})=>mS(r,e),EC=()=>({state:r,dispatch:e})=>vS(r,e),DC=()=>({state:r,dispatch:e})=>yS(r,e);function Ja(r,e,t={},n={}){return wo(r,e,{slice:!1,parseOptions:t,errorOnInvalidContent:n.errorOnInvalidContent})}const NC=(r,e=!1,t={},n={})=>({editor:i,tr:o,dispatch:a,commands:u})=>{var f,d;const{doc:p}=o;if(t.preserveWhitespace!=="full"){const m=Ja(r,i.schema,t,{errorOnInvalidContent:(f=n.errorOnInvalidContent)!==null&&f!==void 0?f:i.options.enableContentCheck});return a&&o.replaceWith(0,p.content.size,m).setMeta("preventUpdate",!e),!0}return a&&o.setMeta("preventUpdate",!e),u.insertContentAt({from:0,to:p.content.size},r,{parseOptions:t,errorOnInvalidContent:(d=n.errorOnInvalidContent)!==null&&d!==void 0?d:i.options.enableContentCheck})};function om(r,e){const t=sr(e,r.schema),{from:n,to:i,empty:o}=r.selection,a=[];o?(r.storedMarks&&a.push(...r.storedMarks),a.push(...r.selection.$head.marks())):r.doc.nodesBetween(n,i,f=>{a.push(...f.marks)});const u=a.find(f=>f.type.name===t.name);return u?{...u.attrs}:{}}function IC(r){for(let e=0;e<r.edgeCount;e+=1){const{type:t}=r.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function RC(r,e){for(let t=r.depth;t>0;t-=1){const n=r.node(t);if(e(n))return{pos:t>0?r.before(t):0,start:r.start(t),depth:t,node:n}}}function xu(r){return e=>RC(e.$from,r)}function PC(r,e){const t={from:0,to:r.content.size};return Qp(r,t,e)}function LC(r,e){const t=et(e,r.schema),{from:n,to:i}=r.selection,o=[];r.doc.nodesBetween(n,i,u=>{o.push(u)});const a=o.reverse().find(u=>u.type.name===t.name);return a?{...a.attrs}:{}}function BC(r,e){const t=Fo(typeof e=="string"?e:e.name,r.schema);return t==="node"?LC(r,e):t==="mark"?om(r,e):{}}function lm(r,e,t){const n=[];return r===e?t.resolve(r).marks().forEach(i=>{const o=t.resolve(r),a=bu(o,i.type);a&&n.push({mark:i,...a})}):t.nodesBetween(r,e,(i,o)=>{!i||(i==null?void 0:i.nodeSize)===void 0||n.push(...i.marks.map(a=>({from:o,to:o+i.nodeSize,mark:a})))}),n}function so(r,e,t){return Object.fromEntries(Object.entries(t).filter(([n])=>{const i=r.find(o=>o.type===e&&o.name===n);return i?i.attribute.keepOnSplit:!1}))}function Ka(r,e,t={}){const{empty:n,ranges:i}=r.selection,o=e?sr(e,r.schema):null;if(n)return!!(r.storedMarks||r.selection.$from.marks()).filter(m=>o?o.name===m.type.name:!0).find(m=>bo(m.attrs,t,{strict:!1}));let a=0;const u=[];if(i.forEach(({$from:m,$to:y})=>{const v=m.pos,x=y.pos;r.doc.nodesBetween(v,x,(b,S)=>{if(!b.isText&&!b.marks.length)return;const E=Math.max(v,S),Z=Math.min(x,S+b.nodeSize),te=Z-E;a+=te,u.push(...b.marks.map(ve=>({mark:ve,from:E,to:Z})))})}),a===0)return!1;const f=u.filter(m=>o?o.name===m.mark.type.name:!0).filter(m=>bo(m.mark.attrs,t,{strict:!1})).reduce((m,y)=>m+y.to-y.from,0),d=u.filter(m=>o?m.mark.type!==o&&m.mark.type.excludes(o):!0).reduce((m,y)=>m+y.to-y.from,0);return(f>0?f+d:f)>=a}function FC(r,e,t={}){if(!e)return Yi(r,null,t)||Ka(r,null,t);const n=Fo(e,r.schema);return n==="node"?Yi(r,e,t):n==="mark"?Ka(r,e,t):!1}function ah(r,e){const{nodeExtensions:t}=Po(e),n=t.find(a=>a.name===r);if(!n)return!1;const i={name:n.name,options:n.options,storage:n.storage},o=ye(X(n,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function _u(r,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var n;if(t){if(r.type.name==="hardBreak")return!0;if(r.isText)return/^\s*$/m.test((n=r.text)!==null&&n!==void 0?n:"")}if(r.isText)return!r.text;if(r.isAtom||r.isLeaf)return!1;if(r.content.childCount===0)return!0;if(e){let i=!0;return r.content.forEach(o=>{i!==!1&&(_u(o,{ignoreWhitespace:t,checkChildren:e})||(i=!1))}),i}return!1}function $C(r){return r instanceof re}function VC(r,e,t){var n;const{selection:i}=e;let o=null;if(nm(i)&&(o=i.$cursor),o){const u=(n=r.storedMarks)!==null&&n!==void 0?n:o.marks();return!!t.isInSet(u)||!u.some(f=>f.type.excludes(t))}const{ranges:a}=i;return a.some(({$from:u,$to:f})=>{let d=u.depth===0?r.doc.inlineContent&&r.doc.type.allowsMarkType(t):!1;return r.doc.nodesBetween(u.pos,f.pos,(p,m,y)=>{if(d)return!1;if(p.isInline){const v=!y||y.type.allowsMarkType(t),x=!!t.isInSet(p.marks)||!p.marks.some(b=>b.type.excludes(t));d=v&&x}return!d}),d})}const zC=(r,e={})=>({tr:t,state:n,dispatch:i})=>{const{selection:o}=t,{empty:a,ranges:u}=o,f=sr(r,n.schema);if(i)if(a){const d=om(n,f);t.addStoredMark(f.create({...d,...e}))}else u.forEach(d=>{const p=d.$from.pos,m=d.$to.pos;n.doc.nodesBetween(p,m,(y,v)=>{const x=Math.max(v,p),b=Math.min(v+y.nodeSize,m);y.marks.find(E=>E.type===f)?y.marks.forEach(E=>{f===E.type&&t.addMark(x,b,f.create({...E.attrs,...e}))}):t.addMark(x,b,f.create(e))})});return VC(n,t,f)},WC=(r,e)=>({tr:t})=>(t.setMeta(r,e),!0),qC=(r,e={})=>({state:t,dispatch:n,chain:i})=>{const o=et(r,t.schema);let a;return t.selection.$anchor.sameParent(t.selection.$head)&&(a=t.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:u})=>nh(o,{...a,...e})(t)?!0:u.clearNodes()).command(({state:u})=>nh(o,{...a,...e})(u,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},HC=r=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,i=_r(r,0,n.content.size),o=re.create(n,i);e.setSelection(o)}return!0},UC=r=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,{from:i,to:o}=typeof r=="number"?{from:r,to:r}:r,a=ae.atStart(n).from,u=ae.atEnd(n).to,f=_r(i,a,u),d=_r(o,a,u),p=ae.create(n,f,d);e.setSelection(p)}return!0},JC=r=>({state:e,dispatch:t})=>{const n=et(r,e.schema);return MS(n)(e,t)};function uh(r,e){const t=r.storedMarks||r.selection.$to.parentOffset&&r.selection.$from.marks();if(t){const n=t.filter(i=>e==null?void 0:e.includes(i.type.name));r.tr.ensureMarks(n)}}const KC=({keepMarks:r=!0}={})=>({tr:e,state:t,dispatch:n,editor:i})=>{const{selection:o,doc:a}=e,{$from:u,$to:f}=o,d=i.extensionManager.attributes,p=so(d,u.node().type.name,u.node().attrs);if(o instanceof re&&o.node.isBlock)return!u.parentOffset||!Dn(a,u.pos)?!1:(n&&(r&&uh(t,i.extensionManager.splittableMarks),e.split(u.pos).scrollIntoView()),!0);if(!u.parent.isBlock)return!1;const m=f.parentOffset===f.parent.content.size,y=u.depth===0?void 0:IC(u.node(-1).contentMatchAt(u.indexAfter(-1)));let v=m&&y?[{type:y,attrs:p}]:void 0,x=Dn(e.doc,e.mapping.map(u.pos),1,v);if(!v&&!x&&Dn(e.doc,e.mapping.map(u.pos),1,y?[{type:y}]:void 0)&&(x=!0,v=y?[{type:y,attrs:p}]:void 0),n){if(x&&(o instanceof ae&&e.deleteSelection(),e.split(e.mapping.map(u.pos),1,v),y&&!m&&!u.parentOffset&&u.parent.type!==y)){const b=e.mapping.map(u.before()),S=e.doc.resolve(b);u.node(-1).canReplaceWith(S.index(),S.index()+1,y)&&e.setNodeMarkup(e.mapping.map(u.before()),y)}r&&uh(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return x},GC=(r,e={})=>({tr:t,state:n,dispatch:i,editor:o})=>{var a;const u=et(r,n.schema),{$from:f,$to:d}=n.selection,p=n.selection.node;if(p&&p.isBlock||f.depth<2||!f.sameParent(d))return!1;const m=f.node(-1);if(m.type!==u)return!1;const y=o.extensionManager.attributes;if(f.parent.content.size===0&&f.node(-1).childCount===f.indexAfter(-1)){if(f.depth===2||f.node(-3).type!==u||f.index(-2)!==f.node(-2).childCount-1)return!1;if(i){let E=$.empty;const Z=f.index(-1)?1:f.index(-2)?2:3;for(let ee=f.depth-Z;ee>=f.depth-3;ee-=1)E=$.from(f.node(ee).copy(E));const te=f.indexAfter(-1)<f.node(-2).childCount?1:f.indexAfter(-2)<f.node(-3).childCount?2:3,ve={...so(y,f.node().type.name,f.node().attrs),...e},ue=((a=u.contentMatch.defaultType)===null||a===void 0?void 0:a.createAndFill(ve))||void 0;E=E.append($.from(u.createAndFill(null,ue)||void 0));const K=f.before(f.depth-(Z-1));t.replace(K,f.after(-te),new U(E,4-Z,0));let G=-1;t.doc.nodesBetween(K,t.doc.content.size,(ee,j)=>{if(G>-1)return!1;ee.isTextblock&&ee.content.size===0&&(G=j+1)}),G>-1&&t.setSelection(ae.near(t.doc.resolve(G))),t.scrollIntoView()}return!0}const v=d.pos===f.end()?m.contentMatchAt(0).defaultType:null,x={...so(y,m.type.name,m.attrs),...e},b={...so(y,f.node().type.name,f.node().attrs),...e};t.delete(f.pos,d.pos);const S=v?[{type:u,attrs:x},{type:v,attrs:b}]:[{type:u,attrs:x}];if(!Dn(t.doc,f.pos,2))return!1;if(i){const{selection:E,storedMarks:Z}=n,{splittableMarks:te}=o.extensionManager,ve=Z||E.$to.parentOffset&&E.$from.marks();if(t.split(f.pos,2,S).scrollIntoView(),!ve||!i)return!0;const ue=ve.filter(K=>te.includes(K.type.name));t.ensureMarks(ue)}return!0},ka=(r,e)=>{const t=xu(a=>a.type===e)(r.selection);if(!t)return!0;const n=r.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(n===void 0)return!0;const i=r.doc.nodeAt(n);return t.node.type===(i==null?void 0:i.type)&&rr(r.doc,t.pos)&&r.join(t.pos),!0},Sa=(r,e)=>{const t=xu(a=>a.type===e)(r.selection);if(!t)return!0;const n=r.doc.resolve(t.start).after(t.depth);if(n===void 0)return!0;const i=r.doc.nodeAt(n);return t.node.type===(i==null?void 0:i.type)&&rr(r.doc,n)&&r.join(n),!0},YC=(r,e,t,n={})=>({editor:i,tr:o,state:a,dispatch:u,chain:f,commands:d,can:p})=>{const{extensions:m,splittableMarks:y}=i.extensionManager,v=et(r,a.schema),x=et(e,a.schema),{selection:b,storedMarks:S}=a,{$from:E,$to:Z}=b,te=E.blockRange(Z),ve=S||b.$to.parentOffset&&b.$from.marks();if(!te)return!1;const ue=xu(K=>ah(K.type.name,m))(b);if(te.depth>=1&&ue&&te.depth-ue.depth<=1){if(ue.node.type===v)return d.liftListItem(x);if(ah(ue.node.type.name,m)&&v.validContent(ue.node.content)&&u)return f().command(()=>(o.setNodeMarkup(ue.pos,v),!0)).command(()=>ka(o,v)).command(()=>Sa(o,v)).run()}return!t||!ve||!u?f().command(()=>p().wrapInList(v,n)?!0:d.clearNodes()).wrapInList(v,n).command(()=>ka(o,v)).command(()=>Sa(o,v)).run():f().command(()=>{const K=p().wrapInList(v,n),G=ve.filter(ee=>y.includes(ee.type.name));return o.ensureMarks(G),K?!0:d.clearNodes()}).wrapInList(v,n).command(()=>ka(o,v)).command(()=>Sa(o,v)).run()},jC=(r,e={},t={})=>({state:n,commands:i})=>{const{extendEmptyMarkRange:o=!1}=t,a=sr(r,n.schema);return Ka(n,a,e)?i.unsetMark(a,{extendEmptyMarkRange:o}):i.setMark(a,e)},XC=(r,e,t={})=>({state:n,commands:i})=>{const o=et(r,n.schema),a=et(e,n.schema),u=Yi(n,o,t);let f;return n.selection.$anchor.sameParent(n.selection.$head)&&(f=n.selection.$anchor.parent.attrs),u?i.setNode(a,f):i.setNode(o,{...f,...t})},ZC=(r,e={})=>({state:t,commands:n})=>{const i=et(r,t.schema);return Yi(t,i,e)?n.lift(i):n.wrapIn(i,e)},QC=()=>({state:r,dispatch:e})=>{const t=r.plugins;for(let n=0;n<t.length;n+=1){const i=t[n];let o;if(i.spec.isInputRules&&(o=i.getState(r))){if(e){const a=r.tr,u=o.transform;for(let f=u.steps.length-1;f>=0;f-=1)a.step(u.steps[f].invert(u.docs[f]));if(o.text){const f=a.doc.resolve(o.from).marks();a.replaceWith(o.from,o.to,r.schema.text(o.text,f))}else a.delete(o.from,o.to)}return!0}}return!1},eM=()=>({tr:r,dispatch:e})=>{const{selection:t}=r,{empty:n,ranges:i}=t;return n||e&&i.forEach(o=>{r.removeMark(o.$from.pos,o.$to.pos)}),!0},tM=(r,e={})=>({tr:t,state:n,dispatch:i})=>{var o;const{extendEmptyMarkRange:a=!1}=e,{selection:u}=t,f=sr(r,n.schema),{$from:d,empty:p,ranges:m}=u;if(!i)return!0;if(p&&a){let{from:y,to:v}=u;const x=(o=d.marks().find(S=>S.type===f))===null||o===void 0?void 0:o.attrs,b=bu(d,f,x);b&&(y=b.from,v=b.to),t.removeMark(y,v,f)}else m.forEach(y=>{t.removeMark(y.$from.pos,y.$to.pos,f)});return t.removeStoredMark(f),!0},nM=(r,e={})=>({tr:t,state:n,dispatch:i})=>{let o=null,a=null;const u=Fo(typeof r=="string"?r:r.name,n.schema);return u?(u==="node"&&(o=et(r,n.schema)),u==="mark"&&(a=sr(r,n.schema)),i&&t.selection.ranges.forEach(f=>{const d=f.$from.pos,p=f.$to.pos;let m,y,v,x;t.selection.empty?n.doc.nodesBetween(d,p,(b,S)=>{o&&o===b.type&&(v=Math.max(S,d),x=Math.min(S+b.nodeSize,p),m=S,y=b)}):n.doc.nodesBetween(d,p,(b,S)=>{S<d&&o&&o===b.type&&(v=Math.max(S,d),x=Math.min(S+b.nodeSize,p),m=S,y=b),S>=d&&S<=p&&(o&&o===b.type&&t.setNodeMarkup(S,void 0,{...b.attrs,...e}),a&&b.marks.length&&b.marks.forEach(E=>{if(a===E.type){const Z=Math.max(S,d),te=Math.min(S+b.nodeSize,p);t.addMark(Z,te,a.create({...E.attrs,...e}))}}))}),y&&(m!==void 0&&t.setNodeMarkup(m,void 0,{...y.attrs,...e}),a&&y.marks.length&&y.marks.forEach(b=>{a===b.type&&t.addMark(v,x,a.create({...b.attrs,...e}))}))}),!0):!1},rM=(r,e={})=>({state:t,dispatch:n})=>{const i=et(r,t.schema);return bS(i,e)(t,n)},iM=(r,e={})=>({state:t,dispatch:n})=>{const i=et(r,t.schema);return wS(i,e)(t,n)};var sM=Object.freeze({__proto__:null,blur:qS,clearContent:HS,clearNodes:US,command:JS,createParagraphNear:KS,cut:GS,deleteCurrentNode:YS,deleteNode:jS,deleteRange:XS,deleteSelection:ZS,enter:QS,exitCode:eC,extendMarkRange:tC,first:nC,focus:iC,forEach:sC,insertContent:oC,insertContentAt:uC,joinBackward:dC,joinDown:fC,joinForward:hC,joinItemBackward:pC,joinItemForward:mC,joinTextblockBackward:gC,joinTextblockForward:yC,joinUp:cC,keyboardShortcut:bC,lift:wC,liftEmptyBlock:xC,liftListItem:_C,newlineInCode:kC,resetAttributes:SC,scrollIntoView:CC,selectAll:MC,selectNodeBackward:TC,selectNodeForward:OC,selectParentNode:AC,selectTextblockEnd:EC,selectTextblockStart:DC,setContent:NC,setMark:zC,setMeta:WC,setNode:qC,setNodeSelection:HC,setTextSelection:UC,sinkListItem:JC,splitBlock:KC,splitListItem:GC,toggleList:YC,toggleMark:jC,toggleNode:XC,toggleWrap:ZC,undoInputRule:QC,unsetAllMarks:eM,unsetMark:tM,updateAttributes:nM,wrapIn:rM,wrapInList:iM});const oM=kt.create({name:"commands",addCommands(){return{...sM}}}),lM=kt.create({name:"drop",addProseMirrorPlugins(){return[new It({key:new yn("tiptapDrop"),props:{handleDrop:(r,e,t,n)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:n})}}})]}}),aM=kt.create({name:"editable",addProseMirrorPlugins(){return[new It({key:new yn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),uM=new yn("focusEvents"),cM=kt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:r}=this;return[new It({key:uM,props:{handleDOMEvents:{focus:(e,t)=>{r.isFocused=!0;const n=r.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,t)=>{r.isFocused=!1;const n=r.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}}),fM=kt.create({name:"keymap",addKeyboardShortcuts(){const r=()=>this.editor.commands.first(({commands:a})=>[()=>a.undoInputRule(),()=>a.command(({tr:u})=>{const{selection:f,doc:d}=u,{empty:p,$anchor:m}=f,{pos:y,parent:v}=m,x=m.parent.isTextblock&&y>0?u.doc.resolve(y-1):m,b=x.parent.type.spec.isolating,S=m.pos-m.parentOffset,E=b&&x.parent.childCount===1?S===m.pos:he.atStart(d).from===y;return!p||!v.type.isTextblock||v.textContent.length||!E||E&&m.parent.type.name==="paragraph"?!1:a.clearNodes()}),()=>a.deleteSelection(),()=>a.joinBackward(),()=>a.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:a})=>[()=>a.deleteSelection(),()=>a.deleteCurrentNode(),()=>a.joinForward(),()=>a.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:a})=>[()=>a.newlineInCode(),()=>a.createParagraphNear(),()=>a.liftEmptyBlock(),()=>a.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:r,"Mod-Backspace":r,"Shift-Backspace":r,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},o={...n,"Ctrl-h":r,"Alt-Backspace":r,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return wu()||sm()?o:i},addProseMirrorPlugins(){return[new It({key:new yn("clearDocument"),appendTransaction:(r,e,t)=>{if(r.some(b=>b.getMeta("composition")))return;const n=r.some(b=>b.docChanged)&&!e.doc.eq(t.doc),i=r.some(b=>b.getMeta("preventClearDocument"));if(!n||i)return;const{empty:o,from:a,to:u}=e.selection,f=he.atStart(e.doc).from,d=he.atEnd(e.doc).to;if(o||!(a===f&&u===d)||!_u(t.doc))return;const y=t.tr,v=Io({state:t,transaction:y}),{commands:x}=new Ro({editor:this.editor,state:v});if(x.clearNodes(),!!y.steps.length)return y}})]}}),dM=kt.create({name:"paste",addProseMirrorPlugins(){return[new It({key:new yn("tiptapPaste"),props:{handlePaste:(r,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),hM=kt.create({name:"tabindex",addProseMirrorPlugins(){return[new It({key:new yn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class vr{get name(){return this.node.type.name}constructor(e,t,n=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new vr(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new vr(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new vr(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,n)=>{const i=t.isBlock&&!t.isTextblock,o=t.isAtom&&!t.isText,a=this.pos+n+(o?0:1),u=this.resolvedPos.doc.resolve(a);if(!i&&u.depth<=this.depth)return;const f=new vr(u,this.editor,i,i?t:null);i&&(f.actualDepth=this.depth+1),e.push(new vr(u,this.editor,i,i?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let n=null,i=this.parent;for(;i&&!n;){if(i.node.type.name===e)if(Object.keys(t).length>0){const o=i.node.attrs,a=Object.keys(t);for(let u=0;u<a.length;u+=1){const f=a[u];if(o[f]!==t[f])break}}else n=i;i=i.parent}return n}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},n=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(t);return this.children.forEach(a=>{n&&i.length>0||(a.node.type.name===e&&o.every(f=>t[f]===a.node.attrs[f])&&i.push(a),!(n&&i.length>0)&&(i=i.concat(a.querySelectorAll(e,t,n))))}),i}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}const pM=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function mM(r,e,t){const n=document.querySelector("style[data-tiptap-style]");if(n!==null)return n;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=r,document.getElementsByTagName("head")[0].appendChild(i),i}let gM=class extends TS{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:n,moved:i})=>this.options.onDrop(t,n,i)),this.on("paste",({event:t,slice:n})=>this.options.onPaste(t,n)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=mM(pM,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const n=Zp(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:n});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let n=t;if([].concat(e).forEach(o=>{const a=typeof o=="string"?`${o}$`:o.key;n=n.filter(u=>!u.key.startsWith(a))}),t.length===n.length)return;const i=this.state.reconfigure({plugins:n});return this.view.updateState(i),i}createExtensionManager(){var e,t;const i=[...this.options.enableCoreExtensions?[aM,WS.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),oM,cM,fM,hM,lM,dM].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new ei(i,this)}createCommandManager(){this.commandManager=new Ro({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=Ja(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(a){if(!(a instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(a.message))throw a;this.emit("contentError",{editor:this,error:a,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(u=>u.name!=="collaboration"),this.createExtensionManager()}}),t=Ja(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const n=rm(t,this.options.autofocus);this.view=new jk(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:Qr.create({doc:t,selection:n||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(a=>{var u;return(u=this.capturedTransaction)===null||u===void 0?void 0:u.step(a)});return}const t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),o=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return BC(this.state,e)}isActive(e,t){const n=typeof e=="string"?e:null,i=typeof e=="string"?t:e;return FC(this.state,n,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return yu(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:n={}}=e||{};return PC(this.state.doc,{blockSeparator:t,textSerializers:{...em(this.schema),...n}})}get isEmpty(){return _u(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var n;return((n=this.$doc)===null||n===void 0?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return((n=this.$doc)===null||n===void 0?void 0:n.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new vr(t,this)}get $doc(){return this.$pos(0)}};function ai(r){return new Lo({find:r.find,handler:({state:e,range:t,match:n})=>{const i=ye(r.getAttributes,void 0,n);if(i===!1||i===null)return null;const{tr:o}=e,a=n[n.length-1],u=n[0];if(a){const f=u.search(/\S/),d=t.from+u.indexOf(a),p=d+a.length;if(lm(t.from,t.to,e.doc).filter(v=>v.mark.type.excluded.find(b=>b===r.type&&b!==v.mark.type)).filter(v=>v.to>d).length)return null;p<t.to&&o.delete(p,t.to),d>t.from&&o.delete(t.from+f,d);const y=t.from+f+a.length;o.addMark(t.from+f,y,r.type.create(i||{})),o.removeStoredMark(r.type)}}})}function yM(r){return new Lo({find:r.find,handler:({state:e,range:t,match:n})=>{const i=ye(r.getAttributes,void 0,n)||{},{tr:o}=e,a=t.from;let u=t.to;const f=r.type.create(i);if(n[1]){const d=n[0].lastIndexOf(n[1]);let p=a+d;p>u?p=u:u=p+n[1].length;const m=n[0][n[0].length-1];o.insertText(m,a+n[0].length-1),o.replaceWith(p,u,f)}else if(n[0]){const d=r.type.isInline?a:a-1;o.insert(d,r.type.create(i)).delete(o.mapping.map(a),o.mapping.map(u))}o.scrollIntoView()}})}function Ga(r){return new Lo({find:r.find,handler:({state:e,range:t,match:n})=>{const i=e.doc.resolve(t.from),o=ye(r.getAttributes,void 0,n)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),r.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,r.type,o)}})}function ji(r){return new Lo({find:r.find,handler:({state:e,range:t,match:n,chain:i})=>{const o=ye(r.getAttributes,void 0,n)||{},a=e.tr.delete(t.from,t.to),f=a.doc.resolve(t.from).blockRange(),d=f&&tu(f,r.type,o);if(!d)return null;if(a.wrap(f,d),r.keepMarks&&r.editor){const{selection:m,storedMarks:y}=e,{splittableMarks:v}=r.editor.extensionManager,x=y||m.$to.parentOffset&&m.$from.marks();if(x){const b=x.filter(S=>v.includes(S.type.name));a.ensureMarks(b)}}if(r.keepAttributes){const m=r.type.name==="bulletList"||r.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(m,o).run()}const p=a.doc.resolve(t.from-1).nodeBefore;p&&p.type===r.type&&rr(a.doc,t.from-1)&&(!r.joinPredicate||r.joinPredicate(n,p))&&a.join(t.from-1)}})}class Nt{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ye(X(this,"addOptions",{name:this.name}))),this.storage=ye(X(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Nt(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Bo(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Nt(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=ye(X(t,"addOptions",{name:t.name})),t.storage=ye(X(t,"addStorage",{name:t.name,options:t.options})),t}}function ui(r){return new LS({find:r.find,handler:({state:e,range:t,match:n,pasteEvent:i})=>{const o=ye(r.getAttributes,void 0,n,i);if(o===!1||o===null)return null;const{tr:a}=e,u=n[n.length-1],f=n[0];let d=t.to;if(u){const p=f.search(/\S/),m=t.from+f.indexOf(u),y=m+u.length;if(lm(t.from,t.to,e.doc).filter(x=>x.mark.type.excluded.find(S=>S===r.type&&S!==x.mark.type)).filter(x=>x.to>m).length)return null;y<t.to&&a.delete(y,t.to),m>t.from&&a.delete(t.from+p,m),d=t.from+p+u.length,a.addMark(t.from+p,d,r.type.create(o||{})),a.removeStoredMark(r.type)}}})}function ch(r){return Zw((e,t)=>({get(){return e(),r},set(n){r=n,requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}}))}class vM extends gM{constructor(e={}){return super(e),this.contentComponent=null,this.appContext=null,this.reactiveState=ch(this.view.state),this.reactiveExtensionStorage=ch(this.extensionStorage),this.on("beforeTransaction",({nextState:t})=>{this.reactiveState.value=t,this.reactiveExtensionStorage.value=this.extensionStorage}),Yw(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(e,t){const n=super.registerPlugin(e,t);return this.reactiveState&&(this.reactiveState.value=n),n}unregisterPlugin(e){const t=super.unregisterPlugin(e);return this.reactiveState&&t&&(this.reactiveState.value=t),t}}const bM=ci({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(r){const e=Pe(),t=ex();return Xw(()=>{const n=r.editor;n&&n.options.element&&e.value&&Qw(()=>{if(!e.value||!n.options.element.firstChild)return;const i=Et(e.value);e.value.append(...n.options.element.childNodes),n.contentComponent=t.ctx._,t&&(n.appContext={...t.appContext,provides:t.provides}),n.setOptions({element:i}),n.createNodeViews()})}),yh(()=>{const n=r.editor;n&&(n.contentComponent=null,n.appContext=null)}),{rootEl:e}},render(){return jw("div",{ref:r=>{this.rootEl=r}})}}),wM=/^\s*>\s$/,xM=Nt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:r}){return["blockquote",_t(this.options.HTMLAttributes,r),0]},addCommands(){return{setBlockquote:()=>({commands:r})=>r.wrapIn(this.name),toggleBlockquote:()=>({commands:r})=>r.toggleWrap(this.name),unsetBlockquote:()=>({commands:r})=>r.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[ji({find:wM,type:this.type})]}}),_M=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,kM=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,SM=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,CM=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,MM=nr.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:r=>r.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:r=>r.type.name===this.name},{style:"font-weight",getAttrs:r=>/^(bold(er)?|[5-9]\d{2,})$/.test(r)&&null}]},renderHTML({HTMLAttributes:r}){return["strong",_t(this.options.HTMLAttributes,r),0]},addCommands(){return{setBold:()=>({commands:r})=>r.setMark(this.name),toggleBold:()=>({commands:r})=>r.toggleMark(this.name),unsetBold:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[ai({find:_M,type:this.type}),ai({find:SM,type:this.type})]},addPasteRules(){return[ui({find:kM,type:this.type}),ui({find:CM,type:this.type})]}}),TM="listItem",fh="textStyle",dh=/^\s*([-+*])\s$/,OM=Nt.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:r}){return["ul",_t(this.options.HTMLAttributes,r),0]},addCommands(){return{toggleBulletList:()=>({commands:r,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(TM,this.editor.getAttributes(fh)).run():r.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let r=ji({find:dh,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(r=ji({find:dh,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(fh),editor:this.editor})),[r]}}),AM=/(^|[^`])`([^`]+)`(?!`)/,EM=/(^|[^`])`([^`]+)`(?!`)/g,DM=nr.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:r}){return["code",_t(this.options.HTMLAttributes,r),0]},addCommands(){return{setCode:()=>({commands:r})=>r.setMark(this.name),toggleCode:()=>({commands:r})=>r.toggleMark(this.name),unsetCode:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[ai({find:AM,type:this.type})]},addPasteRules(){return[ui({find:EM,type:this.type})]}}),NM=/^```([a-z]+)?[\s\n]$/,IM=/^~~~([a-z]+)?[\s\n]$/,RM=Nt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:r=>{var e;const{languageClassPrefix:t}=this.options,o=[...((e=r.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(a=>a.startsWith(t)).map(a=>a.replace(t,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:r,HTMLAttributes:e}){return["pre",_t(this.options.HTMLAttributes,e),["code",{class:r.attrs.language?this.options.languageClassPrefix+r.attrs.language:null},0]]},addCommands(){return{setCodeBlock:r=>({commands:e})=>e.setNode(this.name,r),toggleCodeBlock:r=>({commands:e})=>e.toggleNode(this.name,"paragraph",r)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:r,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!r||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:r})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=r,{selection:t}=e,{$from:n,empty:i}=t;if(!i||n.parent.type!==this.type)return!1;const o=n.parentOffset===n.parent.nodeSize-2,a=n.parent.textContent.endsWith(`

`);return!o||!a?!1:r.chain().command(({tr:u})=>(u.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:r})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=r,{selection:t,doc:n}=e,{$from:i,empty:o}=t;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const u=i.after();return u===void 0?!1:n.nodeAt(u)?r.commands.command(({tr:d})=>(d.setSelection(he.near(n.resolve(u))),!0)):r.commands.exitCode()}}},addInputRules(){return[Ga({find:NM,type:this.type,getAttributes:r=>({language:r[1]})}),Ga({find:IM,type:this.type,getAttributes:r=>({language:r[1]})})]},addProseMirrorPlugins(){return[new It({key:new yn("codeBlockVSCodeHandler"),props:{handlePaste:(r,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),n=e.clipboardData.getData("vscode-editor-data"),i=n?JSON.parse(n):void 0,o=i==null?void 0:i.mode;if(!t||!o)return!1;const{tr:a,schema:u}=r.state,f=u.text(t.replace(/\r\n?/g,`
`));return a.replaceSelectionWith(this.type.create({language:o},f)),a.selection.$from.parent.type!==this.type&&a.setSelection(ae.near(a.doc.resolve(Math.max(0,a.selection.from-2)))),a.setMeta("paste",!0),r.dispatch(a),!0}}})]}}),PM=Nt.create({name:"doc",topNode:!0,content:"block+"});function LM(r={}){return new It({view(e){return new BM(e,r)}})}class BM{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=t.width)!==null&&n!==void 0?n:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=a=>{this[i](a)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,n,i=this.editorView.dom,o=i.getBoundingClientRect(),a=o.width/i.offsetWidth,u=o.height/i.offsetHeight;if(t){let m=e.nodeBefore,y=e.nodeAfter;if(m||y){let v=this.editorView.nodeDOM(this.cursorPos-(m?m.nodeSize:0));if(v){let x=v.getBoundingClientRect(),b=m?x.bottom:x.top;m&&y&&(b=(b+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let S=this.width/2*u;n={left:x.left,right:x.right,top:b-S,bottom:b+S}}}}if(!n){let m=this.editorView.coordsAtPos(this.cursorPos),y=this.width/2*a;n={left:m.left-y,right:m.left+y,top:m.top,bottom:m.bottom}}let f=this.editorView.dom.offsetParent;this.element||(this.element=f.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let d,p;if(!f||f==document.body&&getComputedStyle(f).position=="static")d=-pageXOffset,p=-pageYOffset;else{let m=f.getBoundingClientRect(),y=m.width/f.offsetWidth,v=m.height/f.offsetHeight;d=m.left-f.scrollLeft*y,p=m.top-f.scrollTop*v}this.element.style.left=(n.left-d)/a+"px",this.element.style.top=(n.top-p)/u+"px",this.element.style.width=(n.right-n.left)/a+"px",this.element.style.height=(n.bottom-n.top)/u+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=n&&n.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,t,e):i;if(t&&!o){let a=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let u=Zh(this.editorView.state.doc,a,this.editorView.dragging.slice);u!=null&&(a=u)}this.setCursor(a),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const FM=kt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[LM(this.options)]}});class ze extends he{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return ze.valid(n)?new ze(n):he.near(n)}content(){return U.empty}eq(e){return e instanceof ze&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new ze(e.resolve(t.pos))}getBookmark(){return new ku(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!$M(e)||!VM(e))return!1;let n=t.type.spec.allowGapCursor;if(n!=null)return n;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,n=!1){e:for(;;){if(!n&&ze.valid(e))return e;let i=e.pos,o=null;for(let a=e.depth;;a--){let u=e.node(a);if(t>0?e.indexAfter(a)<u.childCount:e.index(a)>0){o=u.child(t>0?e.indexAfter(a):e.index(a)-1);break}else if(a==0)return null;i+=t;let f=e.doc.resolve(i);if(ze.valid(f))return f}for(;;){let a=t>0?o.firstChild:o.lastChild;if(!a){if(o.isAtom&&!o.isText&&!re.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*t),n=!1;continue e}break}o=a,i+=t;let u=e.doc.resolve(i);if(ze.valid(u))return u}return null}}}ze.prototype.visible=!1;ze.findFrom=ze.findGapCursorFrom;he.jsonID("gapcursor",ze);class ku{constructor(e){this.pos=e}map(e){return new ku(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return ze.valid(t)?new ze(t):he.near(t)}}function $M(r){for(let e=r.depth;e>=0;e--){let t=r.index(e),n=r.node(e);if(t==0){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function VM(r){for(let e=r.depth;e>=0;e--){let t=r.indexAfter(e),n=r.node(e);if(t==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function zM(){return new It({props:{decorations:UM,createSelectionBetween(r,e,t){return e.pos==t.pos&&ze.valid(t)?new ze(t):null},handleClick:qM,handleKeyDown:WM,handleDOMEvents:{beforeinput:HM}}})}const WM=Fp({ArrowLeft:to("horiz",-1),ArrowRight:to("horiz",1),ArrowUp:to("vert",-1),ArrowDown:to("vert",1)});function to(r,e){const t=r=="vert"?e>0?"down":"up":e>0?"right":"left";return function(n,i,o){let a=n.selection,u=e>0?a.$to:a.$from,f=a.empty;if(a instanceof ae){if(!o.endOfTextblock(t)||u.depth==0)return!1;f=!1,u=n.doc.resolve(e>0?u.after():u.before())}let d=ze.findGapCursorFrom(u,e,f);return d?(i&&i(n.tr.setSelection(new ze(d))),!0):!1}}function qM(r,e,t){if(!r||!r.editable)return!1;let n=r.state.doc.resolve(e);if(!ze.valid(n))return!1;let i=r.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&re.isSelectable(r.state.doc.nodeAt(i.inside))?!1:(r.dispatch(r.state.tr.setSelection(new ze(n))),!0)}function HM(r,e){if(e.inputType!="insertCompositionText"||!(r.state.selection instanceof ze))return!1;let{$from:t}=r.state.selection,n=t.parent.contentMatchAt(t.index()).findWrapping(r.state.schema.nodes.text);if(!n)return!1;let i=$.empty;for(let a=n.length-1;a>=0;a--)i=$.from(n[a].createAndFill(null,i));let o=r.state.tr.replace(t.pos,t.pos,new U(i,0,0));return o.setSelection(ae.near(o.doc.resolve(t.pos+1))),r.dispatch(o),!1}function UM(r){if(!(r.selection instanceof ze))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Ye.create(r.doc,[Qt.widget(r.selection.head,e,{key:"gapcursor"})])}const JM=kt.create({name:"gapCursor",addProseMirrorPlugins(){return[zM()]},extendNodeSchema(r){var e;const t={name:r.name,options:r.options,storage:r.storage};return{allowGapCursor:(e=ye(X(r,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),KM=Nt.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:r}){return["br",_t(this.options.HTMLAttributes,r)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:r,chain:e,state:t,editor:n})=>r.first([()=>r.exitCode(),()=>r.command(()=>{const{selection:i,storedMarks:o}=t;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:a}=this.options,{splittableMarks:u}=n.extensionManager,f=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:d,dispatch:p})=>{if(p&&f&&a){const m=f.filter(y=>u.includes(y.type.name));d.ensureMarks(m)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),GM=Nt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(r=>({tag:`h${r}`,attrs:{level:r}}))},renderHTML({node:r,HTMLAttributes:e}){return[`h${this.options.levels.includes(r.attrs.level)?r.attrs.level:this.options.levels[0]}`,_t(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:r=>({commands:e})=>this.options.levels.includes(r.level)?e.setNode(this.name,r):!1,toggleHeading:r=>({commands:e})=>this.options.levels.includes(r.level)?e.toggleNode(this.name,"paragraph",r):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((r,e)=>({...r,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(r=>Ga({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${r}})\\s$`),type:this.type,getAttributes:{level:r}}))}});var xo=200,Qe=function(){};Qe.prototype.append=function(e){return e.length?(e=Qe.from(e),!this.length&&e||e.length<xo&&this.leafAppend(e)||this.length<xo&&e.leafPrepend(this)||this.appendInner(e)):this};Qe.prototype.prepend=function(e){return e.length?Qe.from(e).append(this):this};Qe.prototype.appendInner=function(e){return new YM(this,e)};Qe.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Qe.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Qe.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Qe.prototype.forEach=function(e,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)};Qe.prototype.map=function(e,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length);var i=[];return this.forEach(function(o,a){return i.push(e(o,a))},t,n),i};Qe.from=function(e){return e instanceof Qe?e:e&&e.length?new am(e):Qe.empty};var am=function(r){function e(n){r.call(this),this.values=n}r&&(e.__proto__=r),e.prototype=Object.create(r&&r.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,a,u){for(var f=o;f<a;f++)if(i(this.values[f],u+f)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,a,u){for(var f=o-1;f>=a;f--)if(i(this.values[f],u+f)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=xo)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=xo)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(Qe);Qe.empty=new am([]);var YM=function(r){function e(t,n){r.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return r&&(e.__proto__=r),e.prototype=Object.create(r&&r.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,i,o,a){var u=this.left.length;if(i<u&&this.left.forEachInner(n,i,Math.min(o,u),a)===!1||o>u&&this.right.forEachInner(n,Math.max(i-u,0),Math.min(this.length,o)-u,a+u)===!1)return!1},e.prototype.forEachInvertedInner=function(n,i,o,a){var u=this.left.length;if(i>u&&this.right.forEachInvertedInner(n,i-u,Math.max(o,u)-u,a+u)===!1||o<u&&this.left.forEachInvertedInner(n,Math.min(i,u),o,a)===!1)return!1},e.prototype.sliceInner=function(n,i){if(n==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(n,i):n>=o?this.right.slice(n-o,i-o):this.left.slice(n,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(n){var i=this.right.leafAppend(n);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(n){var i=this.left.leafPrepend(n);if(i)return new e(i,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e}(Qe);const jM=500;class ln{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let i,o;t&&(i=this.remapping(n,this.items.length),o=i.maps.length);let a=e.tr,u,f,d=[],p=[];return this.items.forEach((m,y)=>{if(!m.step){i||(i=this.remapping(n,y+1),o=i.maps.length),o--,p.push(m);return}if(i){p.push(new hn(m.map));let v=m.step.map(i.slice(o)),x;v&&a.maybeStep(v).doc&&(x=a.mapping.maps[a.mapping.maps.length-1],d.push(new hn(x,void 0,void 0,d.length+p.length))),o--,x&&i.appendMap(x,o)}else a.maybeStep(m.step);if(m.selection)return u=i?m.selection.map(i.slice(o)):m.selection,f=new ln(this.items.slice(0,n).append(p.reverse().concat(d)),this.eventCount-1),!1},this.items.length,0),{remaining:f,transform:a,selection:u}}addTransform(e,t,n,i){let o=[],a=this.eventCount,u=this.items,f=!i&&u.length?u.get(u.length-1):null;for(let p=0;p<e.steps.length;p++){let m=e.steps[p].invert(e.docs[p]),y=new hn(e.mapping.maps[p],m,t),v;(v=f&&f.merge(y))&&(y=v,p?o.pop():u=u.slice(0,u.length-1)),o.push(y),t&&(a++,t=void 0),i||(f=y)}let d=a-n.depth;return d>ZM&&(u=XM(u,d),a-=d),new ln(u.append(o),a)}remapping(e,t){let n=new Hi;return this.items.forEach((i,o)=>{let a=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?n.maps.length-i.mirrorOffset:void 0;n.appendMap(i.map,a)},e,t),n}addMaps(e){return this.eventCount==0?this:new ln(this.items.append(e.map(t=>new hn(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-t),o=e.mapping,a=e.steps.length,u=this.eventCount;this.items.forEach(y=>{y.selection&&u--},i);let f=t;this.items.forEach(y=>{let v=o.getMirror(--f);if(v==null)return;a=Math.min(a,v);let x=o.maps[v];if(y.step){let b=e.steps[v].invert(e.docs[v]),S=y.selection&&y.selection.map(o.slice(f+1,v));S&&u++,n.push(new hn(x,b,S))}else n.push(new hn(x))},i);let d=[];for(let y=t;y<a;y++)d.push(new hn(o.maps[y]));let p=this.items.slice(0,i).append(d).append(n),m=new ln(p,u);return m.emptyItemCount()>jM&&(m=m.compress(this.items.length-n.length)),m}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,i=[],o=0;return this.items.forEach((a,u)=>{if(u>=e)i.push(a),a.selection&&o++;else if(a.step){let f=a.step.map(t.slice(n)),d=f&&f.getMap();if(n--,d&&t.appendMap(d,n),f){let p=a.selection&&a.selection.map(t.slice(n));p&&o++;let m=new hn(d.invert(),f,p),y,v=i.length-1;(y=i.length&&i[v].merge(m))?i[v]=y:i.push(m)}}else a.map&&n--},this.items.length,0),new ln(Qe.from(i.reverse()),o)}}ln.empty=new ln(Qe.empty,0);function XM(r,e){let t;return r.forEach((n,i)=>{if(n.selection&&e--==0)return t=i,!1}),r.slice(t)}class hn{constructor(e,t,n,i){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new hn(t.getMap().invert(),t,this.selection)}}}class Un{constructor(e,t,n,i,o){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=i,this.prevComposition=o}}const ZM=20;function QM(r,e,t,n){let i=t.getMeta(Tr),o;if(i)return i.historyState;t.getMeta(nT)&&(r=new Un(r.done,r.undone,null,0,-1));let a=t.getMeta("appendedTransaction");if(t.steps.length==0)return r;if(a&&a.getMeta(Tr))return a.getMeta(Tr).redo?new Un(r.done.addTransform(t,void 0,n,oo(e)),r.undone,hh(t.mapping.maps),r.prevTime,r.prevComposition):new Un(r.done,r.undone.addTransform(t,void 0,n,oo(e)),null,r.prevTime,r.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(a&&a.getMeta("addToHistory")===!1)){let u=t.getMeta("composition"),f=r.prevTime==0||!a&&r.prevComposition!=u&&(r.prevTime<(t.time||0)-n.newGroupDelay||!eT(t,r.prevRanges)),d=a?Ca(r.prevRanges,t.mapping):hh(t.mapping.maps);return new Un(r.done.addTransform(t,f?e.selection.getBookmark():void 0,n,oo(e)),ln.empty,d,t.time,u??r.prevComposition)}else return(o=t.getMeta("rebased"))?new Un(r.done.rebased(t,o),r.undone.rebased(t,o),Ca(r.prevRanges,t.mapping),r.prevTime,r.prevComposition):new Un(r.done.addMaps(t.mapping.maps),r.undone.addMaps(t.mapping.maps),Ca(r.prevRanges,t.mapping),r.prevTime,r.prevComposition)}function eT(r,e){if(!e)return!1;if(!r.docChanged)return!0;let t=!1;return r.mapping.maps[0].forEach((n,i)=>{for(let o=0;o<e.length;o+=2)n<=e[o+1]&&i>=e[o]&&(t=!0)}),t}function hh(r){let e=[];for(let t=r.length-1;t>=0&&e.length==0;t--)r[t].forEach((n,i,o,a)=>e.push(o,a));return e}function Ca(r,e){if(!r)return null;let t=[];for(let n=0;n<r.length;n+=2){let i=e.map(r[n],1),o=e.map(r[n+1],-1);i<=o&&t.push(i,o)}return t}function tT(r,e,t){let n=oo(e),i=Tr.get(e).spec.config,o=(t?r.undone:r.done).popEvent(e,n);if(!o)return null;let a=o.selection.resolve(o.transform.doc),u=(t?r.done:r.undone).addTransform(o.transform,e.selection.getBookmark(),i,n),f=new Un(t?u:o.remaining,t?o.remaining:u,null,0,-1);return o.transform.setSelection(a).setMeta(Tr,{redo:t,historyState:f})}let Ma=!1,ph=null;function oo(r){let e=r.plugins;if(ph!=e){Ma=!1,ph=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Ma=!0;break}}return Ma}const Tr=new yn("history"),nT=new yn("closeHistory");function rT(r={}){return r={depth:r.depth||100,newGroupDelay:r.newGroupDelay||500},new It({key:Tr,state:{init(){return new Un(ln.empty,ln.empty,null,0,-1)},apply(e,t,n){return QM(t,n,e,r)}},config:r,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,i=n=="historyUndo"?cm:n=="historyRedo"?fm:null;return i?(t.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function um(r,e){return(t,n)=>{let i=Tr.getState(t);if(!i||(r?i.undone:i.done).eventCount==0)return!1;if(n){let o=tT(i,t,r);o&&n(e?o.scrollIntoView():o)}return!0}}const cm=um(!1,!0),fm=um(!0,!0),iT=kt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:r,dispatch:e})=>cm(r,e),redo:()=>({state:r,dispatch:e})=>fm(r,e)}},addProseMirrorPlugins(){return[rT(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),sT=Nt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:r}){return["hr",_t(this.options.HTMLAttributes,r)]},addCommands(){return{setHorizontalRule:()=>({chain:r,state:e})=>{const{selection:t}=e,{$from:n,$to:i}=t,o=r();return n.parentOffset===0?o.insertContentAt({from:Math.max(n.pos-1,0),to:i.pos},{type:this.name}):$C(t)?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:a,dispatch:u})=>{var f;if(u){const{$to:d}=a.selection,p=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?a.setSelection(ae.create(a.doc,d.pos+1)):d.nodeAfter.isBlock?a.setSelection(re.create(a.doc,d.pos)):a.setSelection(ae.create(a.doc,d.pos));else{const m=(f=d.parent.type.contentMatch.defaultType)===null||f===void 0?void 0:f.create();m&&(a.insert(p,m),a.setSelection(ae.create(a.doc,p+1)))}a.scrollIntoView()}return!0}).run()}}},addInputRules(){return[yM({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),oT=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,lT=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,aT=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,uT=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,cT=nr.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:r=>r.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:r=>r.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:r}){return["em",_t(this.options.HTMLAttributes,r),0]},addCommands(){return{setItalic:()=>({commands:r})=>r.setMark(this.name),toggleItalic:()=>({commands:r})=>r.toggleMark(this.name),unsetItalic:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[ai({find:oT,type:this.type}),ai({find:aT,type:this.type})]},addPasteRules(){return[ui({find:lT,type:this.type}),ui({find:uT,type:this.type})]}}),fT=Nt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:r}){return["li",_t(this.options.HTMLAttributes,r),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),dT="listItem",mh="textStyle",gh=/^(\d+)\.\s$/,hT=Nt.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:r=>r.hasAttribute("start")?parseInt(r.getAttribute("start")||"",10):1},type:{default:null,parseHTML:r=>r.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:r}){const{start:e,...t}=r;return e===1?["ol",_t(this.options.HTMLAttributes,t),0]:["ol",_t(this.options.HTMLAttributes,r),0]},addCommands(){return{toggleOrderedList:()=>({commands:r,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(dT,this.editor.getAttributes(mh)).run():r.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let r=ji({find:gh,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(r=ji({find:gh,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(mh)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[r]}}),pT=Nt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:r}){return["p",_t(this.options.HTMLAttributes,r),0]},addCommands(){return{setParagraph:()=>({commands:r})=>r.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),mT=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,gT=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,yT=nr.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:r=>r.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:r}){return["s",_t(this.options.HTMLAttributes,r),0]},addCommands(){return{setStrike:()=>({commands:r})=>r.setMark(this.name),toggleStrike:()=>({commands:r})=>r.toggleMark(this.name),unsetStrike:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[ai({find:mT,type:this.type})]},addPasteRules(){return[ui({find:gT,type:this.type})]}}),vT=Nt.create({name:"text",group:"inline"}),bT=kt.create({name:"starterKit",addExtensions(){const r=[];return this.options.bold!==!1&&r.push(MM.configure(this.options.bold)),this.options.blockquote!==!1&&r.push(xM.configure(this.options.blockquote)),this.options.bulletList!==!1&&r.push(OM.configure(this.options.bulletList)),this.options.code!==!1&&r.push(DM.configure(this.options.code)),this.options.codeBlock!==!1&&r.push(RM.configure(this.options.codeBlock)),this.options.document!==!1&&r.push(PM.configure(this.options.document)),this.options.dropcursor!==!1&&r.push(FM.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&r.push(JM.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&r.push(KM.configure(this.options.hardBreak)),this.options.heading!==!1&&r.push(GM.configure(this.options.heading)),this.options.history!==!1&&r.push(iT.configure(this.options.history)),this.options.horizontalRule!==!1&&r.push(sT.configure(this.options.horizontalRule)),this.options.italic!==!1&&r.push(cT.configure(this.options.italic)),this.options.listItem!==!1&&r.push(fT.configure(this.options.listItem)),this.options.orderedList!==!1&&r.push(hT.configure(this.options.orderedList)),this.options.paragraph!==!1&&r.push(pT.configure(this.options.paragraph)),this.options.strike!==!1&&r.push(yT.configure(this.options.strike)),this.options.text!==!1&&r.push(vT.configure(this.options.text)),r}}),tt=r=>(vh("data-v-ffecf0dd"),r=r(),bh(),r),wT={id:"step-1",role:"tabpanel",class:"bs-stepper-pane","aria-labelledby":"steppertrigger1"},xT=tt(()=>D("option",{value:""},"Select category",-1)),_T=tt(()=>D("option",{value:"engineer"},"Engineer",-1)),kT=tt(()=>D("option",{value:"medical"},"Medical",-1)),ST=tt(()=>D("option",{value:"it"},"Information technology",-1)),CT=tt(()=>D("option",{value:"finance"},"Finance",-1)),MT=tt(()=>D("option",{value:"marketing"},"Marketing",-1)),TT=tt(()=>D("option",{value:""},"Select course level",-1)),OT=tt(()=>D("option",{value:"all"},"All level",-1)),AT=tt(()=>D("option",{value:"beginner"},"Beginner",-1)),ET=tt(()=>D("option",{value:"intermediate"},"Intermediate",-1)),DT=tt(()=>D("option",{value:"advance"},"Advance",-1)),NT=tt(()=>D("option",{value:""},"Select language",-1)),IT=tt(()=>D("option",{value:"English"},"English",-1)),RT=tt(()=>D("option",{value:"German"},"German",-1)),PT=tt(()=>D("option",{value:"French"},"French",-1)),LT=tt(()=>D("option",{value:"Hindi"},"Hindi",-1)),BT={class:"form-check form-switch form-check-md"},FT=tt(()=>D("label",{class:"form-check-label",for:"checkPrivacy1"},"Check this for featured course",-1)),$T={class:"form-check small mb-0"},VT=tt(()=>D("label",{class:"form-check-label",for:"checkBox1"},"Enable this Discount",-1)),zT={class:"bg-body border rounded-bottom h-400px overflow-hidden",id:"editor"},WT={class:"d-flex justify-content-end mt-3"},qT=ci({__name:"Step1",props:{formData:{},errors:{},nextPage:{type:Function},saveDraft:{type:Function}},setup(r){const e=r,t=Pe(null);return t.value=new vM({content:e.formData.description,extensions:[bT],onUpdate:({editor:n})=>{e.formData.description=n.getHTML()}}),yh(()=>{t.value&&t.value.destroy()}),(n,i)=>{const o=ko,a=Ya,u=Xi,f=ja,d=Qi,p=So,m=Zi;return Te(),Le("div",wT,[A(u,{label:"Course title",class:"mb-3"},{default:P(()=>[A(o,{modelValue:n.formData.title,"onUpdate:modelValue":i[0]||(i[0]=y=>n.formData.title=y),placeholder:"Enter course title",state:n.errors.title?!1:null},null,8,["modelValue","state"]),A(a,null,{default:P(()=>[Se(Be(n.errors.title),1)]),_:1})]),_:1}),A(u,{label:"Short description",class:"mb-3"},{default:P(()=>[A(f,{modelValue:n.formData.short_description,"onUpdate:modelValue":i[1]||(i[1]=y=>n.formData.short_description=y),placeholder:"Enter keywords",rows:"2","max-rows":"6",state:n.errors.short_description?!1:null},null,8,["modelValue","state"]),A(a,null,{default:P(()=>[Se(Be(n.errors.short_description),1)]),_:1})]),_:1}),A(m,{class:"g-4"},{default:P(()=>[A(d,{md:"6"},{default:P(()=>[A(u,{label:"Course category"},{default:P(()=>[A(oa,{id:"select-cate",class:"border-0 z-index-9 bg-transparent","data-search-enabled":"true",modelValue:n.formData.category,"onUpdate:modelValue":i[2]||(i[2]=y=>n.formData.category=y)},{default:P(()=>[xT,_T,kT,ST,CT,MT]),_:1},8,["modelValue"])]),_:1})]),_:1}),A(d,{md:"6"},{default:P(()=>[A(u,{label:"Course level"},{default:P(()=>[A(oa,{id:"select-level",class:"border-0 z-index-9 bg-transparent","data-search-enabled":"false","data-remove-item-button":"true",modelValue:n.formData.level,"onUpdate:modelValue":i[3]||(i[3]=y=>n.formData.level=y)},{default:P(()=>[TT,OT,AT,ET,DT]),_:1},8,["modelValue"])]),_:1})]),_:1}),A(d,{md:"6"},{default:P(()=>[A(u,{label:"Language"},{default:P(()=>[A(oa,{id:"select-language",class:"border-0 z-index-9 bg-transparent",multiple:"","data-max-item-count":"3","data-remove-item-button":"true",modelValue:n.formData.languages,"onUpdate:modelValue":i[4]||(i[4]=y=>n.formData.languages=y)},{default:P(()=>[NT,IT,RT,PT,LT]),_:1},8,["modelValue"])]),_:1})]),_:1}),A(d,{md:"6",class:"d-flex align-items-center justify-content-start mt-5"},{default:P(()=>[D("div",BT,[$i(D("input",{class:"form-check-input",type:"checkbox",id:"checkPrivacy1","onUpdate:modelValue":i[5]||(i[5]=y=>n.formData.is_featured=y)},null,512),[[Ta,n.formData.is_featured]]),FT])]),_:1}),A(d,{md:"6"},{default:P(()=>[A(u,{label:"Course time"},{default:P(()=>[A(o,{modelValue:n.formData.course_time,"onUpdate:modelValue":i[6]||(i[6]=y=>n.formData.course_time=y),type:"text",placeholder:"Enter course time",state:n.errors.course_time?!1:null},null,8,["modelValue","state"]),A(a,null,{default:P(()=>[Se(Be(n.errors.course_time),1)]),_:1})]),_:1})]),_:1}),A(d,{md:"6"},{default:P(()=>[A(u,{label:"Total lecture"},{default:P(()=>[A(o,{modelValue:n.formData.total_lecture,"onUpdate:modelValue":i[7]||(i[7]=y=>n.formData.total_lecture=y),type:"text",placeholder:"Enter total lecture",state:n.errors.total_lecture?!1:null},null,8,["modelValue","state"]),A(a,null,{default:P(()=>[Se(Be(n.errors.total_lecture),1)]),_:1})]),_:1})]),_:1}),A(d,{md:"6"},{default:P(()=>[A(u,{label:"Course price"},{default:P(()=>[A(o,{modelValue:n.formData.price,"onUpdate:modelValue":i[8]||(i[8]=y=>n.formData.price=y),modelModifiers:{number:!0},type:"number",step:"0.01",placeholder:"Enter course price",state:n.errors.price?!1:null},null,8,["modelValue","state"]),A(a,null,{default:P(()=>[Se(Be(n.errors.price),1)]),_:1})]),_:1})]),_:1}),A(d,{md:"6"},{default:P(()=>[A(u,{label:"Discount price"},{default:P(()=>[A(o,{modelValue:n.formData.discount_price,"onUpdate:modelValue":i[9]||(i[9]=y=>n.formData.discount_price=y),modelModifiers:{number:!0},type:"number",step:"0.01",placeholder:"Enter discount",state:n.errors.discount_price?!1:null},null,8,["modelValue","state"]),A(a,null,{default:P(()=>[Se(Be(n.errors.discount_price),1)]),_:1})]),_:1}),A(d,{cols:"12",class:"mt-1 mb-0"},{default:P(()=>[D("div",$T,[$i(D("input",{class:"form-check-input",type:"checkbox",id:"checkBox1","onUpdate:modelValue":i[10]||(i[10]=y=>n.formData.enable_discount=y)},null,512),[[Ta,n.formData.enable_discount]]),VT])]),_:1})]),_:1}),A(d,{cols:"12"},{default:P(()=>[A(u,{label:"Add description"},{default:P(()=>[D("div",zT,[A(Et(bM),{editor:t.value,class:"border-0",style:{"min-height":"400px"}},null,8,["editor"])])]),_:1})]),_:1}),D("div",WT,[A(p,{variant:"outline-primary",class:"mr-2",onClick:n.saveDraft},{default:P(()=>[Se("Save as Draft")]),_:1},8,["onClick"]),A(p,{variant:"primary",class:"next-btn mb-0",onClick:n.nextPage},{default:P(()=>[Se("Next")]),_:1},8,["onClick"])])]),_:1})])}}}),HT=_h(qT,[["__scopeId","data-v-ffecf0dd"]]),UT={id:"step-2",role:"tabpanel",class:"content fade","aria-labelledby":"steppertrigger2"},JT=D("h4",null,"Course media",-1),KT=D("hr",null,null,-1),GT={class:"text-center justify-content-center align-items-center p-4 p-sm-5 border border-2 border-dashed position-relative rounded-3"},YT=["src"],jT={class:"my-2"},XT=D("p",{class:"small mb-0 mt-2"},[D("b",null,"Note:"),Se(" Only JPG, JPEG, and PNG. Suggested dimensions are 1920px * 1080px. ")],-1),ZT={key:0,class:"mt-2"},QT={key:1,class:"text-danger mt-2"},eO={class:"d-sm-flex justify-content-end mt-2"},tO=D("h5",null,"Upload video",-1),nO=D("div",{class:"position-relative my-4"},[D("hr"),D("p",{class:"small position-absolute top-50 start-50 translate-middle bg-body px-3 mb-0"},"Or")],-1),rO={key:0,class:"text-danger"},iO=D("h5",{class:"mt-4"},"Video preview",-1),sO={class:"position-relative"},oO=["src"],lO={class:"position-absolute top-50 start-50 translate-middle"},aO={class:"d-flex justify-content-between mt-3"},uO=ci({__name:"Step2",props:{formData:{},nextPage:{type:Function},previousPage:{type:Function},errors:{},saveDraft:{type:Function}},emits:["update:cover"],setup(r,{emit:e}){const t=Co.useToast(),n=Pe(null),i=e,o=a=>{const u=a.target;if(u.files&&u.files.length>0){const f=u.files[0];if(!["image/jpeg","image/png","image/gif"].includes(f.type)){t.error("Please upload a valid image file (JPG, JPEG, PNG).");return}i("update:cover",f)}};return(a,u)=>{const f=So,d=Qi,p=ko,m=Ya,y=Xi,v=nx,x=rx,b=tx,S=Xa("font-awesome-icon"),E=Zi;return Te(),Le("div",UT,[JT,KT,A(E,null,{default:P(()=>[A(d,{cols:"12"},{default:P(()=>[D("div",GT,[D("img",{src:Et(vx),class:"h-50px",alt:""},null,8,YT),D("div",null,[D("h6",jT,[Se(" Upload course image here, or "),D("a",{href:"#!",class:"text-primary",onClick:u[0]||(u[0]=Z=>a.$refs.fileInput.click())},"Browse")]),D("input",{type:"file",ref_key:"fileInput",ref:n,style:{display:"none"},accept:"image/gif, image/jpeg, image/png",onChange:o},null,544),XT,a.formData.cover?(Te(),Le("div",ZT,[D("span",null,"Selected: "+Be(a.formData.cover.name),1)])):dt("",!0),a.errors.cover?(Te(),Le("div",QT,Be(a.errors.cover),1)):dt("",!0)])]),D("div",eO,[a.formData.cover?(Te(),ri(f,{key:0,type:"button",variant:"danger-soft",size:"sm",class:"mb-3",onClick:u[1]||(u[1]=Z=>i("update:cover",null))},{default:P(()=>[Se(" Remove image ")]),_:1})):dt("",!0)])]),_:1}),A(d,{cols:"12"},{default:P(()=>[tO,A(d,{cols:"12",class:"mt-4 mb-5"},{default:P(()=>[A(y,{label:"Video URL"},{default:P(()=>[A(p,{modelValue:a.formData.video_url,"onUpdate:modelValue":u[2]||(u[2]=Z=>a.formData.video_url=Z),type:"text",placeholder:"Enter video url",state:a.errors.video_url?!1:null},null,8,["modelValue","state"]),A(m,null,{default:P(()=>[Se(Be(a.errors.video_url),1)]),_:1})]),_:1})]),_:1}),nO,A(d,{cols:"12"},{default:P(()=>[A(y,{label:"Upload video file"},{default:P(()=>[A(b,{class:"mb-3"},{default:P(()=>[A(v,{modelValue:a.formData.video_file,"onUpdate:modelValue":u[3]||(u[3]=Z=>a.formData.video_file=Z),accept:".mp4,.webm,.ogg",placeholder:"Choose video file..."},null,8,["modelValue"]),A(x,null,{default:P(()=>[Se(".mp4, .webm, .ogg")]),_:1})]),_:1}),a.errors.video_file?(Te(),Le("div",rO,Be(a.errors.video_file),1)):dt("",!0)]),_:1})]),_:1}),iO,D("div",sO,[D("img",{src:Et(bx),class:"rounded-4",alt:""},null,8,oO),D("div",lO,[A(yx,{link:a.formData.video_url||"https://www.youtube.com/embed/tXHviS-4ygo",class:"btn btn-lg text-danger btn-round btn-white-shadow mb-0"},{default:P(()=>[A(S,{icon:Et(kh)},null,8,["icon"])]),_:1},8,["link"])])])]),_:1}),D("div",aO,[A(f,{variant:"secondary",class:"prev-btn mb-0",onClick:a.previousPage},{default:P(()=>[Se("Previous")]),_:1},8,["onClick"]),D("div",null,[A(f,{variant:"outline-primary",class:"mb-0 mr-2",onClick:a.saveDraft},{default:P(()=>[Se("Save as Draft")]),_:1},8,["onClick"]),A(f,{variant:"primary",class:"next-btn mb-0",onClick:a.nextPage},{default:P(()=>[Se("Next")]),_:1},8,["onClick"])])])]),_:1})])}}}),cO={id:"step-3",role:"tabpanel",class:"content fade","aria-labelledby":"steppertrigger3"},fO=D("h4",null,"Curriculum",-1),dO=D("hr",null,null,-1),hO={class:"d-sm-flex justify-content-sm-between align-items-center mb-3"},pO=D("h5",{class:"mb-2 mb-sm-0"},"Upload Module",-1),mO={class:"position-relative"},gO={href:"#",class:"btn btn-danger-soft btn-round btn-sm mb-0 stretched-link position-static"},yO={class:"ms-2 mb-0 h6 fw-light"},vO=["onClick"],bO={key:0},wO=["onClick"],xO={key:0,class:"text-muted mt-3"},_O={class:"d-flex justify-content-between mt-3"},kO=D("span",{class:"text-danger"},"*",-1),SO={key:0,class:"invalid-feedback"},CO={key:0,class:"invalid-feedback"},MO={key:0,class:"invalid-feedback"},TO={key:0,class:"invalid-feedback"},OO={class:"btn-group",role:"group","aria-label":"Basic radio toggle button group"},AO=D("label",{class:"btn btn-sm btn-light btn-primary-soft-check border-0 m-0",for:"option1"},"Free",-1),EO=D("label",{class:"btn btn-sm btn-light btn-primary-soft-check border-0 m-0",for:"option2"},"Premium",-1),DO=ci({__name:"Step3",props:{formData:{},nextPage:{type:Function},previousPage:{type:Function},errors:{},saveDraft:{type:Function},courseId:{}},emits:["update:formData"],setup(r,{emit:e}){const t=Co.useToast(),n=r,i=e,o=Pe(!1),a=Pe(!1),u=Pe(null),f=Pe(null),d=Pe(null),p=Pe(!1),m=Zr({title:"",order:0,description:""}),y=Zr({title:"",order:""}),v=Zr({moduleId:null,title:"",video_url:"",description:"",is_free:!0}),x=Zr({title:"",video_url:""}),b=()=>{u.value=null,f.value=null,m.title="",m.order=n.formData.modules.length+1,m.description="",y.title="",y.order="",o.value=!0},S=G=>{d.value=null,v.moduleId=G,v.title="",v.video_url="",v.description="",v.is_free=!0,x.title="",x.video_url="",a.value=!0},E=(G,ee)=>{d.value=G,v.moduleId=ee,v.title=G.title,v.video_url=G.video_url,v.description=G.description||"",v.is_free=G.is_free,x.title="",x.video_url="",a.value=!0},Z=async G=>{var ee;if(G.preventDefault(),!m.title){y.title="Module name is required",t.error("Please fill in all required fields");return}if(m.order<1){y.order="Order must be positive",t.error("Please fill in all required fields");return}try{p.value=!0;const j={title:m.title,order:m.order,description:m.description,videos:((ee=u.value)==null?void 0:ee.videos)||[]};u.value&&f.value!==null?n.formData.modules[f.value]=j:n.formData.modules.push(j),i("update:formData",n.formData),t.success(u.value?"Module updated successfully!":"Module added successfully!"),o.value=!1}catch(j){console.error("Error saving module:",j),t.error("Failed to save module")}finally{p.value=!1}},te=async G=>{var ee,j;if(G.preventDefault(),!v.title){x.title="Video name is required",t.error("Please fill in all required fields");return}if(!v.video_url){x.video_url="Video link is required",t.error("Please fill in all required fields");return}try{p.value=!0;const ke={id:(ee=d.value)==null?void 0:ee.id,tempId:((j=d.value)==null?void 0:j.tempId)||`temp-video-${Date.now()}`,title:v.title,video_url:v.video_url,description:v.description,is_free:v.is_free},He=n.formData.modules.find((nt,St)=>(nt.id||St)===v.moduleId);if(He)if(d.value){const nt=He.videos.findIndex(St=>St.id===d.value.id||St.tempId===d.value.tempId);He.videos[nt]=ke}else He.videos.push(ke);i("update:formData",n.formData),t.success(d.value?"Video updated successfully!":"Video added successfully!"),a.value=!1}catch(ke){console.error("Error saving video:",ke),t.error("Failed to save video")}finally{p.value=!1}},ve=(G,ee)=>{confirm("Are you sure you want to delete this video?")&&(ee.videos=ee.videos.filter(j=>j.id!==G.id&&j.tempId!==G.tempId),i("update:formData",n.formData),t.success("Video deleted successfully!"))},ue=()=>{o.value=!1,u.value=null,f.value=null,m.title="",m.order=0,m.description="",y.title="",y.order=""},K=()=>{a.value=!1,d.value=null,v.moduleId=null,v.title="",v.video_url="",v.description="",v.is_free=!0,x.title="",x.video_url=""};return n.formData.modules||(n.formData.modules=[]),(G,ee)=>{const j=Xa("font-awesome-icon"),ke=So,He=sx,nt=ix,St=Zi,Wt=ko,mt=Xi,W=Qi,ne=ja,J=Za,xe=wh;return Te(),Le("div",cO,[fO,dO,A(St,null,{default:P(()=>[D("div",hO,[pO,D("a",{href:"#",class:"btn btn-sm btn-primary-soft mb-0",onClick:b},[A(Et(Oa),{class:"me-2"}),Se(" Add Module ")])]),A(nt,{class:"accordion-icon accordion-bg-light",id:"accordionExample2"},{default:P(()=>[(Te(!0),Le(Vi,null,zi(G.formData.modules,(F,V)=>(Te(),ri(He,{key:`module-${F.id||V}`,title:F.title||`Module ${V+1}`,"button-class":"fw-bold rounded d-inline-block d-block pe-5","header-tag":"h6","body-class":"mt-3","header-class":"font-base",class:"mb-3"},{default:P(()=>[(Te(!0),Le(Vi,null,zi(F.videos,ie=>(Te(),Le("div",{key:ie.id||ie.tempId,class:"d-flex justify-content-between align-items-center"},[D("div",mO,[D("a",gO,[A(j,{icon:Et(kh)},null,8,["icon"])]),D("span",yO,Be(ie.title),1)]),D("div",null,[D("a",{href:"#",class:"btn btn-sm btn-success-soft btn-round me-1 mb-1 mb-md-0",onClick:L=>E(ie,F.id||V)},[A(j,{icon:Et(Sh),class:"fa-fw"},null,8,["icon"])],8,vO),A(ke,{variant:"danger-soft",size:"sm",class:"btn-round mb-0",onClick:L=>ve(ie,F)},{default:P(()=>[A(j,{icon:Et(Ch),class:"fa-fw"},null,8,["icon"])]),_:2},1032,["onClick"])])]))),128)),F.videos.length?(Te(),Le("hr",bO)):dt("",!0),D("a",{href:"#",class:"btn btn-sm btn-dark mb-0",onClick:ie=>S(F.id||V)},[A(Et(Oa),{class:"me-2"}),Se(" Add Video ")],8,wO)]),_:2},1032,["title"]))),128))]),_:1}),G.formData.modules.length?dt("",!0):(Te(),Le("p",xO,"No modules added yet.")),D("div",_O,[A(ke,{variant:"secondary",class:"prev-btn mb-0",onClick:G.previousPage},{default:P(()=>[Se("Previous")]),_:1},8,["onClick"]),D("div",null,[A(ke,{variant:"outline-primary",class:"mb-0 mr-2",onClick:G.saveDraft},{default:P(()=>[Se("Save as Draft")]),_:1},8,["onClick"]),A(ke,{variant:"primary",class:"next-btn mb-0",onClick:G.nextPage},{default:P(()=>[Se("Next")]),_:1},8,["onClick"])])])]),_:1}),A(xe,{id:"addModule",title:u.value?"Edit Module":"Add Module","header-class":"bg-dark","title-class":"text-white","ok-title":p.value?"Saving...":"Save Module","ok-variant":"success","cancel-title":"Close","cancel-variant":"danger-soft","ok-disabled":p.value,modelValue:o.value,"onUpdate:modelValue":ee[3]||(ee[3]=F=>o.value=F),onOk:Z,onHidden:ue},{default:P(()=>[A(J,{class:"row text-start g-3"},{default:P(()=>[A(W,{cols:"12"},{default:P(()=>[A(mt,null,{label:P(()=>[Se(" Module name "),kO]),default:P(()=>[A(Wt,{modelValue:m.title,"onUpdate:modelValue":ee[0]||(ee[0]=F=>m.title=F),placeholder:"Enter module name",class:br({"is-invalid":y.title}),required:""},null,8,["modelValue","class"]),y.title?(Te(),Le("div",SO,Be(y.title),1)):dt("",!0)]),_:1})]),_:1}),A(W,{cols:"12"},{default:P(()=>[A(mt,{label:"Order"},{default:P(()=>[A(Wt,{modelValue:m.order,"onUpdate:modelValue":ee[1]||(ee[1]=F=>m.order=F),modelModifiers:{number:!0},type:"number",placeholder:"Enter module order",class:br({"is-invalid":y.order})},null,8,["modelValue","class"]),y.order?(Te(),Le("div",CO,Be(y.order),1)):dt("",!0)]),_:1})]),_:1}),A(W,{cols:"12"},{default:P(()=>[A(mt,{label:"Description"},{default:P(()=>[A(ne,{modelValue:m.description,"onUpdate:modelValue":ee[2]||(ee[2]=F=>m.description=F),rows:"4",placeholder:"Enter module description"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["title","ok-title","ok-disabled","modelValue"]),A(xe,{id:"addVideo",title:d.value?"Edit Video":"Add Video","header-class":"bg-dark","title-class":"text-white","ok-title":p.value?"Saving...":"Save Video","ok-variant":"success","cancel-title":"Close","cancel-variant":"danger-soft","ok-disabled":p.value,modelValue:a.value,"onUpdate:modelValue":ee[9]||(ee[9]=F=>a.value=F),onOk:te,onHidden:K},{default:P(()=>[A(J,{class:"row text-start g-3"},{default:P(()=>[A(W,{md:"6"},{default:P(()=>[A(mt,{label:"Video name"},{default:P(()=>[A(Wt,{modelValue:v.title,"onUpdate:modelValue":ee[4]||(ee[4]=F=>v.title=F),placeholder:"Enter video name",class:br({"is-invalid":x.title}),required:""},null,8,["modelValue","class"]),x.title?(Te(),Le("div",MO,Be(x.title),1)):dt("",!0)]),_:1})]),_:1}),A(W,{md:"6"},{default:P(()=>[A(mt,{label:"Video link"},{default:P(()=>[A(Wt,{modelValue:v.video_url,"onUpdate:modelValue":ee[5]||(ee[5]=F=>v.video_url=F),placeholder:"Enter video link",class:br({"is-invalid":x.video_url}),required:""},null,8,["modelValue","class"]),x.video_url?(Te(),Le("div",TO,Be(x.video_url),1)):dt("",!0)]),_:1})]),_:1}),A(W,{cols:"12",class:"mt-3"},{default:P(()=>[A(mt,{label:"Description"},{default:P(()=>[A(ne,{modelValue:v.description,"onUpdate:modelValue":ee[6]||(ee[6]=F=>v.description=F),rows:"4",placeholder:"Enter video description"},null,8,["modelValue"])]),_:1})]),_:1}),A(W,{cols:"6",class:"mt-3"},{default:P(()=>[D("div",OO,[$i(D("input",{type:"radio",class:"btn-check",name:"options",id:"option1","onUpdate:modelValue":ee[7]||(ee[7]=F=>v.is_free=F),value:!0,checked:""},null,512),[[td,v.is_free]]),AO,$i(D("input",{type:"radio",class:"btn-check",name:"options",id:"option2","onUpdate:modelValue":ee[8]||(ee[8]=F=>v.is_free=F),value:!1},null,512),[[td,v.is_free]]),EO])]),_:1})]),_:1})]),_:1},8,["title","ok-title","ok-disabled","modelValue"])])}}}),or=r=>(vh("data-v-e8da9960"),r=r(),bh(),r),NO={id:"step-4",role:"tabpanel",class:"content fade","aria-labelledby":"steppertrigger4"},IO=or(()=>D("h4",null,"Additional information",-1)),RO=or(()=>D("hr",null,null,-1)),PO={class:"bg-light border rounded p-2 p-sm-4"},LO={class:"d-sm-flex justify-content-sm-between align-items-center mb-3"},BO=or(()=>D("h5",{class:"mb-2 mb-sm-0"},"Upload FAQs",-1)),FO={class:"bg-body p-3 p-sm-4 border rounded"},$O={class:"d-sm-flex justify-content-sm-between align-items-center mb-2"},VO={class:"mb-0"},zO={class:"align-middle"},WO=["onClick"],qO=or(()=>D("p",{class:"text-muted"},"No FAQs added yet.",-1)),HO={class:"bg-light border rounded p-4"},UO=or(()=>D("h5",{class:"mb-0"},"Tags",-1)),JO={class:"mt-3"},KO={key:0,class:"invalid-feedback"},GO={class:"mt-3"},YO=["onClick"],jO=or(()=>D("small",{class:"text-muted"},"Maximum of 14 keywords. Keywords should all be in lowercase. Press Enter or click Add Tag to add a tag.",-1)),XO={class:"bg-light border rounded p-4"},ZO=or(()=>D("h5",{class:"mb-0"},"Message to a reviewer",-1)),QO={class:"mt-3"},eA={class:"form-check mb-0 mt-2"},tA=or(()=>D("label",{class:"form-check-label",for:"exampleCheck1"}," Any images, sounds, or other assets that are not my own work, have been appropriately licensed for use in the file preview or main course. Other than these items, this work is entirely my own and I have full rights to sell it here. ",-1)),nA={class:"d-md-flex justify-content-between align-items-start mt-4"},rA={key:0,class:"invalid-feedback"},iA={key:0,class:"invalid-feedback"},sA=ci({__name:"Step4",props:{formData:{},previousPage:{type:Function},errors:{},saveDraft:{type:Function}},emits:["update:formData"],setup(r,{emit:e}){const t=Co.useToast(),n=xh(),i=r,o=e,a=Pe(!1),u=Pe(null),f=Pe(null),d=Pe(""),p=Pe(!1),m=Zr({question:"",answer:""}),y=Zr({question:"",answer:""}),v=()=>{u.value=null,f.value=null,m.question="",m.answer="",y.question="",y.answer="",a.value=!0},x=(K,G)=>{u.value=K,f.value=G,m.question=K.question,m.answer=K.answer,y.question="",y.answer="",a.value=!0},b=async K=>{if(K.preventDefault(),!m.question){y.question="Question is required",t.error("Please fill in all required fields");return}if(!m.answer){y.answer="Answer is required",t.error("Please fill in all required fields");return}try{p.value=!0;const G={question:m.question,answer:m.answer};u.value&&f.value!==null?i.formData.faqs[f.value]=G:i.formData.faqs.push(G),o("update:formData",i.formData),t.success(u.value?"FAQ updated successfully!":"FAQ added successfully!"),a.value=!1}catch(G){console.error("Error saving FAQ:",G),t.error("Failed to save FAQ")}finally{p.value=!1}},S=K=>{confirm("Are you sure you want to delete this FAQ?")&&(i.formData.faqs.splice(K,1),o("update:formData",i.formData),t.success("FAQ deleted successfully!"))},E=()=>{if(d.value.trim()&&i.formData.tags.length<14){const K=d.value.trim().toLowerCase();i.formData.tags.includes(K)||(i.formData.tags.push(K),o("update:formData",i.formData))}d.value=""},Z=K=>{i.formData.tags.splice(K,1),o("update:formData",i.formData)},te=()=>{a.value=!1,u.value=null,f.value=null,m.question="",m.answer="",y.question="",y.answer=""},ve=()=>{t.info("Course preview functionality not implemented yet.")},ue=async()=>{try{await i.saveDraft(),t.success("Course submitted for review!"),n.push({name:"instructor.course.added"})}catch(K){console.error("Error submitting course:",K),t.error("Failed to submit course")}};return(K,G)=>{const ee=Xa("font-awesome-icon"),j=So,ke=Qi,He=Zi,nt=ko,St=Xi,Wt=ja,mt=Ya,W=Za,ne=wh;return Te(),Le("div",NO,[IO,RO,A(He,{class:"g-4"},{default:P(()=>[A(ke,{cols:"12"},{default:P(()=>[D("div",PO,[D("div",LO,[BO,D("a",{href:"#",class:"btn btn-sm btn-primary-soft mb-0",onClick:v},[A(Et(Oa),{class:"me-2"}),Se(" Add Question ")])]),A(He,{class:"g-4"},{default:P(()=>[(Te(!0),Le(Vi,null,zi(K.formData.faqs,(J,xe)=>(Te(),ri(ke,{cols:"12",key:`faq-${xe}`},{default:P(()=>[D("div",FO,[D("div",$O,[D("h6",VO,Be(J.question||"Untitled Question"),1),D("div",zO,[D("a",{href:"#",class:"btn btn-sm btn-success-soft btn-round me-1 mb-1 mb-md-0",onClick:F=>x(J,xe)},[A(ee,{icon:Et(Sh),class:"fa-fw"},null,8,["icon"])],8,WO),A(j,{variant:"danger-soft",size:"sm",class:"btn-round mb-0",onClick:F=>S(xe)},{default:P(()=>[A(ee,{icon:Et(Ch),class:"fa-fw"},null,8,["icon"])]),_:2},1032,["onClick"])])]),D("p",null,Be(J.answer||"No answer provided"),1)])]),_:2},1024))),128)),K.formData.faqs.length?dt("",!0):(Te(),ri(ke,{key:0,cols:"12"},{default:P(()=>[qO]),_:1}))]),_:1})])]),_:1}),A(ke,{cols:"12"},{default:P(()=>[D("div",HO,[UO,D("div",JO,[A(St,{label:"Add Tags"},{default:P(()=>[A(nt,{modelValue:d.value,"onUpdate:modelValue":G[0]||(G[0]=J=>d.value=J),placeholder:"Enter tags (e.g., javascript, react)",onKeyup:ox(E,["enter"]),class:br({"is-invalid":K.errors.tags})},null,8,["modelValue","class"]),K.errors.tags?(Te(),Le("div",KO,Be(K.errors.tags),1)):dt("",!0)]),_:1}),A(j,{variant:"primary",size:"sm",class:"mt-2",onClick:E},{default:P(()=>[Se("Add Tag")]),_:1}),D("div",GO,[(Te(!0),Le(Vi,null,zi(K.formData.tags,(J,xe)=>(Te(),Le("span",{key:xe,class:"badge bg-primary text-white mr-1 mb-1"},[Se(Be(J)+" ",1),D("span",{class:"ml-1 cursor-pointer",onClick:F=>Z(xe)},"",8,YO)]))),128))]),jO])])]),_:1}),A(ke,{cols:"12"},{default:P(()=>[D("div",XO,[ZO,D("div",QO,[A(Wt,{modelValue:K.formData.reviewer_message,"onUpdate:modelValue":G[1]||(G[1]=J=>K.formData.reviewer_message=J),placeholder:"Write a message",rows:"4","max-rows":"6",state:K.errors.reviewer_message?!1:null},null,8,["modelValue","state"]),A(mt,null,{default:P(()=>[Se(Be(K.errors.reviewer_message),1)]),_:1}),D("div",eA,[$i(D("input",{type:"checkbox",class:"form-check-input",id:"exampleCheck1","onUpdate:modelValue":G[2]||(G[2]=J=>K.formData.assets_licensed=J)},null,512),[[Ta,K.formData.assets_licensed]]),tA])])])]),_:1}),D("div",nA,[A(j,{variant:"secondary",class:"prev-btn mb-2 mb-md-0",onClick:K.previousPage},{default:P(()=>[Se("Previous")]),_:1},8,["onClick"]),D("div",null,[A(j,{variant:"outline-primary",class:"mb-2 mb-md-0 mr-2",onClick:K.saveDraft},{default:P(()=>[Se("Save as Draft")]),_:1},8,["onClick"]),A(j,{variant:"light",class:"me-auto ms-md-2 mb-2 mb-md-0",onClick:ve},{default:P(()=>[Se("Preview Course")]),_:1}),A(j,{type:"submit",variant:"success",class:"mb-2 mb-sm-0",onClick:ue},{default:P(()=>[Se("Submit a Course")]),_:1})])])]),_:1}),A(ne,{id:"addQuestion",title:u.value?"Edit FAQ":"Add FAQ","header-class":"bg-dark","title-class":"text-white","ok-title":p.value?"Saving...":"Save FAQ","ok-variant":"success","cancel-title":"Close","cancel-variant":"danger-soft","ok-disabled":p.value,modelValue:a.value,"onUpdate:modelValue":G[5]||(G[5]=J=>a.value=J),onOk:b,onHidden:te},{default:P(()=>[A(W,{class:"row text-start g-3"},{default:P(()=>[A(ke,{cols:"12"},{default:P(()=>[A(St,{label:"Question"},{default:P(()=>[A(nt,{modelValue:m.question,"onUpdate:modelValue":G[3]||(G[3]=J=>m.question=J),placeholder:"Write a question",class:br({"is-invalid":y.question}),required:""},null,8,["modelValue","class"]),y.question?(Te(),Le("div",rA,Be(y.question),1)):dt("",!0)]),_:1})]),_:1}),A(ke,{cols:"12",class:"mt-3"},{default:P(()=>[A(St,{label:"Answer"},{default:P(()=>[A(Wt,{modelValue:m.answer,"onUpdate:modelValue":G[4]||(G[4]=J=>m.answer=J),rows:"4",placeholder:"Write an answer",class:br({"is-invalid":y.answer}),required:""},null,8,["modelValue","class"]),y.answer?(Te(),Le("div",iA,Be(y.answer),1)):dt("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["title","ok-title","ok-disabled","modelValue"])])}}}),oA=_h(sA,[["__scopeId","data-v-e8da9960"]]);var _o={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */_o.exports;(function(r,e){(function(){var t,n="4.17.21",i=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",u="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",d=500,p="__lodash_placeholder__",m=1,y=2,v=4,x=1,b=2,S=1,E=2,Z=4,te=8,ve=16,ue=32,K=64,G=128,ee=256,j=512,ke=30,He="...",nt=800,St=16,Wt=1,mt=2,W=3,ne=1/0,J=9007199254740991,xe=17976931348623157e292,F=NaN,V=4294967295,ie=V-1,L=V>>>1,z=[["ary",G],["bind",S],["bindKey",E],["curry",te],["curryRight",ve],["flip",j],["partial",ue],["partialRight",K],["rearg",ee]],H="[object Arguments]",me="[object Array]",Ae="[object AsyncFunction]",rt="[object Boolean]",In="[object Date]",rs="[object DOMException]",lr="[object Error]",Je="[object Function]",is="[object GeneratorFunction]",Ct="[object Map]",un="[object Number]",dm="[object Null]",vn="[object Object]",Su="[object Promise]",hm="[object Proxy]",di="[object RegExp]",tn="[object Set]",hi="[object String]",ss="[object Symbol]",pm="[object Undefined]",pi="[object WeakMap]",mm="[object WeakSet]",mi="[object ArrayBuffer]",Ir="[object DataView]",$o="[object Float32Array]",Vo="[object Float64Array]",zo="[object Int8Array]",Wo="[object Int16Array]",qo="[object Int32Array]",Ho="[object Uint8Array]",Uo="[object Uint8ClampedArray]",Jo="[object Uint16Array]",Ko="[object Uint32Array]",gm=/\b__p \+= '';/g,ym=/\b(__p \+=) '' \+/g,vm=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Cu=/&(?:amp|lt|gt|quot|#39);/g,Mu=/[&<>"']/g,bm=RegExp(Cu.source),wm=RegExp(Mu.source),xm=/<%-([\s\S]+?)%>/g,_m=/<%([\s\S]+?)%>/g,Tu=/<%=([\s\S]+?)%>/g,km=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Sm=/^\w*$/,Cm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Go=/[\\^$.*+?()[\]{}|]/g,Mm=RegExp(Go.source),Yo=/^\s+/,Tm=/\s/,Om=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Am=/\{\n\/\* \[wrapped with (.+)\] \*/,Em=/,? & /,Dm=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Nm=/[()=,{}\[\]\/\s]/,Im=/\\(\\)?/g,Rm=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ou=/\w*$/,Pm=/^[-+]0x[0-9a-f]+$/i,Lm=/^0b[01]+$/i,Bm=/^\[object .+?Constructor\]$/,Fm=/^0o[0-7]+$/i,$m=/^(?:0|[1-9]\d*)$/,Vm=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ls=/($^)/,zm=/['\n\r\u2028\u2029\\]/g,as="\\ud800-\\udfff",Wm="\\u0300-\\u036f",qm="\\ufe20-\\ufe2f",Hm="\\u20d0-\\u20ff",Au=Wm+qm+Hm,Eu="\\u2700-\\u27bf",Du="a-z\\xdf-\\xf6\\xf8-\\xff",Um="\\xac\\xb1\\xd7\\xf7",Jm="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Km="\\u2000-\\u206f",Gm=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Nu="A-Z\\xc0-\\xd6\\xd8-\\xde",Iu="\\ufe0e\\ufe0f",Ru=Um+Jm+Km+Gm,jo="[']",Ym="["+as+"]",Pu="["+Ru+"]",us="["+Au+"]",Lu="\\d+",jm="["+Eu+"]",Bu="["+Du+"]",Fu="[^"+as+Ru+Lu+Eu+Du+Nu+"]",Xo="\\ud83c[\\udffb-\\udfff]",Xm="(?:"+us+"|"+Xo+")",$u="[^"+as+"]",Zo="(?:\\ud83c[\\udde6-\\uddff]){2}",Qo="[\\ud800-\\udbff][\\udc00-\\udfff]",Rr="["+Nu+"]",Vu="\\u200d",zu="(?:"+Bu+"|"+Fu+")",Zm="(?:"+Rr+"|"+Fu+")",Wu="(?:"+jo+"(?:d|ll|m|re|s|t|ve))?",qu="(?:"+jo+"(?:D|LL|M|RE|S|T|VE))?",Hu=Xm+"?",Uu="["+Iu+"]?",Qm="(?:"+Vu+"(?:"+[$u,Zo,Qo].join("|")+")"+Uu+Hu+")*",eg="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",tg="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ju=Uu+Hu+Qm,ng="(?:"+[jm,Zo,Qo].join("|")+")"+Ju,rg="(?:"+[$u+us+"?",us,Zo,Qo,Ym].join("|")+")",ig=RegExp(jo,"g"),sg=RegExp(us,"g"),el=RegExp(Xo+"(?="+Xo+")|"+rg+Ju,"g"),og=RegExp([Rr+"?"+Bu+"+"+Wu+"(?="+[Pu,Rr,"$"].join("|")+")",Zm+"+"+qu+"(?="+[Pu,Rr+zu,"$"].join("|")+")",Rr+"?"+zu+"+"+Wu,Rr+"+"+qu,tg,eg,Lu,ng].join("|"),"g"),lg=RegExp("["+Vu+as+Au+Iu+"]"),ag=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ug=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],cg=-1,Re={};Re[$o]=Re[Vo]=Re[zo]=Re[Wo]=Re[qo]=Re[Ho]=Re[Uo]=Re[Jo]=Re[Ko]=!0,Re[H]=Re[me]=Re[mi]=Re[rt]=Re[Ir]=Re[In]=Re[lr]=Re[Je]=Re[Ct]=Re[un]=Re[vn]=Re[di]=Re[tn]=Re[hi]=Re[pi]=!1;var Ie={};Ie[H]=Ie[me]=Ie[mi]=Ie[Ir]=Ie[rt]=Ie[In]=Ie[$o]=Ie[Vo]=Ie[zo]=Ie[Wo]=Ie[qo]=Ie[Ct]=Ie[un]=Ie[vn]=Ie[di]=Ie[tn]=Ie[hi]=Ie[ss]=Ie[Ho]=Ie[Uo]=Ie[Jo]=Ie[Ko]=!0,Ie[lr]=Ie[Je]=Ie[pi]=!1;var fg={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},dg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},hg={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},mg=parseFloat,gg=parseInt,Ku=typeof Di=="object"&&Di&&Di.Object===Object&&Di,yg=typeof self=="object"&&self&&self.Object===Object&&self,it=Ku||yg||Function("return this")(),tl=e&&!e.nodeType&&e,ar=tl&&!0&&r&&!r.nodeType&&r,Gu=ar&&ar.exports===tl,nl=Gu&&Ku.process,qt=function(){try{var M=ar&&ar.require&&ar.require("util").types;return M||nl&&nl.binding&&nl.binding("util")}catch{}}(),Yu=qt&&qt.isArrayBuffer,ju=qt&&qt.isDate,Xu=qt&&qt.isMap,Zu=qt&&qt.isRegExp,Qu=qt&&qt.isSet,ec=qt&&qt.isTypedArray;function Rt(M,N,O){switch(O.length){case 0:return M.call(N);case 1:return M.call(N,O[0]);case 2:return M.call(N,O[0],O[1]);case 3:return M.call(N,O[0],O[1],O[2])}return M.apply(N,O)}function vg(M,N,O,Y){for(var ce=-1,Ce=M==null?0:M.length;++ce<Ce;){var Ke=M[ce];N(Y,Ke,O(Ke),M)}return Y}function Ht(M,N){for(var O=-1,Y=M==null?0:M.length;++O<Y&&N(M[O],O,M)!==!1;);return M}function bg(M,N){for(var O=M==null?0:M.length;O--&&N(M[O],O,M)!==!1;);return M}function tc(M,N){for(var O=-1,Y=M==null?0:M.length;++O<Y;)if(!N(M[O],O,M))return!1;return!0}function Rn(M,N){for(var O=-1,Y=M==null?0:M.length,ce=0,Ce=[];++O<Y;){var Ke=M[O];N(Ke,O,M)&&(Ce[ce++]=Ke)}return Ce}function cs(M,N){var O=M==null?0:M.length;return!!O&&Pr(M,N,0)>-1}function rl(M,N,O){for(var Y=-1,ce=M==null?0:M.length;++Y<ce;)if(O(N,M[Y]))return!0;return!1}function Fe(M,N){for(var O=-1,Y=M==null?0:M.length,ce=Array(Y);++O<Y;)ce[O]=N(M[O],O,M);return ce}function Pn(M,N){for(var O=-1,Y=N.length,ce=M.length;++O<Y;)M[ce+O]=N[O];return M}function il(M,N,O,Y){var ce=-1,Ce=M==null?0:M.length;for(Y&&Ce&&(O=M[++ce]);++ce<Ce;)O=N(O,M[ce],ce,M);return O}function wg(M,N,O,Y){var ce=M==null?0:M.length;for(Y&&ce&&(O=M[--ce]);ce--;)O=N(O,M[ce],ce,M);return O}function sl(M,N){for(var O=-1,Y=M==null?0:M.length;++O<Y;)if(N(M[O],O,M))return!0;return!1}var xg=ol("length");function _g(M){return M.split("")}function kg(M){return M.match(Dm)||[]}function nc(M,N,O){var Y;return O(M,function(ce,Ce,Ke){if(N(ce,Ce,Ke))return Y=Ce,!1}),Y}function fs(M,N,O,Y){for(var ce=M.length,Ce=O+(Y?1:-1);Y?Ce--:++Ce<ce;)if(N(M[Ce],Ce,M))return Ce;return-1}function Pr(M,N,O){return N===N?Pg(M,N,O):fs(M,rc,O)}function Sg(M,N,O,Y){for(var ce=O-1,Ce=M.length;++ce<Ce;)if(Y(M[ce],N))return ce;return-1}function rc(M){return M!==M}function ic(M,N){var O=M==null?0:M.length;return O?al(M,N)/O:F}function ol(M){return function(N){return N==null?t:N[M]}}function ll(M){return function(N){return M==null?t:M[N]}}function sc(M,N,O,Y,ce){return ce(M,function(Ce,Ke,De){O=Y?(Y=!1,Ce):N(O,Ce,Ke,De)}),O}function Cg(M,N){var O=M.length;for(M.sort(N);O--;)M[O]=M[O].value;return M}function al(M,N){for(var O,Y=-1,ce=M.length;++Y<ce;){var Ce=N(M[Y]);Ce!==t&&(O=O===t?Ce:O+Ce)}return O}function ul(M,N){for(var O=-1,Y=Array(M);++O<M;)Y[O]=N(O);return Y}function Mg(M,N){return Fe(N,function(O){return[O,M[O]]})}function oc(M){return M&&M.slice(0,cc(M)+1).replace(Yo,"")}function Pt(M){return function(N){return M(N)}}function cl(M,N){return Fe(N,function(O){return M[O]})}function gi(M,N){return M.has(N)}function lc(M,N){for(var O=-1,Y=M.length;++O<Y&&Pr(N,M[O],0)>-1;);return O}function ac(M,N){for(var O=M.length;O--&&Pr(N,M[O],0)>-1;);return O}function Tg(M,N){for(var O=M.length,Y=0;O--;)M[O]===N&&++Y;return Y}var Og=ll(fg),Ag=ll(dg);function Eg(M){return"\\"+pg[M]}function Dg(M,N){return M==null?t:M[N]}function Lr(M){return lg.test(M)}function Ng(M){return ag.test(M)}function Ig(M){for(var N,O=[];!(N=M.next()).done;)O.push(N.value);return O}function fl(M){var N=-1,O=Array(M.size);return M.forEach(function(Y,ce){O[++N]=[ce,Y]}),O}function uc(M,N){return function(O){return M(N(O))}}function Ln(M,N){for(var O=-1,Y=M.length,ce=0,Ce=[];++O<Y;){var Ke=M[O];(Ke===N||Ke===p)&&(M[O]=p,Ce[ce++]=O)}return Ce}function ds(M){var N=-1,O=Array(M.size);return M.forEach(function(Y){O[++N]=Y}),O}function Rg(M){var N=-1,O=Array(M.size);return M.forEach(function(Y){O[++N]=[Y,Y]}),O}function Pg(M,N,O){for(var Y=O-1,ce=M.length;++Y<ce;)if(M[Y]===N)return Y;return-1}function Lg(M,N,O){for(var Y=O+1;Y--;)if(M[Y]===N)return Y;return Y}function Br(M){return Lr(M)?Fg(M):xg(M)}function nn(M){return Lr(M)?$g(M):_g(M)}function cc(M){for(var N=M.length;N--&&Tm.test(M.charAt(N)););return N}var Bg=ll(hg);function Fg(M){for(var N=el.lastIndex=0;el.test(M);)++N;return N}function $g(M){return M.match(el)||[]}function Vg(M){return M.match(og)||[]}var zg=function M(N){N=N==null?it:Fr.defaults(it.Object(),N,Fr.pick(it,ug));var O=N.Array,Y=N.Date,ce=N.Error,Ce=N.Function,Ke=N.Math,De=N.Object,dl=N.RegExp,Wg=N.String,Ut=N.TypeError,hs=O.prototype,qg=Ce.prototype,$r=De.prototype,ps=N["__core-js_shared__"],ms=qg.toString,Ee=$r.hasOwnProperty,Hg=0,fc=function(){var s=/[^.]+$/.exec(ps&&ps.keys&&ps.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),gs=$r.toString,Ug=ms.call(De),Jg=it._,Kg=dl("^"+ms.call(Ee).replace(Go,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ys=Gu?N.Buffer:t,Bn=N.Symbol,vs=N.Uint8Array,dc=ys?ys.allocUnsafe:t,bs=uc(De.getPrototypeOf,De),hc=De.create,pc=$r.propertyIsEnumerable,ws=hs.splice,mc=Bn?Bn.isConcatSpreadable:t,yi=Bn?Bn.iterator:t,ur=Bn?Bn.toStringTag:t,xs=function(){try{var s=pr(De,"defineProperty");return s({},"",{}),s}catch{}}(),Gg=N.clearTimeout!==it.clearTimeout&&N.clearTimeout,Yg=Y&&Y.now!==it.Date.now&&Y.now,jg=N.setTimeout!==it.setTimeout&&N.setTimeout,_s=Ke.ceil,ks=Ke.floor,hl=De.getOwnPropertySymbols,Xg=ys?ys.isBuffer:t,gc=N.isFinite,Zg=hs.join,Qg=uc(De.keys,De),Ge=Ke.max,ut=Ke.min,ey=Y.now,ty=N.parseInt,yc=Ke.random,ny=hs.reverse,pl=pr(N,"DataView"),vi=pr(N,"Map"),ml=pr(N,"Promise"),Vr=pr(N,"Set"),bi=pr(N,"WeakMap"),wi=pr(De,"create"),Ss=bi&&new bi,zr={},ry=mr(pl),iy=mr(vi),sy=mr(ml),oy=mr(Vr),ly=mr(bi),Cs=Bn?Bn.prototype:t,xi=Cs?Cs.valueOf:t,vc=Cs?Cs.toString:t;function w(s){if(Ve(s)&&!fe(s)&&!(s instanceof we)){if(s instanceof Jt)return s;if(Ee.call(s,"__wrapped__"))return wf(s)}return new Jt(s)}var Wr=function(){function s(){}return function(l){if(!$e(l))return{};if(hc)return hc(l);s.prototype=l;var c=new s;return s.prototype=t,c}}();function Ms(){}function Jt(s,l){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!l,this.__index__=0,this.__values__=t}w.templateSettings={escape:xm,evaluate:_m,interpolate:Tu,variable:"",imports:{_:w}},w.prototype=Ms.prototype,w.prototype.constructor=w,Jt.prototype=Wr(Ms.prototype),Jt.prototype.constructor=Jt;function we(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=V,this.__views__=[]}function ay(){var s=new we(this.__wrapped__);return s.__actions__=Mt(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=Mt(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=Mt(this.__views__),s}function uy(){if(this.__filtered__){var s=new we(this);s.__dir__=-1,s.__filtered__=!0}else s=this.clone(),s.__dir__*=-1;return s}function cy(){var s=this.__wrapped__.value(),l=this.__dir__,c=fe(s),h=l<0,g=c?s.length:0,_=_0(0,g,this.__views__),k=_.start,C=_.end,T=C-k,I=h?C:k-1,R=this.__iteratees__,B=R.length,q=0,Q=ut(T,this.__takeCount__);if(!c||!h&&g==T&&Q==T)return Wc(s,this.__actions__);var oe=[];e:for(;T--&&q<Q;){I+=l;for(var pe=-1,le=s[I];++pe<B;){var be=R[pe],_e=be.iteratee,Ft=be.type,vt=_e(le);if(Ft==mt)le=vt;else if(!vt){if(Ft==Wt)continue e;break e}}oe[q++]=le}return oe}we.prototype=Wr(Ms.prototype),we.prototype.constructor=we;function cr(s){var l=-1,c=s==null?0:s.length;for(this.clear();++l<c;){var h=s[l];this.set(h[0],h[1])}}function fy(){this.__data__=wi?wi(null):{},this.size=0}function dy(s){var l=this.has(s)&&delete this.__data__[s];return this.size-=l?1:0,l}function hy(s){var l=this.__data__;if(wi){var c=l[s];return c===f?t:c}return Ee.call(l,s)?l[s]:t}function py(s){var l=this.__data__;return wi?l[s]!==t:Ee.call(l,s)}function my(s,l){var c=this.__data__;return this.size+=this.has(s)?0:1,c[s]=wi&&l===t?f:l,this}cr.prototype.clear=fy,cr.prototype.delete=dy,cr.prototype.get=hy,cr.prototype.has=py,cr.prototype.set=my;function bn(s){var l=-1,c=s==null?0:s.length;for(this.clear();++l<c;){var h=s[l];this.set(h[0],h[1])}}function gy(){this.__data__=[],this.size=0}function yy(s){var l=this.__data__,c=Ts(l,s);if(c<0)return!1;var h=l.length-1;return c==h?l.pop():ws.call(l,c,1),--this.size,!0}function vy(s){var l=this.__data__,c=Ts(l,s);return c<0?t:l[c][1]}function by(s){return Ts(this.__data__,s)>-1}function wy(s,l){var c=this.__data__,h=Ts(c,s);return h<0?(++this.size,c.push([s,l])):c[h][1]=l,this}bn.prototype.clear=gy,bn.prototype.delete=yy,bn.prototype.get=vy,bn.prototype.has=by,bn.prototype.set=wy;function wn(s){var l=-1,c=s==null?0:s.length;for(this.clear();++l<c;){var h=s[l];this.set(h[0],h[1])}}function xy(){this.size=0,this.__data__={hash:new cr,map:new(vi||bn),string:new cr}}function _y(s){var l=$s(this,s).delete(s);return this.size-=l?1:0,l}function ky(s){return $s(this,s).get(s)}function Sy(s){return $s(this,s).has(s)}function Cy(s,l){var c=$s(this,s),h=c.size;return c.set(s,l),this.size+=c.size==h?0:1,this}wn.prototype.clear=xy,wn.prototype.delete=_y,wn.prototype.get=ky,wn.prototype.has=Sy,wn.prototype.set=Cy;function fr(s){var l=-1,c=s==null?0:s.length;for(this.__data__=new wn;++l<c;)this.add(s[l])}function My(s){return this.__data__.set(s,f),this}function Ty(s){return this.__data__.has(s)}fr.prototype.add=fr.prototype.push=My,fr.prototype.has=Ty;function rn(s){var l=this.__data__=new bn(s);this.size=l.size}function Oy(){this.__data__=new bn,this.size=0}function Ay(s){var l=this.__data__,c=l.delete(s);return this.size=l.size,c}function Ey(s){return this.__data__.get(s)}function Dy(s){return this.__data__.has(s)}function Ny(s,l){var c=this.__data__;if(c instanceof bn){var h=c.__data__;if(!vi||h.length<i-1)return h.push([s,l]),this.size=++c.size,this;c=this.__data__=new wn(h)}return c.set(s,l),this.size=c.size,this}rn.prototype.clear=Oy,rn.prototype.delete=Ay,rn.prototype.get=Ey,rn.prototype.has=Dy,rn.prototype.set=Ny;function bc(s,l){var c=fe(s),h=!c&&gr(s),g=!c&&!h&&Wn(s),_=!c&&!h&&!g&&Jr(s),k=c||h||g||_,C=k?ul(s.length,Wg):[],T=C.length;for(var I in s)(l||Ee.call(s,I))&&!(k&&(I=="length"||g&&(I=="offset"||I=="parent")||_&&(I=="buffer"||I=="byteLength"||I=="byteOffset")||Sn(I,T)))&&C.push(I);return C}function wc(s){var l=s.length;return l?s[Ml(0,l-1)]:t}function Iy(s,l){return Vs(Mt(s),dr(l,0,s.length))}function Ry(s){return Vs(Mt(s))}function gl(s,l,c){(c!==t&&!sn(s[l],c)||c===t&&!(l in s))&&xn(s,l,c)}function _i(s,l,c){var h=s[l];(!(Ee.call(s,l)&&sn(h,c))||c===t&&!(l in s))&&xn(s,l,c)}function Ts(s,l){for(var c=s.length;c--;)if(sn(s[c][0],l))return c;return-1}function Py(s,l,c,h){return Fn(s,function(g,_,k){l(h,g,c(g),k)}),h}function xc(s,l){return s&&fn(l,je(l),s)}function Ly(s,l){return s&&fn(l,Ot(l),s)}function xn(s,l,c){l=="__proto__"&&xs?xs(s,l,{configurable:!0,enumerable:!0,value:c,writable:!0}):s[l]=c}function yl(s,l){for(var c=-1,h=l.length,g=O(h),_=s==null;++c<h;)g[c]=_?t:Xl(s,l[c]);return g}function dr(s,l,c){return s===s&&(c!==t&&(s=s<=c?s:c),l!==t&&(s=s>=l?s:l)),s}function Kt(s,l,c,h,g,_){var k,C=l&m,T=l&y,I=l&v;if(c&&(k=g?c(s,h,g,_):c(s)),k!==t)return k;if(!$e(s))return s;var R=fe(s);if(R){if(k=S0(s),!C)return Mt(s,k)}else{var B=ct(s),q=B==Je||B==is;if(Wn(s))return Uc(s,C);if(B==vn||B==H||q&&!g){if(k=T||q?{}:ff(s),!C)return T?h0(s,Ly(k,s)):d0(s,xc(k,s))}else{if(!Ie[B])return g?s:{};k=C0(s,B,C)}}_||(_=new rn);var Q=_.get(s);if(Q)return Q;_.set(s,k),Vf(s)?s.forEach(function(le){k.add(Kt(le,l,c,le,s,_))}):Ff(s)&&s.forEach(function(le,be){k.set(be,Kt(le,l,c,be,s,_))});var oe=I?T?Bl:Ll:T?Ot:je,pe=R?t:oe(s);return Ht(pe||s,function(le,be){pe&&(be=le,le=s[be]),_i(k,be,Kt(le,l,c,be,s,_))}),k}function By(s){var l=je(s);return function(c){return _c(c,s,l)}}function _c(s,l,c){var h=c.length;if(s==null)return!h;for(s=De(s);h--;){var g=c[h],_=l[g],k=s[g];if(k===t&&!(g in s)||!_(k))return!1}return!0}function kc(s,l,c){if(typeof s!="function")throw new Ut(a);return Ai(function(){s.apply(t,c)},l)}function ki(s,l,c,h){var g=-1,_=cs,k=!0,C=s.length,T=[],I=l.length;if(!C)return T;c&&(l=Fe(l,Pt(c))),h?(_=rl,k=!1):l.length>=i&&(_=gi,k=!1,l=new fr(l));e:for(;++g<C;){var R=s[g],B=c==null?R:c(R);if(R=h||R!==0?R:0,k&&B===B){for(var q=I;q--;)if(l[q]===B)continue e;T.push(R)}else _(l,B,h)||T.push(R)}return T}var Fn=jc(cn),Sc=jc(bl,!0);function Fy(s,l){var c=!0;return Fn(s,function(h,g,_){return c=!!l(h,g,_),c}),c}function Os(s,l,c){for(var h=-1,g=s.length;++h<g;){var _=s[h],k=l(_);if(k!=null&&(C===t?k===k&&!Bt(k):c(k,C)))var C=k,T=_}return T}function $y(s,l,c,h){var g=s.length;for(c=de(c),c<0&&(c=-c>g?0:g+c),h=h===t||h>g?g:de(h),h<0&&(h+=g),h=c>h?0:Wf(h);c<h;)s[c++]=l;return s}function Cc(s,l){var c=[];return Fn(s,function(h,g,_){l(h,g,_)&&c.push(h)}),c}function st(s,l,c,h,g){var _=-1,k=s.length;for(c||(c=T0),g||(g=[]);++_<k;){var C=s[_];l>0&&c(C)?l>1?st(C,l-1,c,h,g):Pn(g,C):h||(g[g.length]=C)}return g}var vl=Xc(),Mc=Xc(!0);function cn(s,l){return s&&vl(s,l,je)}function bl(s,l){return s&&Mc(s,l,je)}function As(s,l){return Rn(l,function(c){return Cn(s[c])})}function hr(s,l){l=Vn(l,s);for(var c=0,h=l.length;s!=null&&c<h;)s=s[dn(l[c++])];return c&&c==h?s:t}function Tc(s,l,c){var h=l(s);return fe(s)?h:Pn(h,c(s))}function gt(s){return s==null?s===t?pm:dm:ur&&ur in De(s)?x0(s):R0(s)}function wl(s,l){return s>l}function Vy(s,l){return s!=null&&Ee.call(s,l)}function zy(s,l){return s!=null&&l in De(s)}function Wy(s,l,c){return s>=ut(l,c)&&s<Ge(l,c)}function xl(s,l,c){for(var h=c?rl:cs,g=s[0].length,_=s.length,k=_,C=O(_),T=1/0,I=[];k--;){var R=s[k];k&&l&&(R=Fe(R,Pt(l))),T=ut(R.length,T),C[k]=!c&&(l||g>=120&&R.length>=120)?new fr(k&&R):t}R=s[0];var B=-1,q=C[0];e:for(;++B<g&&I.length<T;){var Q=R[B],oe=l?l(Q):Q;if(Q=c||Q!==0?Q:0,!(q?gi(q,oe):h(I,oe,c))){for(k=_;--k;){var pe=C[k];if(!(pe?gi(pe,oe):h(s[k],oe,c)))continue e}q&&q.push(oe),I.push(Q)}}return I}function qy(s,l,c,h){return cn(s,function(g,_,k){l(h,c(g),_,k)}),h}function Si(s,l,c){l=Vn(l,s),s=mf(s,l);var h=s==null?s:s[dn(Yt(l))];return h==null?t:Rt(h,s,c)}function Oc(s){return Ve(s)&&gt(s)==H}function Hy(s){return Ve(s)&&gt(s)==mi}function Uy(s){return Ve(s)&&gt(s)==In}function Ci(s,l,c,h,g){return s===l?!0:s==null||l==null||!Ve(s)&&!Ve(l)?s!==s&&l!==l:Jy(s,l,c,h,Ci,g)}function Jy(s,l,c,h,g,_){var k=fe(s),C=fe(l),T=k?me:ct(s),I=C?me:ct(l);T=T==H?vn:T,I=I==H?vn:I;var R=T==vn,B=I==vn,q=T==I;if(q&&Wn(s)){if(!Wn(l))return!1;k=!0,R=!1}if(q&&!R)return _||(_=new rn),k||Jr(s)?af(s,l,c,h,g,_):b0(s,l,T,c,h,g,_);if(!(c&x)){var Q=R&&Ee.call(s,"__wrapped__"),oe=B&&Ee.call(l,"__wrapped__");if(Q||oe){var pe=Q?s.value():s,le=oe?l.value():l;return _||(_=new rn),g(pe,le,c,h,_)}}return q?(_||(_=new rn),w0(s,l,c,h,g,_)):!1}function Ky(s){return Ve(s)&&ct(s)==Ct}function _l(s,l,c,h){var g=c.length,_=g,k=!h;if(s==null)return!_;for(s=De(s);g--;){var C=c[g];if(k&&C[2]?C[1]!==s[C[0]]:!(C[0]in s))return!1}for(;++g<_;){C=c[g];var T=C[0],I=s[T],R=C[1];if(k&&C[2]){if(I===t&&!(T in s))return!1}else{var B=new rn;if(h)var q=h(I,R,T,s,l,B);if(!(q===t?Ci(R,I,x|b,h,B):q))return!1}}return!0}function Ac(s){if(!$e(s)||A0(s))return!1;var l=Cn(s)?Kg:Bm;return l.test(mr(s))}function Gy(s){return Ve(s)&&gt(s)==di}function Yy(s){return Ve(s)&&ct(s)==tn}function jy(s){return Ve(s)&&Js(s.length)&&!!Re[gt(s)]}function Ec(s){return typeof s=="function"?s:s==null?At:typeof s=="object"?fe(s)?Ic(s[0],s[1]):Nc(s):Qf(s)}function kl(s){if(!Oi(s))return Qg(s);var l=[];for(var c in De(s))Ee.call(s,c)&&c!="constructor"&&l.push(c);return l}function Xy(s){if(!$e(s))return I0(s);var l=Oi(s),c=[];for(var h in s)h=="constructor"&&(l||!Ee.call(s,h))||c.push(h);return c}function Sl(s,l){return s<l}function Dc(s,l){var c=-1,h=Tt(s)?O(s.length):[];return Fn(s,function(g,_,k){h[++c]=l(g,_,k)}),h}function Nc(s){var l=$l(s);return l.length==1&&l[0][2]?hf(l[0][0],l[0][1]):function(c){return c===s||_l(c,s,l)}}function Ic(s,l){return zl(s)&&df(l)?hf(dn(s),l):function(c){var h=Xl(c,s);return h===t&&h===l?Zl(c,s):Ci(l,h,x|b)}}function Es(s,l,c,h,g){s!==l&&vl(l,function(_,k){if(g||(g=new rn),$e(_))Zy(s,l,k,c,Es,h,g);else{var C=h?h(ql(s,k),_,k+"",s,l,g):t;C===t&&(C=_),gl(s,k,C)}},Ot)}function Zy(s,l,c,h,g,_,k){var C=ql(s,c),T=ql(l,c),I=k.get(T);if(I){gl(s,c,I);return}var R=_?_(C,T,c+"",s,l,k):t,B=R===t;if(B){var q=fe(T),Q=!q&&Wn(T),oe=!q&&!Q&&Jr(T);R=T,q||Q||oe?fe(C)?R=C:We(C)?R=Mt(C):Q?(B=!1,R=Uc(T,!0)):oe?(B=!1,R=Jc(T,!0)):R=[]:Ei(T)||gr(T)?(R=C,gr(C)?R=qf(C):(!$e(C)||Cn(C))&&(R=ff(T))):B=!1}B&&(k.set(T,R),g(R,T,h,_,k),k.delete(T)),gl(s,c,R)}function Rc(s,l){var c=s.length;if(c)return l+=l<0?c:0,Sn(l,c)?s[l]:t}function Pc(s,l,c){l.length?l=Fe(l,function(_){return fe(_)?function(k){return hr(k,_.length===1?_[0]:_)}:_}):l=[At];var h=-1;l=Fe(l,Pt(se()));var g=Dc(s,function(_,k,C){var T=Fe(l,function(I){return I(_)});return{criteria:T,index:++h,value:_}});return Cg(g,function(_,k){return f0(_,k,c)})}function Qy(s,l){return Lc(s,l,function(c,h){return Zl(s,h)})}function Lc(s,l,c){for(var h=-1,g=l.length,_={};++h<g;){var k=l[h],C=hr(s,k);c(C,k)&&Mi(_,Vn(k,s),C)}return _}function e0(s){return function(l){return hr(l,s)}}function Cl(s,l,c,h){var g=h?Sg:Pr,_=-1,k=l.length,C=s;for(s===l&&(l=Mt(l)),c&&(C=Fe(s,Pt(c)));++_<k;)for(var T=0,I=l[_],R=c?c(I):I;(T=g(C,R,T,h))>-1;)C!==s&&ws.call(C,T,1),ws.call(s,T,1);return s}function Bc(s,l){for(var c=s?l.length:0,h=c-1;c--;){var g=l[c];if(c==h||g!==_){var _=g;Sn(g)?ws.call(s,g,1):Al(s,g)}}return s}function Ml(s,l){return s+ks(yc()*(l-s+1))}function t0(s,l,c,h){for(var g=-1,_=Ge(_s((l-s)/(c||1)),0),k=O(_);_--;)k[h?_:++g]=s,s+=c;return k}function Tl(s,l){var c="";if(!s||l<1||l>J)return c;do l%2&&(c+=s),l=ks(l/2),l&&(s+=s);while(l);return c}function ge(s,l){return Hl(pf(s,l,At),s+"")}function n0(s){return wc(Kr(s))}function r0(s,l){var c=Kr(s);return Vs(c,dr(l,0,c.length))}function Mi(s,l,c,h){if(!$e(s))return s;l=Vn(l,s);for(var g=-1,_=l.length,k=_-1,C=s;C!=null&&++g<_;){var T=dn(l[g]),I=c;if(T==="__proto__"||T==="constructor"||T==="prototype")return s;if(g!=k){var R=C[T];I=h?h(R,T,C):t,I===t&&(I=$e(R)?R:Sn(l[g+1])?[]:{})}_i(C,T,I),C=C[T]}return s}var Fc=Ss?function(s,l){return Ss.set(s,l),s}:At,i0=xs?function(s,l){return xs(s,"toString",{configurable:!0,enumerable:!1,value:ea(l),writable:!0})}:At;function s0(s){return Vs(Kr(s))}function Gt(s,l,c){var h=-1,g=s.length;l<0&&(l=-l>g?0:g+l),c=c>g?g:c,c<0&&(c+=g),g=l>c?0:c-l>>>0,l>>>=0;for(var _=O(g);++h<g;)_[h]=s[h+l];return _}function o0(s,l){var c;return Fn(s,function(h,g,_){return c=l(h,g,_),!c}),!!c}function Ds(s,l,c){var h=0,g=s==null?h:s.length;if(typeof l=="number"&&l===l&&g<=L){for(;h<g;){var _=h+g>>>1,k=s[_];k!==null&&!Bt(k)&&(c?k<=l:k<l)?h=_+1:g=_}return g}return Ol(s,l,At,c)}function Ol(s,l,c,h){var g=0,_=s==null?0:s.length;if(_===0)return 0;l=c(l);for(var k=l!==l,C=l===null,T=Bt(l),I=l===t;g<_;){var R=ks((g+_)/2),B=c(s[R]),q=B!==t,Q=B===null,oe=B===B,pe=Bt(B);if(k)var le=h||oe;else I?le=oe&&(h||q):C?le=oe&&q&&(h||!Q):T?le=oe&&q&&!Q&&(h||!pe):Q||pe?le=!1:le=h?B<=l:B<l;le?g=R+1:_=R}return ut(_,ie)}function $c(s,l){for(var c=-1,h=s.length,g=0,_=[];++c<h;){var k=s[c],C=l?l(k):k;if(!c||!sn(C,T)){var T=C;_[g++]=k===0?0:k}}return _}function Vc(s){return typeof s=="number"?s:Bt(s)?F:+s}function Lt(s){if(typeof s=="string")return s;if(fe(s))return Fe(s,Lt)+"";if(Bt(s))return vc?vc.call(s):"";var l=s+"";return l=="0"&&1/s==-1/0?"-0":l}function $n(s,l,c){var h=-1,g=cs,_=s.length,k=!0,C=[],T=C;if(c)k=!1,g=rl;else if(_>=i){var I=l?null:y0(s);if(I)return ds(I);k=!1,g=gi,T=new fr}else T=l?[]:C;e:for(;++h<_;){var R=s[h],B=l?l(R):R;if(R=c||R!==0?R:0,k&&B===B){for(var q=T.length;q--;)if(T[q]===B)continue e;l&&T.push(B),C.push(R)}else g(T,B,c)||(T!==C&&T.push(B),C.push(R))}return C}function Al(s,l){return l=Vn(l,s),s=mf(s,l),s==null||delete s[dn(Yt(l))]}function zc(s,l,c,h){return Mi(s,l,c(hr(s,l)),h)}function Ns(s,l,c,h){for(var g=s.length,_=h?g:-1;(h?_--:++_<g)&&l(s[_],_,s););return c?Gt(s,h?0:_,h?_+1:g):Gt(s,h?_+1:0,h?g:_)}function Wc(s,l){var c=s;return c instanceof we&&(c=c.value()),il(l,function(h,g){return g.func.apply(g.thisArg,Pn([h],g.args))},c)}function El(s,l,c){var h=s.length;if(h<2)return h?$n(s[0]):[];for(var g=-1,_=O(h);++g<h;)for(var k=s[g],C=-1;++C<h;)C!=g&&(_[g]=ki(_[g]||k,s[C],l,c));return $n(st(_,1),l,c)}function qc(s,l,c){for(var h=-1,g=s.length,_=l.length,k={};++h<g;){var C=h<_?l[h]:t;c(k,s[h],C)}return k}function Dl(s){return We(s)?s:[]}function Nl(s){return typeof s=="function"?s:At}function Vn(s,l){return fe(s)?s:zl(s,l)?[s]:bf(Oe(s))}var l0=ge;function zn(s,l,c){var h=s.length;return c=c===t?h:c,!l&&c>=h?s:Gt(s,l,c)}var Hc=Gg||function(s){return it.clearTimeout(s)};function Uc(s,l){if(l)return s.slice();var c=s.length,h=dc?dc(c):new s.constructor(c);return s.copy(h),h}function Il(s){var l=new s.constructor(s.byteLength);return new vs(l).set(new vs(s)),l}function a0(s,l){var c=l?Il(s.buffer):s.buffer;return new s.constructor(c,s.byteOffset,s.byteLength)}function u0(s){var l=new s.constructor(s.source,Ou.exec(s));return l.lastIndex=s.lastIndex,l}function c0(s){return xi?De(xi.call(s)):{}}function Jc(s,l){var c=l?Il(s.buffer):s.buffer;return new s.constructor(c,s.byteOffset,s.length)}function Kc(s,l){if(s!==l){var c=s!==t,h=s===null,g=s===s,_=Bt(s),k=l!==t,C=l===null,T=l===l,I=Bt(l);if(!C&&!I&&!_&&s>l||_&&k&&T&&!C&&!I||h&&k&&T||!c&&T||!g)return 1;if(!h&&!_&&!I&&s<l||I&&c&&g&&!h&&!_||C&&c&&g||!k&&g||!T)return-1}return 0}function f0(s,l,c){for(var h=-1,g=s.criteria,_=l.criteria,k=g.length,C=c.length;++h<k;){var T=Kc(g[h],_[h]);if(T){if(h>=C)return T;var I=c[h];return T*(I=="desc"?-1:1)}}return s.index-l.index}function Gc(s,l,c,h){for(var g=-1,_=s.length,k=c.length,C=-1,T=l.length,I=Ge(_-k,0),R=O(T+I),B=!h;++C<T;)R[C]=l[C];for(;++g<k;)(B||g<_)&&(R[c[g]]=s[g]);for(;I--;)R[C++]=s[g++];return R}function Yc(s,l,c,h){for(var g=-1,_=s.length,k=-1,C=c.length,T=-1,I=l.length,R=Ge(_-C,0),B=O(R+I),q=!h;++g<R;)B[g]=s[g];for(var Q=g;++T<I;)B[Q+T]=l[T];for(;++k<C;)(q||g<_)&&(B[Q+c[k]]=s[g++]);return B}function Mt(s,l){var c=-1,h=s.length;for(l||(l=O(h));++c<h;)l[c]=s[c];return l}function fn(s,l,c,h){var g=!c;c||(c={});for(var _=-1,k=l.length;++_<k;){var C=l[_],T=h?h(c[C],s[C],C,c,s):t;T===t&&(T=s[C]),g?xn(c,C,T):_i(c,C,T)}return c}function d0(s,l){return fn(s,Vl(s),l)}function h0(s,l){return fn(s,uf(s),l)}function Is(s,l){return function(c,h){var g=fe(c)?vg:Py,_=l?l():{};return g(c,s,se(h,2),_)}}function qr(s){return ge(function(l,c){var h=-1,g=c.length,_=g>1?c[g-1]:t,k=g>2?c[2]:t;for(_=s.length>3&&typeof _=="function"?(g--,_):t,k&&yt(c[0],c[1],k)&&(_=g<3?t:_,g=1),l=De(l);++h<g;){var C=c[h];C&&s(l,C,h,_)}return l})}function jc(s,l){return function(c,h){if(c==null)return c;if(!Tt(c))return s(c,h);for(var g=c.length,_=l?g:-1,k=De(c);(l?_--:++_<g)&&h(k[_],_,k)!==!1;);return c}}function Xc(s){return function(l,c,h){for(var g=-1,_=De(l),k=h(l),C=k.length;C--;){var T=k[s?C:++g];if(c(_[T],T,_)===!1)break}return l}}function p0(s,l,c){var h=l&S,g=Ti(s);function _(){var k=this&&this!==it&&this instanceof _?g:s;return k.apply(h?c:this,arguments)}return _}function Zc(s){return function(l){l=Oe(l);var c=Lr(l)?nn(l):t,h=c?c[0]:l.charAt(0),g=c?zn(c,1).join(""):l.slice(1);return h[s]()+g}}function Hr(s){return function(l){return il(Xf(jf(l).replace(ig,"")),s,"")}}function Ti(s){return function(){var l=arguments;switch(l.length){case 0:return new s;case 1:return new s(l[0]);case 2:return new s(l[0],l[1]);case 3:return new s(l[0],l[1],l[2]);case 4:return new s(l[0],l[1],l[2],l[3]);case 5:return new s(l[0],l[1],l[2],l[3],l[4]);case 6:return new s(l[0],l[1],l[2],l[3],l[4],l[5]);case 7:return new s(l[0],l[1],l[2],l[3],l[4],l[5],l[6])}var c=Wr(s.prototype),h=s.apply(c,l);return $e(h)?h:c}}function m0(s,l,c){var h=Ti(s);function g(){for(var _=arguments.length,k=O(_),C=_,T=Ur(g);C--;)k[C]=arguments[C];var I=_<3&&k[0]!==T&&k[_-1]!==T?[]:Ln(k,T);if(_-=I.length,_<c)return rf(s,l,Rs,g.placeholder,t,k,I,t,t,c-_);var R=this&&this!==it&&this instanceof g?h:s;return Rt(R,this,k)}return g}function Qc(s){return function(l,c,h){var g=De(l);if(!Tt(l)){var _=se(c,3);l=je(l),c=function(C){return _(g[C],C,g)}}var k=s(l,c,h);return k>-1?g[_?l[k]:k]:t}}function ef(s){return kn(function(l){var c=l.length,h=c,g=Jt.prototype.thru;for(s&&l.reverse();h--;){var _=l[h];if(typeof _!="function")throw new Ut(a);if(g&&!k&&Fs(_)=="wrapper")var k=new Jt([],!0)}for(h=k?h:c;++h<c;){_=l[h];var C=Fs(_),T=C=="wrapper"?Fl(_):t;T&&Wl(T[0])&&T[1]==(G|te|ue|ee)&&!T[4].length&&T[9]==1?k=k[Fs(T[0])].apply(k,T[3]):k=_.length==1&&Wl(_)?k[C]():k.thru(_)}return function(){var I=arguments,R=I[0];if(k&&I.length==1&&fe(R))return k.plant(R).value();for(var B=0,q=c?l[B].apply(this,I):R;++B<c;)q=l[B].call(this,q);return q}})}function Rs(s,l,c,h,g,_,k,C,T,I){var R=l&G,B=l&S,q=l&E,Q=l&(te|ve),oe=l&j,pe=q?t:Ti(s);function le(){for(var be=arguments.length,_e=O(be),Ft=be;Ft--;)_e[Ft]=arguments[Ft];if(Q)var vt=Ur(le),$t=Tg(_e,vt);if(h&&(_e=Gc(_e,h,g,Q)),_&&(_e=Yc(_e,_,k,Q)),be-=$t,Q&&be<I){var qe=Ln(_e,vt);return rf(s,l,Rs,le.placeholder,c,_e,qe,C,T,I-be)}var on=B?c:this,Tn=q?on[s]:s;return be=_e.length,C?_e=P0(_e,C):oe&&be>1&&_e.reverse(),R&&T<be&&(_e.length=T),this&&this!==it&&this instanceof le&&(Tn=pe||Ti(Tn)),Tn.apply(on,_e)}return le}function tf(s,l){return function(c,h){return qy(c,s,l(h),{})}}function Ps(s,l){return function(c,h){var g;if(c===t&&h===t)return l;if(c!==t&&(g=c),h!==t){if(g===t)return h;typeof c=="string"||typeof h=="string"?(c=Lt(c),h=Lt(h)):(c=Vc(c),h=Vc(h)),g=s(c,h)}return g}}function Rl(s){return kn(function(l){return l=Fe(l,Pt(se())),ge(function(c){var h=this;return s(l,function(g){return Rt(g,h,c)})})})}function Ls(s,l){l=l===t?" ":Lt(l);var c=l.length;if(c<2)return c?Tl(l,s):l;var h=Tl(l,_s(s/Br(l)));return Lr(l)?zn(nn(h),0,s).join(""):h.slice(0,s)}function g0(s,l,c,h){var g=l&S,_=Ti(s);function k(){for(var C=-1,T=arguments.length,I=-1,R=h.length,B=O(R+T),q=this&&this!==it&&this instanceof k?_:s;++I<R;)B[I]=h[I];for(;T--;)B[I++]=arguments[++C];return Rt(q,g?c:this,B)}return k}function nf(s){return function(l,c,h){return h&&typeof h!="number"&&yt(l,c,h)&&(c=h=t),l=Mn(l),c===t?(c=l,l=0):c=Mn(c),h=h===t?l<c?1:-1:Mn(h),t0(l,c,h,s)}}function Bs(s){return function(l,c){return typeof l=="string"&&typeof c=="string"||(l=jt(l),c=jt(c)),s(l,c)}}function rf(s,l,c,h,g,_,k,C,T,I){var R=l&te,B=R?k:t,q=R?t:k,Q=R?_:t,oe=R?t:_;l|=R?ue:K,l&=~(R?K:ue),l&Z||(l&=-4);var pe=[s,l,g,Q,B,oe,q,C,T,I],le=c.apply(t,pe);return Wl(s)&&gf(le,pe),le.placeholder=h,yf(le,s,l)}function Pl(s){var l=Ke[s];return function(c,h){if(c=jt(c),h=h==null?0:ut(de(h),292),h&&gc(c)){var g=(Oe(c)+"e").split("e"),_=l(g[0]+"e"+(+g[1]+h));return g=(Oe(_)+"e").split("e"),+(g[0]+"e"+(+g[1]-h))}return l(c)}}var y0=Vr&&1/ds(new Vr([,-0]))[1]==ne?function(s){return new Vr(s)}:ra;function sf(s){return function(l){var c=ct(l);return c==Ct?fl(l):c==tn?Rg(l):Mg(l,s(l))}}function _n(s,l,c,h,g,_,k,C){var T=l&E;if(!T&&typeof s!="function")throw new Ut(a);var I=h?h.length:0;if(I||(l&=-97,h=g=t),k=k===t?k:Ge(de(k),0),C=C===t?C:de(C),I-=g?g.length:0,l&K){var R=h,B=g;h=g=t}var q=T?t:Fl(s),Q=[s,l,c,h,g,R,B,_,k,C];if(q&&N0(Q,q),s=Q[0],l=Q[1],c=Q[2],h=Q[3],g=Q[4],C=Q[9]=Q[9]===t?T?0:s.length:Ge(Q[9]-I,0),!C&&l&(te|ve)&&(l&=-25),!l||l==S)var oe=p0(s,l,c);else l==te||l==ve?oe=m0(s,l,C):(l==ue||l==(S|ue))&&!g.length?oe=g0(s,l,c,h):oe=Rs.apply(t,Q);var pe=q?Fc:gf;return yf(pe(oe,Q),s,l)}function of(s,l,c,h){return s===t||sn(s,$r[c])&&!Ee.call(h,c)?l:s}function lf(s,l,c,h,g,_){return $e(s)&&$e(l)&&(_.set(l,s),Es(s,l,t,lf,_),_.delete(l)),s}function v0(s){return Ei(s)?t:s}function af(s,l,c,h,g,_){var k=c&x,C=s.length,T=l.length;if(C!=T&&!(k&&T>C))return!1;var I=_.get(s),R=_.get(l);if(I&&R)return I==l&&R==s;var B=-1,q=!0,Q=c&b?new fr:t;for(_.set(s,l),_.set(l,s);++B<C;){var oe=s[B],pe=l[B];if(h)var le=k?h(pe,oe,B,l,s,_):h(oe,pe,B,s,l,_);if(le!==t){if(le)continue;q=!1;break}if(Q){if(!sl(l,function(be,_e){if(!gi(Q,_e)&&(oe===be||g(oe,be,c,h,_)))return Q.push(_e)})){q=!1;break}}else if(!(oe===pe||g(oe,pe,c,h,_))){q=!1;break}}return _.delete(s),_.delete(l),q}function b0(s,l,c,h,g,_,k){switch(c){case Ir:if(s.byteLength!=l.byteLength||s.byteOffset!=l.byteOffset)return!1;s=s.buffer,l=l.buffer;case mi:return!(s.byteLength!=l.byteLength||!_(new vs(s),new vs(l)));case rt:case In:case un:return sn(+s,+l);case lr:return s.name==l.name&&s.message==l.message;case di:case hi:return s==l+"";case Ct:var C=fl;case tn:var T=h&x;if(C||(C=ds),s.size!=l.size&&!T)return!1;var I=k.get(s);if(I)return I==l;h|=b,k.set(s,l);var R=af(C(s),C(l),h,g,_,k);return k.delete(s),R;case ss:if(xi)return xi.call(s)==xi.call(l)}return!1}function w0(s,l,c,h,g,_){var k=c&x,C=Ll(s),T=C.length,I=Ll(l),R=I.length;if(T!=R&&!k)return!1;for(var B=T;B--;){var q=C[B];if(!(k?q in l:Ee.call(l,q)))return!1}var Q=_.get(s),oe=_.get(l);if(Q&&oe)return Q==l&&oe==s;var pe=!0;_.set(s,l),_.set(l,s);for(var le=k;++B<T;){q=C[B];var be=s[q],_e=l[q];if(h)var Ft=k?h(_e,be,q,l,s,_):h(be,_e,q,s,l,_);if(!(Ft===t?be===_e||g(be,_e,c,h,_):Ft)){pe=!1;break}le||(le=q=="constructor")}if(pe&&!le){var vt=s.constructor,$t=l.constructor;vt!=$t&&"constructor"in s&&"constructor"in l&&!(typeof vt=="function"&&vt instanceof vt&&typeof $t=="function"&&$t instanceof $t)&&(pe=!1)}return _.delete(s),_.delete(l),pe}function kn(s){return Hl(pf(s,t,kf),s+"")}function Ll(s){return Tc(s,je,Vl)}function Bl(s){return Tc(s,Ot,uf)}var Fl=Ss?function(s){return Ss.get(s)}:ra;function Fs(s){for(var l=s.name+"",c=zr[l],h=Ee.call(zr,l)?c.length:0;h--;){var g=c[h],_=g.func;if(_==null||_==s)return g.name}return l}function Ur(s){var l=Ee.call(w,"placeholder")?w:s;return l.placeholder}function se(){var s=w.iteratee||ta;return s=s===ta?Ec:s,arguments.length?s(arguments[0],arguments[1]):s}function $s(s,l){var c=s.__data__;return O0(l)?c[typeof l=="string"?"string":"hash"]:c.map}function $l(s){for(var l=je(s),c=l.length;c--;){var h=l[c],g=s[h];l[c]=[h,g,df(g)]}return l}function pr(s,l){var c=Dg(s,l);return Ac(c)?c:t}function x0(s){var l=Ee.call(s,ur),c=s[ur];try{s[ur]=t;var h=!0}catch{}var g=gs.call(s);return h&&(l?s[ur]=c:delete s[ur]),g}var Vl=hl?function(s){return s==null?[]:(s=De(s),Rn(hl(s),function(l){return pc.call(s,l)}))}:ia,uf=hl?function(s){for(var l=[];s;)Pn(l,Vl(s)),s=bs(s);return l}:ia,ct=gt;(pl&&ct(new pl(new ArrayBuffer(1)))!=Ir||vi&&ct(new vi)!=Ct||ml&&ct(ml.resolve())!=Su||Vr&&ct(new Vr)!=tn||bi&&ct(new bi)!=pi)&&(ct=function(s){var l=gt(s),c=l==vn?s.constructor:t,h=c?mr(c):"";if(h)switch(h){case ry:return Ir;case iy:return Ct;case sy:return Su;case oy:return tn;case ly:return pi}return l});function _0(s,l,c){for(var h=-1,g=c.length;++h<g;){var _=c[h],k=_.size;switch(_.type){case"drop":s+=k;break;case"dropRight":l-=k;break;case"take":l=ut(l,s+k);break;case"takeRight":s=Ge(s,l-k);break}}return{start:s,end:l}}function k0(s){var l=s.match(Am);return l?l[1].split(Em):[]}function cf(s,l,c){l=Vn(l,s);for(var h=-1,g=l.length,_=!1;++h<g;){var k=dn(l[h]);if(!(_=s!=null&&c(s,k)))break;s=s[k]}return _||++h!=g?_:(g=s==null?0:s.length,!!g&&Js(g)&&Sn(k,g)&&(fe(s)||gr(s)))}function S0(s){var l=s.length,c=new s.constructor(l);return l&&typeof s[0]=="string"&&Ee.call(s,"index")&&(c.index=s.index,c.input=s.input),c}function ff(s){return typeof s.constructor=="function"&&!Oi(s)?Wr(bs(s)):{}}function C0(s,l,c){var h=s.constructor;switch(l){case mi:return Il(s);case rt:case In:return new h(+s);case Ir:return a0(s,c);case $o:case Vo:case zo:case Wo:case qo:case Ho:case Uo:case Jo:case Ko:return Jc(s,c);case Ct:return new h;case un:case hi:return new h(s);case di:return u0(s);case tn:return new h;case ss:return c0(s)}}function M0(s,l){var c=l.length;if(!c)return s;var h=c-1;return l[h]=(c>1?"& ":"")+l[h],l=l.join(c>2?", ":" "),s.replace(Om,`{
/* [wrapped with `+l+`] */
`)}function T0(s){return fe(s)||gr(s)||!!(mc&&s&&s[mc])}function Sn(s,l){var c=typeof s;return l=l??J,!!l&&(c=="number"||c!="symbol"&&$m.test(s))&&s>-1&&s%1==0&&s<l}function yt(s,l,c){if(!$e(c))return!1;var h=typeof l;return(h=="number"?Tt(c)&&Sn(l,c.length):h=="string"&&l in c)?sn(c[l],s):!1}function zl(s,l){if(fe(s))return!1;var c=typeof s;return c=="number"||c=="symbol"||c=="boolean"||s==null||Bt(s)?!0:Sm.test(s)||!km.test(s)||l!=null&&s in De(l)}function O0(s){var l=typeof s;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?s!=="__proto__":s===null}function Wl(s){var l=Fs(s),c=w[l];if(typeof c!="function"||!(l in we.prototype))return!1;if(s===c)return!0;var h=Fl(c);return!!h&&s===h[0]}function A0(s){return!!fc&&fc in s}var E0=ps?Cn:sa;function Oi(s){var l=s&&s.constructor,c=typeof l=="function"&&l.prototype||$r;return s===c}function df(s){return s===s&&!$e(s)}function hf(s,l){return function(c){return c==null?!1:c[s]===l&&(l!==t||s in De(c))}}function D0(s){var l=Hs(s,function(h){return c.size===d&&c.clear(),h}),c=l.cache;return l}function N0(s,l){var c=s[1],h=l[1],g=c|h,_=g<(S|E|G),k=h==G&&c==te||h==G&&c==ee&&s[7].length<=l[8]||h==(G|ee)&&l[7].length<=l[8]&&c==te;if(!(_||k))return s;h&S&&(s[2]=l[2],g|=c&S?0:Z);var C=l[3];if(C){var T=s[3];s[3]=T?Gc(T,C,l[4]):C,s[4]=T?Ln(s[3],p):l[4]}return C=l[5],C&&(T=s[5],s[5]=T?Yc(T,C,l[6]):C,s[6]=T?Ln(s[5],p):l[6]),C=l[7],C&&(s[7]=C),h&G&&(s[8]=s[8]==null?l[8]:ut(s[8],l[8])),s[9]==null&&(s[9]=l[9]),s[0]=l[0],s[1]=g,s}function I0(s){var l=[];if(s!=null)for(var c in De(s))l.push(c);return l}function R0(s){return gs.call(s)}function pf(s,l,c){return l=Ge(l===t?s.length-1:l,0),function(){for(var h=arguments,g=-1,_=Ge(h.length-l,0),k=O(_);++g<_;)k[g]=h[l+g];g=-1;for(var C=O(l+1);++g<l;)C[g]=h[g];return C[l]=c(k),Rt(s,this,C)}}function mf(s,l){return l.length<2?s:hr(s,Gt(l,0,-1))}function P0(s,l){for(var c=s.length,h=ut(l.length,c),g=Mt(s);h--;){var _=l[h];s[h]=Sn(_,c)?g[_]:t}return s}function ql(s,l){if(!(l==="constructor"&&typeof s[l]=="function")&&l!="__proto__")return s[l]}var gf=vf(Fc),Ai=jg||function(s,l){return it.setTimeout(s,l)},Hl=vf(i0);function yf(s,l,c){var h=l+"";return Hl(s,M0(h,L0(k0(h),c)))}function vf(s){var l=0,c=0;return function(){var h=ey(),g=St-(h-c);if(c=h,g>0){if(++l>=nt)return arguments[0]}else l=0;return s.apply(t,arguments)}}function Vs(s,l){var c=-1,h=s.length,g=h-1;for(l=l===t?h:l;++c<l;){var _=Ml(c,g),k=s[_];s[_]=s[c],s[c]=k}return s.length=l,s}var bf=D0(function(s){var l=[];return s.charCodeAt(0)===46&&l.push(""),s.replace(Cm,function(c,h,g,_){l.push(g?_.replace(Im,"$1"):h||c)}),l});function dn(s){if(typeof s=="string"||Bt(s))return s;var l=s+"";return l=="0"&&1/s==-1/0?"-0":l}function mr(s){if(s!=null){try{return ms.call(s)}catch{}try{return s+""}catch{}}return""}function L0(s,l){return Ht(z,function(c){var h="_."+c[0];l&c[1]&&!cs(s,h)&&s.push(h)}),s.sort()}function wf(s){if(s instanceof we)return s.clone();var l=new Jt(s.__wrapped__,s.__chain__);return l.__actions__=Mt(s.__actions__),l.__index__=s.__index__,l.__values__=s.__values__,l}function B0(s,l,c){(c?yt(s,l,c):l===t)?l=1:l=Ge(de(l),0);var h=s==null?0:s.length;if(!h||l<1)return[];for(var g=0,_=0,k=O(_s(h/l));g<h;)k[_++]=Gt(s,g,g+=l);return k}function F0(s){for(var l=-1,c=s==null?0:s.length,h=0,g=[];++l<c;){var _=s[l];_&&(g[h++]=_)}return g}function $0(){var s=arguments.length;if(!s)return[];for(var l=O(s-1),c=arguments[0],h=s;h--;)l[h-1]=arguments[h];return Pn(fe(c)?Mt(c):[c],st(l,1))}var V0=ge(function(s,l){return We(s)?ki(s,st(l,1,We,!0)):[]}),z0=ge(function(s,l){var c=Yt(l);return We(c)&&(c=t),We(s)?ki(s,st(l,1,We,!0),se(c,2)):[]}),W0=ge(function(s,l){var c=Yt(l);return We(c)&&(c=t),We(s)?ki(s,st(l,1,We,!0),t,c):[]});function q0(s,l,c){var h=s==null?0:s.length;return h?(l=c||l===t?1:de(l),Gt(s,l<0?0:l,h)):[]}function H0(s,l,c){var h=s==null?0:s.length;return h?(l=c||l===t?1:de(l),l=h-l,Gt(s,0,l<0?0:l)):[]}function U0(s,l){return s&&s.length?Ns(s,se(l,3),!0,!0):[]}function J0(s,l){return s&&s.length?Ns(s,se(l,3),!0):[]}function K0(s,l,c,h){var g=s==null?0:s.length;return g?(c&&typeof c!="number"&&yt(s,l,c)&&(c=0,h=g),$y(s,l,c,h)):[]}function xf(s,l,c){var h=s==null?0:s.length;if(!h)return-1;var g=c==null?0:de(c);return g<0&&(g=Ge(h+g,0)),fs(s,se(l,3),g)}function _f(s,l,c){var h=s==null?0:s.length;if(!h)return-1;var g=h-1;return c!==t&&(g=de(c),g=c<0?Ge(h+g,0):ut(g,h-1)),fs(s,se(l,3),g,!0)}function kf(s){var l=s==null?0:s.length;return l?st(s,1):[]}function G0(s){var l=s==null?0:s.length;return l?st(s,ne):[]}function Y0(s,l){var c=s==null?0:s.length;return c?(l=l===t?1:de(l),st(s,l)):[]}function j0(s){for(var l=-1,c=s==null?0:s.length,h={};++l<c;){var g=s[l];h[g[0]]=g[1]}return h}function Sf(s){return s&&s.length?s[0]:t}function X0(s,l,c){var h=s==null?0:s.length;if(!h)return-1;var g=c==null?0:de(c);return g<0&&(g=Ge(h+g,0)),Pr(s,l,g)}function Z0(s){var l=s==null?0:s.length;return l?Gt(s,0,-1):[]}var Q0=ge(function(s){var l=Fe(s,Dl);return l.length&&l[0]===s[0]?xl(l):[]}),e1=ge(function(s){var l=Yt(s),c=Fe(s,Dl);return l===Yt(c)?l=t:c.pop(),c.length&&c[0]===s[0]?xl(c,se(l,2)):[]}),t1=ge(function(s){var l=Yt(s),c=Fe(s,Dl);return l=typeof l=="function"?l:t,l&&c.pop(),c.length&&c[0]===s[0]?xl(c,t,l):[]});function n1(s,l){return s==null?"":Zg.call(s,l)}function Yt(s){var l=s==null?0:s.length;return l?s[l-1]:t}function r1(s,l,c){var h=s==null?0:s.length;if(!h)return-1;var g=h;return c!==t&&(g=de(c),g=g<0?Ge(h+g,0):ut(g,h-1)),l===l?Lg(s,l,g):fs(s,rc,g,!0)}function i1(s,l){return s&&s.length?Rc(s,de(l)):t}var s1=ge(Cf);function Cf(s,l){return s&&s.length&&l&&l.length?Cl(s,l):s}function o1(s,l,c){return s&&s.length&&l&&l.length?Cl(s,l,se(c,2)):s}function l1(s,l,c){return s&&s.length&&l&&l.length?Cl(s,l,t,c):s}var a1=kn(function(s,l){var c=s==null?0:s.length,h=yl(s,l);return Bc(s,Fe(l,function(g){return Sn(g,c)?+g:g}).sort(Kc)),h});function u1(s,l){var c=[];if(!(s&&s.length))return c;var h=-1,g=[],_=s.length;for(l=se(l,3);++h<_;){var k=s[h];l(k,h,s)&&(c.push(k),g.push(h))}return Bc(s,g),c}function Ul(s){return s==null?s:ny.call(s)}function c1(s,l,c){var h=s==null?0:s.length;return h?(c&&typeof c!="number"&&yt(s,l,c)?(l=0,c=h):(l=l==null?0:de(l),c=c===t?h:de(c)),Gt(s,l,c)):[]}function f1(s,l){return Ds(s,l)}function d1(s,l,c){return Ol(s,l,se(c,2))}function h1(s,l){var c=s==null?0:s.length;if(c){var h=Ds(s,l);if(h<c&&sn(s[h],l))return h}return-1}function p1(s,l){return Ds(s,l,!0)}function m1(s,l,c){return Ol(s,l,se(c,2),!0)}function g1(s,l){var c=s==null?0:s.length;if(c){var h=Ds(s,l,!0)-1;if(sn(s[h],l))return h}return-1}function y1(s){return s&&s.length?$c(s):[]}function v1(s,l){return s&&s.length?$c(s,se(l,2)):[]}function b1(s){var l=s==null?0:s.length;return l?Gt(s,1,l):[]}function w1(s,l,c){return s&&s.length?(l=c||l===t?1:de(l),Gt(s,0,l<0?0:l)):[]}function x1(s,l,c){var h=s==null?0:s.length;return h?(l=c||l===t?1:de(l),l=h-l,Gt(s,l<0?0:l,h)):[]}function _1(s,l){return s&&s.length?Ns(s,se(l,3),!1,!0):[]}function k1(s,l){return s&&s.length?Ns(s,se(l,3)):[]}var S1=ge(function(s){return $n(st(s,1,We,!0))}),C1=ge(function(s){var l=Yt(s);return We(l)&&(l=t),$n(st(s,1,We,!0),se(l,2))}),M1=ge(function(s){var l=Yt(s);return l=typeof l=="function"?l:t,$n(st(s,1,We,!0),t,l)});function T1(s){return s&&s.length?$n(s):[]}function O1(s,l){return s&&s.length?$n(s,se(l,2)):[]}function A1(s,l){return l=typeof l=="function"?l:t,s&&s.length?$n(s,t,l):[]}function Jl(s){if(!(s&&s.length))return[];var l=0;return s=Rn(s,function(c){if(We(c))return l=Ge(c.length,l),!0}),ul(l,function(c){return Fe(s,ol(c))})}function Mf(s,l){if(!(s&&s.length))return[];var c=Jl(s);return l==null?c:Fe(c,function(h){return Rt(l,t,h)})}var E1=ge(function(s,l){return We(s)?ki(s,l):[]}),D1=ge(function(s){return El(Rn(s,We))}),N1=ge(function(s){var l=Yt(s);return We(l)&&(l=t),El(Rn(s,We),se(l,2))}),I1=ge(function(s){var l=Yt(s);return l=typeof l=="function"?l:t,El(Rn(s,We),t,l)}),R1=ge(Jl);function P1(s,l){return qc(s||[],l||[],_i)}function L1(s,l){return qc(s||[],l||[],Mi)}var B1=ge(function(s){var l=s.length,c=l>1?s[l-1]:t;return c=typeof c=="function"?(s.pop(),c):t,Mf(s,c)});function Tf(s){var l=w(s);return l.__chain__=!0,l}function F1(s,l){return l(s),s}function zs(s,l){return l(s)}var $1=kn(function(s){var l=s.length,c=l?s[0]:0,h=this.__wrapped__,g=function(_){return yl(_,s)};return l>1||this.__actions__.length||!(h instanceof we)||!Sn(c)?this.thru(g):(h=h.slice(c,+c+(l?1:0)),h.__actions__.push({func:zs,args:[g],thisArg:t}),new Jt(h,this.__chain__).thru(function(_){return l&&!_.length&&_.push(t),_}))});function V1(){return Tf(this)}function z1(){return new Jt(this.value(),this.__chain__)}function W1(){this.__values__===t&&(this.__values__=zf(this.value()));var s=this.__index__>=this.__values__.length,l=s?t:this.__values__[this.__index__++];return{done:s,value:l}}function q1(){return this}function H1(s){for(var l,c=this;c instanceof Ms;){var h=wf(c);h.__index__=0,h.__values__=t,l?g.__wrapped__=h:l=h;var g=h;c=c.__wrapped__}return g.__wrapped__=s,l}function U1(){var s=this.__wrapped__;if(s instanceof we){var l=s;return this.__actions__.length&&(l=new we(this)),l=l.reverse(),l.__actions__.push({func:zs,args:[Ul],thisArg:t}),new Jt(l,this.__chain__)}return this.thru(Ul)}function J1(){return Wc(this.__wrapped__,this.__actions__)}var K1=Is(function(s,l,c){Ee.call(s,c)?++s[c]:xn(s,c,1)});function G1(s,l,c){var h=fe(s)?tc:Fy;return c&&yt(s,l,c)&&(l=t),h(s,se(l,3))}function Y1(s,l){var c=fe(s)?Rn:Cc;return c(s,se(l,3))}var j1=Qc(xf),X1=Qc(_f);function Z1(s,l){return st(Ws(s,l),1)}function Q1(s,l){return st(Ws(s,l),ne)}function ev(s,l,c){return c=c===t?1:de(c),st(Ws(s,l),c)}function Of(s,l){var c=fe(s)?Ht:Fn;return c(s,se(l,3))}function Af(s,l){var c=fe(s)?bg:Sc;return c(s,se(l,3))}var tv=Is(function(s,l,c){Ee.call(s,c)?s[c].push(l):xn(s,c,[l])});function nv(s,l,c,h){s=Tt(s)?s:Kr(s),c=c&&!h?de(c):0;var g=s.length;return c<0&&(c=Ge(g+c,0)),Ks(s)?c<=g&&s.indexOf(l,c)>-1:!!g&&Pr(s,l,c)>-1}var rv=ge(function(s,l,c){var h=-1,g=typeof l=="function",_=Tt(s)?O(s.length):[];return Fn(s,function(k){_[++h]=g?Rt(l,k,c):Si(k,l,c)}),_}),iv=Is(function(s,l,c){xn(s,c,l)});function Ws(s,l){var c=fe(s)?Fe:Dc;return c(s,se(l,3))}function sv(s,l,c,h){return s==null?[]:(fe(l)||(l=l==null?[]:[l]),c=h?t:c,fe(c)||(c=c==null?[]:[c]),Pc(s,l,c))}var ov=Is(function(s,l,c){s[c?0:1].push(l)},function(){return[[],[]]});function lv(s,l,c){var h=fe(s)?il:sc,g=arguments.length<3;return h(s,se(l,4),c,g,Fn)}function av(s,l,c){var h=fe(s)?wg:sc,g=arguments.length<3;return h(s,se(l,4),c,g,Sc)}function uv(s,l){var c=fe(s)?Rn:Cc;return c(s,Us(se(l,3)))}function cv(s){var l=fe(s)?wc:n0;return l(s)}function fv(s,l,c){(c?yt(s,l,c):l===t)?l=1:l=de(l);var h=fe(s)?Iy:r0;return h(s,l)}function dv(s){var l=fe(s)?Ry:s0;return l(s)}function hv(s){if(s==null)return 0;if(Tt(s))return Ks(s)?Br(s):s.length;var l=ct(s);return l==Ct||l==tn?s.size:kl(s).length}function pv(s,l,c){var h=fe(s)?sl:o0;return c&&yt(s,l,c)&&(l=t),h(s,se(l,3))}var mv=ge(function(s,l){if(s==null)return[];var c=l.length;return c>1&&yt(s,l[0],l[1])?l=[]:c>2&&yt(l[0],l[1],l[2])&&(l=[l[0]]),Pc(s,st(l,1),[])}),qs=Yg||function(){return it.Date.now()};function gv(s,l){if(typeof l!="function")throw new Ut(a);return s=de(s),function(){if(--s<1)return l.apply(this,arguments)}}function Ef(s,l,c){return l=c?t:l,l=s&&l==null?s.length:l,_n(s,G,t,t,t,t,l)}function Df(s,l){var c;if(typeof l!="function")throw new Ut(a);return s=de(s),function(){return--s>0&&(c=l.apply(this,arguments)),s<=1&&(l=t),c}}var Kl=ge(function(s,l,c){var h=S;if(c.length){var g=Ln(c,Ur(Kl));h|=ue}return _n(s,h,l,c,g)}),Nf=ge(function(s,l,c){var h=S|E;if(c.length){var g=Ln(c,Ur(Nf));h|=ue}return _n(l,h,s,c,g)});function If(s,l,c){l=c?t:l;var h=_n(s,te,t,t,t,t,t,l);return h.placeholder=If.placeholder,h}function Rf(s,l,c){l=c?t:l;var h=_n(s,ve,t,t,t,t,t,l);return h.placeholder=Rf.placeholder,h}function Pf(s,l,c){var h,g,_,k,C,T,I=0,R=!1,B=!1,q=!0;if(typeof s!="function")throw new Ut(a);l=jt(l)||0,$e(c)&&(R=!!c.leading,B="maxWait"in c,_=B?Ge(jt(c.maxWait)||0,l):_,q="trailing"in c?!!c.trailing:q);function Q(qe){var on=h,Tn=g;return h=g=t,I=qe,k=s.apply(Tn,on),k}function oe(qe){return I=qe,C=Ai(be,l),R?Q(qe):k}function pe(qe){var on=qe-T,Tn=qe-I,ed=l-on;return B?ut(ed,_-Tn):ed}function le(qe){var on=qe-T,Tn=qe-I;return T===t||on>=l||on<0||B&&Tn>=_}function be(){var qe=qs();if(le(qe))return _e(qe);C=Ai(be,pe(qe))}function _e(qe){return C=t,q&&h?Q(qe):(h=g=t,k)}function Ft(){C!==t&&Hc(C),I=0,h=T=g=C=t}function vt(){return C===t?k:_e(qs())}function $t(){var qe=qs(),on=le(qe);if(h=arguments,g=this,T=qe,on){if(C===t)return oe(T);if(B)return Hc(C),C=Ai(be,l),Q(T)}return C===t&&(C=Ai(be,l)),k}return $t.cancel=Ft,$t.flush=vt,$t}var yv=ge(function(s,l){return kc(s,1,l)}),vv=ge(function(s,l,c){return kc(s,jt(l)||0,c)});function bv(s){return _n(s,j)}function Hs(s,l){if(typeof s!="function"||l!=null&&typeof l!="function")throw new Ut(a);var c=function(){var h=arguments,g=l?l.apply(this,h):h[0],_=c.cache;if(_.has(g))return _.get(g);var k=s.apply(this,h);return c.cache=_.set(g,k)||_,k};return c.cache=new(Hs.Cache||wn),c}Hs.Cache=wn;function Us(s){if(typeof s!="function")throw new Ut(a);return function(){var l=arguments;switch(l.length){case 0:return!s.call(this);case 1:return!s.call(this,l[0]);case 2:return!s.call(this,l[0],l[1]);case 3:return!s.call(this,l[0],l[1],l[2])}return!s.apply(this,l)}}function wv(s){return Df(2,s)}var xv=l0(function(s,l){l=l.length==1&&fe(l[0])?Fe(l[0],Pt(se())):Fe(st(l,1),Pt(se()));var c=l.length;return ge(function(h){for(var g=-1,_=ut(h.length,c);++g<_;)h[g]=l[g].call(this,h[g]);return Rt(s,this,h)})}),Gl=ge(function(s,l){var c=Ln(l,Ur(Gl));return _n(s,ue,t,l,c)}),Lf=ge(function(s,l){var c=Ln(l,Ur(Lf));return _n(s,K,t,l,c)}),_v=kn(function(s,l){return _n(s,ee,t,t,t,l)});function kv(s,l){if(typeof s!="function")throw new Ut(a);return l=l===t?l:de(l),ge(s,l)}function Sv(s,l){if(typeof s!="function")throw new Ut(a);return l=l==null?0:Ge(de(l),0),ge(function(c){var h=c[l],g=zn(c,0,l);return h&&Pn(g,h),Rt(s,this,g)})}function Cv(s,l,c){var h=!0,g=!0;if(typeof s!="function")throw new Ut(a);return $e(c)&&(h="leading"in c?!!c.leading:h,g="trailing"in c?!!c.trailing:g),Pf(s,l,{leading:h,maxWait:l,trailing:g})}function Mv(s){return Ef(s,1)}function Tv(s,l){return Gl(Nl(l),s)}function Ov(){if(!arguments.length)return[];var s=arguments[0];return fe(s)?s:[s]}function Av(s){return Kt(s,v)}function Ev(s,l){return l=typeof l=="function"?l:t,Kt(s,v,l)}function Dv(s){return Kt(s,m|v)}function Nv(s,l){return l=typeof l=="function"?l:t,Kt(s,m|v,l)}function Iv(s,l){return l==null||_c(s,l,je(l))}function sn(s,l){return s===l||s!==s&&l!==l}var Rv=Bs(wl),Pv=Bs(function(s,l){return s>=l}),gr=Oc(function(){return arguments}())?Oc:function(s){return Ve(s)&&Ee.call(s,"callee")&&!pc.call(s,"callee")},fe=O.isArray,Lv=Yu?Pt(Yu):Hy;function Tt(s){return s!=null&&Js(s.length)&&!Cn(s)}function We(s){return Ve(s)&&Tt(s)}function Bv(s){return s===!0||s===!1||Ve(s)&&gt(s)==rt}var Wn=Xg||sa,Fv=ju?Pt(ju):Uy;function $v(s){return Ve(s)&&s.nodeType===1&&!Ei(s)}function Vv(s){if(s==null)return!0;if(Tt(s)&&(fe(s)||typeof s=="string"||typeof s.splice=="function"||Wn(s)||Jr(s)||gr(s)))return!s.length;var l=ct(s);if(l==Ct||l==tn)return!s.size;if(Oi(s))return!kl(s).length;for(var c in s)if(Ee.call(s,c))return!1;return!0}function zv(s,l){return Ci(s,l)}function Wv(s,l,c){c=typeof c=="function"?c:t;var h=c?c(s,l):t;return h===t?Ci(s,l,t,c):!!h}function Yl(s){if(!Ve(s))return!1;var l=gt(s);return l==lr||l==rs||typeof s.message=="string"&&typeof s.name=="string"&&!Ei(s)}function qv(s){return typeof s=="number"&&gc(s)}function Cn(s){if(!$e(s))return!1;var l=gt(s);return l==Je||l==is||l==Ae||l==hm}function Bf(s){return typeof s=="number"&&s==de(s)}function Js(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=J}function $e(s){var l=typeof s;return s!=null&&(l=="object"||l=="function")}function Ve(s){return s!=null&&typeof s=="object"}var Ff=Xu?Pt(Xu):Ky;function Hv(s,l){return s===l||_l(s,l,$l(l))}function Uv(s,l,c){return c=typeof c=="function"?c:t,_l(s,l,$l(l),c)}function Jv(s){return $f(s)&&s!=+s}function Kv(s){if(E0(s))throw new ce(o);return Ac(s)}function Gv(s){return s===null}function Yv(s){return s==null}function $f(s){return typeof s=="number"||Ve(s)&&gt(s)==un}function Ei(s){if(!Ve(s)||gt(s)!=vn)return!1;var l=bs(s);if(l===null)return!0;var c=Ee.call(l,"constructor")&&l.constructor;return typeof c=="function"&&c instanceof c&&ms.call(c)==Ug}var jl=Zu?Pt(Zu):Gy;function jv(s){return Bf(s)&&s>=-9007199254740991&&s<=J}var Vf=Qu?Pt(Qu):Yy;function Ks(s){return typeof s=="string"||!fe(s)&&Ve(s)&&gt(s)==hi}function Bt(s){return typeof s=="symbol"||Ve(s)&&gt(s)==ss}var Jr=ec?Pt(ec):jy;function Xv(s){return s===t}function Zv(s){return Ve(s)&&ct(s)==pi}function Qv(s){return Ve(s)&&gt(s)==mm}var eb=Bs(Sl),tb=Bs(function(s,l){return s<=l});function zf(s){if(!s)return[];if(Tt(s))return Ks(s)?nn(s):Mt(s);if(yi&&s[yi])return Ig(s[yi]());var l=ct(s),c=l==Ct?fl:l==tn?ds:Kr;return c(s)}function Mn(s){if(!s)return s===0?s:0;if(s=jt(s),s===ne||s===-1/0){var l=s<0?-1:1;return l*xe}return s===s?s:0}function de(s){var l=Mn(s),c=l%1;return l===l?c?l-c:l:0}function Wf(s){return s?dr(de(s),0,V):0}function jt(s){if(typeof s=="number")return s;if(Bt(s))return F;if($e(s)){var l=typeof s.valueOf=="function"?s.valueOf():s;s=$e(l)?l+"":l}if(typeof s!="string")return s===0?s:+s;s=oc(s);var c=Lm.test(s);return c||Fm.test(s)?gg(s.slice(2),c?2:8):Pm.test(s)?F:+s}function qf(s){return fn(s,Ot(s))}function nb(s){return s?dr(de(s),-9007199254740991,J):s===0?s:0}function Oe(s){return s==null?"":Lt(s)}var rb=qr(function(s,l){if(Oi(l)||Tt(l)){fn(l,je(l),s);return}for(var c in l)Ee.call(l,c)&&_i(s,c,l[c])}),Hf=qr(function(s,l){fn(l,Ot(l),s)}),Gs=qr(function(s,l,c,h){fn(l,Ot(l),s,h)}),ib=qr(function(s,l,c,h){fn(l,je(l),s,h)}),sb=kn(yl);function ob(s,l){var c=Wr(s);return l==null?c:xc(c,l)}var lb=ge(function(s,l){s=De(s);var c=-1,h=l.length,g=h>2?l[2]:t;for(g&&yt(l[0],l[1],g)&&(h=1);++c<h;)for(var _=l[c],k=Ot(_),C=-1,T=k.length;++C<T;){var I=k[C],R=s[I];(R===t||sn(R,$r[I])&&!Ee.call(s,I))&&(s[I]=_[I])}return s}),ab=ge(function(s){return s.push(t,lf),Rt(Uf,t,s)});function ub(s,l){return nc(s,se(l,3),cn)}function cb(s,l){return nc(s,se(l,3),bl)}function fb(s,l){return s==null?s:vl(s,se(l,3),Ot)}function db(s,l){return s==null?s:Mc(s,se(l,3),Ot)}function hb(s,l){return s&&cn(s,se(l,3))}function pb(s,l){return s&&bl(s,se(l,3))}function mb(s){return s==null?[]:As(s,je(s))}function gb(s){return s==null?[]:As(s,Ot(s))}function Xl(s,l,c){var h=s==null?t:hr(s,l);return h===t?c:h}function yb(s,l){return s!=null&&cf(s,l,Vy)}function Zl(s,l){return s!=null&&cf(s,l,zy)}var vb=tf(function(s,l,c){l!=null&&typeof l.toString!="function"&&(l=gs.call(l)),s[l]=c},ea(At)),bb=tf(function(s,l,c){l!=null&&typeof l.toString!="function"&&(l=gs.call(l)),Ee.call(s,l)?s[l].push(c):s[l]=[c]},se),wb=ge(Si);function je(s){return Tt(s)?bc(s):kl(s)}function Ot(s){return Tt(s)?bc(s,!0):Xy(s)}function xb(s,l){var c={};return l=se(l,3),cn(s,function(h,g,_){xn(c,l(h,g,_),h)}),c}function _b(s,l){var c={};return l=se(l,3),cn(s,function(h,g,_){xn(c,g,l(h,g,_))}),c}var kb=qr(function(s,l,c){Es(s,l,c)}),Uf=qr(function(s,l,c,h){Es(s,l,c,h)}),Sb=kn(function(s,l){var c={};if(s==null)return c;var h=!1;l=Fe(l,function(_){return _=Vn(_,s),h||(h=_.length>1),_}),fn(s,Bl(s),c),h&&(c=Kt(c,m|y|v,v0));for(var g=l.length;g--;)Al(c,l[g]);return c});function Cb(s,l){return Jf(s,Us(se(l)))}var Mb=kn(function(s,l){return s==null?{}:Qy(s,l)});function Jf(s,l){if(s==null)return{};var c=Fe(Bl(s),function(h){return[h]});return l=se(l),Lc(s,c,function(h,g){return l(h,g[0])})}function Tb(s,l,c){l=Vn(l,s);var h=-1,g=l.length;for(g||(g=1,s=t);++h<g;){var _=s==null?t:s[dn(l[h])];_===t&&(h=g,_=c),s=Cn(_)?_.call(s):_}return s}function Ob(s,l,c){return s==null?s:Mi(s,l,c)}function Ab(s,l,c,h){return h=typeof h=="function"?h:t,s==null?s:Mi(s,l,c,h)}var Kf=sf(je),Gf=sf(Ot);function Eb(s,l,c){var h=fe(s),g=h||Wn(s)||Jr(s);if(l=se(l,4),c==null){var _=s&&s.constructor;g?c=h?new _:[]:$e(s)?c=Cn(_)?Wr(bs(s)):{}:c={}}return(g?Ht:cn)(s,function(k,C,T){return l(c,k,C,T)}),c}function Db(s,l){return s==null?!0:Al(s,l)}function Nb(s,l,c){return s==null?s:zc(s,l,Nl(c))}function Ib(s,l,c,h){return h=typeof h=="function"?h:t,s==null?s:zc(s,l,Nl(c),h)}function Kr(s){return s==null?[]:cl(s,je(s))}function Rb(s){return s==null?[]:cl(s,Ot(s))}function Pb(s,l,c){return c===t&&(c=l,l=t),c!==t&&(c=jt(c),c=c===c?c:0),l!==t&&(l=jt(l),l=l===l?l:0),dr(jt(s),l,c)}function Lb(s,l,c){return l=Mn(l),c===t?(c=l,l=0):c=Mn(c),s=jt(s),Wy(s,l,c)}function Bb(s,l,c){if(c&&typeof c!="boolean"&&yt(s,l,c)&&(l=c=t),c===t&&(typeof l=="boolean"?(c=l,l=t):typeof s=="boolean"&&(c=s,s=t)),s===t&&l===t?(s=0,l=1):(s=Mn(s),l===t?(l=s,s=0):l=Mn(l)),s>l){var h=s;s=l,l=h}if(c||s%1||l%1){var g=yc();return ut(s+g*(l-s+mg("1e-"+((g+"").length-1))),l)}return Ml(s,l)}var Fb=Hr(function(s,l,c){return l=l.toLowerCase(),s+(c?Yf(l):l)});function Yf(s){return Ql(Oe(s).toLowerCase())}function jf(s){return s=Oe(s),s&&s.replace(Vm,Og).replace(sg,"")}function $b(s,l,c){s=Oe(s),l=Lt(l);var h=s.length;c=c===t?h:dr(de(c),0,h);var g=c;return c-=l.length,c>=0&&s.slice(c,g)==l}function Vb(s){return s=Oe(s),s&&wm.test(s)?s.replace(Mu,Ag):s}function zb(s){return s=Oe(s),s&&Mm.test(s)?s.replace(Go,"\\$&"):s}var Wb=Hr(function(s,l,c){return s+(c?"-":"")+l.toLowerCase()}),qb=Hr(function(s,l,c){return s+(c?" ":"")+l.toLowerCase()}),Hb=Zc("toLowerCase");function Ub(s,l,c){s=Oe(s),l=de(l);var h=l?Br(s):0;if(!l||h>=l)return s;var g=(l-h)/2;return Ls(ks(g),c)+s+Ls(_s(g),c)}function Jb(s,l,c){s=Oe(s),l=de(l);var h=l?Br(s):0;return l&&h<l?s+Ls(l-h,c):s}function Kb(s,l,c){s=Oe(s),l=de(l);var h=l?Br(s):0;return l&&h<l?Ls(l-h,c)+s:s}function Gb(s,l,c){return c||l==null?l=0:l&&(l=+l),ty(Oe(s).replace(Yo,""),l||0)}function Yb(s,l,c){return(c?yt(s,l,c):l===t)?l=1:l=de(l),Tl(Oe(s),l)}function jb(){var s=arguments,l=Oe(s[0]);return s.length<3?l:l.replace(s[1],s[2])}var Xb=Hr(function(s,l,c){return s+(c?"_":"")+l.toLowerCase()});function Zb(s,l,c){return c&&typeof c!="number"&&yt(s,l,c)&&(l=c=t),c=c===t?V:c>>>0,c?(s=Oe(s),s&&(typeof l=="string"||l!=null&&!jl(l))&&(l=Lt(l),!l&&Lr(s))?zn(nn(s),0,c):s.split(l,c)):[]}var Qb=Hr(function(s,l,c){return s+(c?" ":"")+Ql(l)});function ew(s,l,c){return s=Oe(s),c=c==null?0:dr(de(c),0,s.length),l=Lt(l),s.slice(c,c+l.length)==l}function tw(s,l,c){var h=w.templateSettings;c&&yt(s,l,c)&&(l=t),s=Oe(s),l=Gs({},l,h,of);var g=Gs({},l.imports,h.imports,of),_=je(g),k=cl(g,_),C,T,I=0,R=l.interpolate||ls,B="__p += '",q=dl((l.escape||ls).source+"|"+R.source+"|"+(R===Tu?Rm:ls).source+"|"+(l.evaluate||ls).source+"|$","g"),Q="//# sourceURL="+(Ee.call(l,"sourceURL")?(l.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++cg+"]")+`
`;s.replace(q,function(le,be,_e,Ft,vt,$t){return _e||(_e=Ft),B+=s.slice(I,$t).replace(zm,Eg),be&&(C=!0,B+=`' +
__e(`+be+`) +
'`),vt&&(T=!0,B+=`';
`+vt+`;
__p += '`),_e&&(B+=`' +
((__t = (`+_e+`)) == null ? '' : __t) +
'`),I=$t+le.length,le}),B+=`';
`;var oe=Ee.call(l,"variable")&&l.variable;if(!oe)B=`with (obj) {
`+B+`
}
`;else if(Nm.test(oe))throw new ce(u);B=(T?B.replace(gm,""):B).replace(ym,"$1").replace(vm,"$1;"),B="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(C?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+B+`return __p
}`;var pe=Zf(function(){return Ce(_,Q+"return "+B).apply(t,k)});if(pe.source=B,Yl(pe))throw pe;return pe}function nw(s){return Oe(s).toLowerCase()}function rw(s){return Oe(s).toUpperCase()}function iw(s,l,c){if(s=Oe(s),s&&(c||l===t))return oc(s);if(!s||!(l=Lt(l)))return s;var h=nn(s),g=nn(l),_=lc(h,g),k=ac(h,g)+1;return zn(h,_,k).join("")}function sw(s,l,c){if(s=Oe(s),s&&(c||l===t))return s.slice(0,cc(s)+1);if(!s||!(l=Lt(l)))return s;var h=nn(s),g=ac(h,nn(l))+1;return zn(h,0,g).join("")}function ow(s,l,c){if(s=Oe(s),s&&(c||l===t))return s.replace(Yo,"");if(!s||!(l=Lt(l)))return s;var h=nn(s),g=lc(h,nn(l));return zn(h,g).join("")}function lw(s,l){var c=ke,h=He;if($e(l)){var g="separator"in l?l.separator:g;c="length"in l?de(l.length):c,h="omission"in l?Lt(l.omission):h}s=Oe(s);var _=s.length;if(Lr(s)){var k=nn(s);_=k.length}if(c>=_)return s;var C=c-Br(h);if(C<1)return h;var T=k?zn(k,0,C).join(""):s.slice(0,C);if(g===t)return T+h;if(k&&(C+=T.length-C),jl(g)){if(s.slice(C).search(g)){var I,R=T;for(g.global||(g=dl(g.source,Oe(Ou.exec(g))+"g")),g.lastIndex=0;I=g.exec(R);)var B=I.index;T=T.slice(0,B===t?C:B)}}else if(s.indexOf(Lt(g),C)!=C){var q=T.lastIndexOf(g);q>-1&&(T=T.slice(0,q))}return T+h}function aw(s){return s=Oe(s),s&&bm.test(s)?s.replace(Cu,Bg):s}var uw=Hr(function(s,l,c){return s+(c?" ":"")+l.toUpperCase()}),Ql=Zc("toUpperCase");function Xf(s,l,c){return s=Oe(s),l=c?t:l,l===t?Ng(s)?Vg(s):kg(s):s.match(l)||[]}var Zf=ge(function(s,l){try{return Rt(s,t,l)}catch(c){return Yl(c)?c:new ce(c)}}),cw=kn(function(s,l){return Ht(l,function(c){c=dn(c),xn(s,c,Kl(s[c],s))}),s});function fw(s){var l=s==null?0:s.length,c=se();return s=l?Fe(s,function(h){if(typeof h[1]!="function")throw new Ut(a);return[c(h[0]),h[1]]}):[],ge(function(h){for(var g=-1;++g<l;){var _=s[g];if(Rt(_[0],this,h))return Rt(_[1],this,h)}})}function dw(s){return By(Kt(s,m))}function ea(s){return function(){return s}}function hw(s,l){return s==null||s!==s?l:s}var pw=ef(),mw=ef(!0);function At(s){return s}function ta(s){return Ec(typeof s=="function"?s:Kt(s,m))}function gw(s){return Nc(Kt(s,m))}function yw(s,l){return Ic(s,Kt(l,m))}var vw=ge(function(s,l){return function(c){return Si(c,s,l)}}),bw=ge(function(s,l){return function(c){return Si(s,c,l)}});function na(s,l,c){var h=je(l),g=As(l,h);c==null&&!($e(l)&&(g.length||!h.length))&&(c=l,l=s,s=this,g=As(l,je(l)));var _=!($e(c)&&"chain"in c)||!!c.chain,k=Cn(s);return Ht(g,function(C){var T=l[C];s[C]=T,k&&(s.prototype[C]=function(){var I=this.__chain__;if(_||I){var R=s(this.__wrapped__),B=R.__actions__=Mt(this.__actions__);return B.push({func:T,args:arguments,thisArg:s}),R.__chain__=I,R}return T.apply(s,Pn([this.value()],arguments))})}),s}function ww(){return it._===this&&(it._=Jg),this}function ra(){}function xw(s){return s=de(s),ge(function(l){return Rc(l,s)})}var _w=Rl(Fe),kw=Rl(tc),Sw=Rl(sl);function Qf(s){return zl(s)?ol(dn(s)):e0(s)}function Cw(s){return function(l){return s==null?t:hr(s,l)}}var Mw=nf(),Tw=nf(!0);function ia(){return[]}function sa(){return!1}function Ow(){return{}}function Aw(){return""}function Ew(){return!0}function Dw(s,l){if(s=de(s),s<1||s>J)return[];var c=V,h=ut(s,V);l=se(l),s-=V;for(var g=ul(h,l);++c<s;)l(c);return g}function Nw(s){return fe(s)?Fe(s,dn):Bt(s)?[s]:Mt(bf(Oe(s)))}function Iw(s){var l=++Hg;return Oe(s)+l}var Rw=Ps(function(s,l){return s+l},0),Pw=Pl("ceil"),Lw=Ps(function(s,l){return s/l},1),Bw=Pl("floor");function Fw(s){return s&&s.length?Os(s,At,wl):t}function $w(s,l){return s&&s.length?Os(s,se(l,2),wl):t}function Vw(s){return ic(s,At)}function zw(s,l){return ic(s,se(l,2))}function Ww(s){return s&&s.length?Os(s,At,Sl):t}function qw(s,l){return s&&s.length?Os(s,se(l,2),Sl):t}var Hw=Ps(function(s,l){return s*l},1),Uw=Pl("round"),Jw=Ps(function(s,l){return s-l},0);function Kw(s){return s&&s.length?al(s,At):0}function Gw(s,l){return s&&s.length?al(s,se(l,2)):0}return w.after=gv,w.ary=Ef,w.assign=rb,w.assignIn=Hf,w.assignInWith=Gs,w.assignWith=ib,w.at=sb,w.before=Df,w.bind=Kl,w.bindAll=cw,w.bindKey=Nf,w.castArray=Ov,w.chain=Tf,w.chunk=B0,w.compact=F0,w.concat=$0,w.cond=fw,w.conforms=dw,w.constant=ea,w.countBy=K1,w.create=ob,w.curry=If,w.curryRight=Rf,w.debounce=Pf,w.defaults=lb,w.defaultsDeep=ab,w.defer=yv,w.delay=vv,w.difference=V0,w.differenceBy=z0,w.differenceWith=W0,w.drop=q0,w.dropRight=H0,w.dropRightWhile=U0,w.dropWhile=J0,w.fill=K0,w.filter=Y1,w.flatMap=Z1,w.flatMapDeep=Q1,w.flatMapDepth=ev,w.flatten=kf,w.flattenDeep=G0,w.flattenDepth=Y0,w.flip=bv,w.flow=pw,w.flowRight=mw,w.fromPairs=j0,w.functions=mb,w.functionsIn=gb,w.groupBy=tv,w.initial=Z0,w.intersection=Q0,w.intersectionBy=e1,w.intersectionWith=t1,w.invert=vb,w.invertBy=bb,w.invokeMap=rv,w.iteratee=ta,w.keyBy=iv,w.keys=je,w.keysIn=Ot,w.map=Ws,w.mapKeys=xb,w.mapValues=_b,w.matches=gw,w.matchesProperty=yw,w.memoize=Hs,w.merge=kb,w.mergeWith=Uf,w.method=vw,w.methodOf=bw,w.mixin=na,w.negate=Us,w.nthArg=xw,w.omit=Sb,w.omitBy=Cb,w.once=wv,w.orderBy=sv,w.over=_w,w.overArgs=xv,w.overEvery=kw,w.overSome=Sw,w.partial=Gl,w.partialRight=Lf,w.partition=ov,w.pick=Mb,w.pickBy=Jf,w.property=Qf,w.propertyOf=Cw,w.pull=s1,w.pullAll=Cf,w.pullAllBy=o1,w.pullAllWith=l1,w.pullAt=a1,w.range=Mw,w.rangeRight=Tw,w.rearg=_v,w.reject=uv,w.remove=u1,w.rest=kv,w.reverse=Ul,w.sampleSize=fv,w.set=Ob,w.setWith=Ab,w.shuffle=dv,w.slice=c1,w.sortBy=mv,w.sortedUniq=y1,w.sortedUniqBy=v1,w.split=Zb,w.spread=Sv,w.tail=b1,w.take=w1,w.takeRight=x1,w.takeRightWhile=_1,w.takeWhile=k1,w.tap=F1,w.throttle=Cv,w.thru=zs,w.toArray=zf,w.toPairs=Kf,w.toPairsIn=Gf,w.toPath=Nw,w.toPlainObject=qf,w.transform=Eb,w.unary=Mv,w.union=S1,w.unionBy=C1,w.unionWith=M1,w.uniq=T1,w.uniqBy=O1,w.uniqWith=A1,w.unset=Db,w.unzip=Jl,w.unzipWith=Mf,w.update=Nb,w.updateWith=Ib,w.values=Kr,w.valuesIn=Rb,w.without=E1,w.words=Xf,w.wrap=Tv,w.xor=D1,w.xorBy=N1,w.xorWith=I1,w.zip=R1,w.zipObject=P1,w.zipObjectDeep=L1,w.zipWith=B1,w.entries=Kf,w.entriesIn=Gf,w.extend=Hf,w.extendWith=Gs,na(w,w),w.add=Rw,w.attempt=Zf,w.camelCase=Fb,w.capitalize=Yf,w.ceil=Pw,w.clamp=Pb,w.clone=Av,w.cloneDeep=Dv,w.cloneDeepWith=Nv,w.cloneWith=Ev,w.conformsTo=Iv,w.deburr=jf,w.defaultTo=hw,w.divide=Lw,w.endsWith=$b,w.eq=sn,w.escape=Vb,w.escapeRegExp=zb,w.every=G1,w.find=j1,w.findIndex=xf,w.findKey=ub,w.findLast=X1,w.findLastIndex=_f,w.findLastKey=cb,w.floor=Bw,w.forEach=Of,w.forEachRight=Af,w.forIn=fb,w.forInRight=db,w.forOwn=hb,w.forOwnRight=pb,w.get=Xl,w.gt=Rv,w.gte=Pv,w.has=yb,w.hasIn=Zl,w.head=Sf,w.identity=At,w.includes=nv,w.indexOf=X0,w.inRange=Lb,w.invoke=wb,w.isArguments=gr,w.isArray=fe,w.isArrayBuffer=Lv,w.isArrayLike=Tt,w.isArrayLikeObject=We,w.isBoolean=Bv,w.isBuffer=Wn,w.isDate=Fv,w.isElement=$v,w.isEmpty=Vv,w.isEqual=zv,w.isEqualWith=Wv,w.isError=Yl,w.isFinite=qv,w.isFunction=Cn,w.isInteger=Bf,w.isLength=Js,w.isMap=Ff,w.isMatch=Hv,w.isMatchWith=Uv,w.isNaN=Jv,w.isNative=Kv,w.isNil=Yv,w.isNull=Gv,w.isNumber=$f,w.isObject=$e,w.isObjectLike=Ve,w.isPlainObject=Ei,w.isRegExp=jl,w.isSafeInteger=jv,w.isSet=Vf,w.isString=Ks,w.isSymbol=Bt,w.isTypedArray=Jr,w.isUndefined=Xv,w.isWeakMap=Zv,w.isWeakSet=Qv,w.join=n1,w.kebabCase=Wb,w.last=Yt,w.lastIndexOf=r1,w.lowerCase=qb,w.lowerFirst=Hb,w.lt=eb,w.lte=tb,w.max=Fw,w.maxBy=$w,w.mean=Vw,w.meanBy=zw,w.min=Ww,w.minBy=qw,w.stubArray=ia,w.stubFalse=sa,w.stubObject=Ow,w.stubString=Aw,w.stubTrue=Ew,w.multiply=Hw,w.nth=i1,w.noConflict=ww,w.noop=ra,w.now=qs,w.pad=Ub,w.padEnd=Jb,w.padStart=Kb,w.parseInt=Gb,w.random=Bb,w.reduce=lv,w.reduceRight=av,w.repeat=Yb,w.replace=jb,w.result=Tb,w.round=Uw,w.runInContext=M,w.sample=cv,w.size=hv,w.snakeCase=Xb,w.some=pv,w.sortedIndex=f1,w.sortedIndexBy=d1,w.sortedIndexOf=h1,w.sortedLastIndex=p1,w.sortedLastIndexBy=m1,w.sortedLastIndexOf=g1,w.startCase=Qb,w.startsWith=ew,w.subtract=Jw,w.sum=Kw,w.sumBy=Gw,w.template=tw,w.times=Dw,w.toFinite=Mn,w.toInteger=de,w.toLength=Wf,w.toLower=nw,w.toNumber=jt,w.toSafeInteger=nb,w.toString=Oe,w.toUpper=rw,w.trim=iw,w.trimEnd=sw,w.trimStart=ow,w.truncate=lw,w.unescape=aw,w.uniqueId=Iw,w.upperCase=uw,w.upperFirst=Ql,w.each=Of,w.eachRight=Af,w.first=Sf,na(w,function(){var s={};return cn(w,function(l,c){Ee.call(w.prototype,c)||(s[c]=l)}),s}(),{chain:!1}),w.VERSION=n,Ht(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){w[s].placeholder=w}),Ht(["drop","take"],function(s,l){we.prototype[s]=function(c){c=c===t?1:Ge(de(c),0);var h=this.__filtered__&&!l?new we(this):this.clone();return h.__filtered__?h.__takeCount__=ut(c,h.__takeCount__):h.__views__.push({size:ut(c,V),type:s+(h.__dir__<0?"Right":"")}),h},we.prototype[s+"Right"]=function(c){return this.reverse()[s](c).reverse()}}),Ht(["filter","map","takeWhile"],function(s,l){var c=l+1,h=c==Wt||c==W;we.prototype[s]=function(g){var _=this.clone();return _.__iteratees__.push({iteratee:se(g,3),type:c}),_.__filtered__=_.__filtered__||h,_}}),Ht(["head","last"],function(s,l){var c="take"+(l?"Right":"");we.prototype[s]=function(){return this[c](1).value()[0]}}),Ht(["initial","tail"],function(s,l){var c="drop"+(l?"":"Right");we.prototype[s]=function(){return this.__filtered__?new we(this):this[c](1)}}),we.prototype.compact=function(){return this.filter(At)},we.prototype.find=function(s){return this.filter(s).head()},we.prototype.findLast=function(s){return this.reverse().find(s)},we.prototype.invokeMap=ge(function(s,l){return typeof s=="function"?new we(this):this.map(function(c){return Si(c,s,l)})}),we.prototype.reject=function(s){return this.filter(Us(se(s)))},we.prototype.slice=function(s,l){s=de(s);var c=this;return c.__filtered__&&(s>0||l<0)?new we(c):(s<0?c=c.takeRight(-s):s&&(c=c.drop(s)),l!==t&&(l=de(l),c=l<0?c.dropRight(-l):c.take(l-s)),c)},we.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},we.prototype.toArray=function(){return this.take(V)},cn(we.prototype,function(s,l){var c=/^(?:filter|find|map|reject)|While$/.test(l),h=/^(?:head|last)$/.test(l),g=w[h?"take"+(l=="last"?"Right":""):l],_=h||/^find/.test(l);g&&(w.prototype[l]=function(){var k=this.__wrapped__,C=h?[1]:arguments,T=k instanceof we,I=C[0],R=T||fe(k),B=function(be){var _e=g.apply(w,Pn([be],C));return h&&q?_e[0]:_e};R&&c&&typeof I=="function"&&I.length!=1&&(T=R=!1);var q=this.__chain__,Q=!!this.__actions__.length,oe=_&&!q,pe=T&&!Q;if(!_&&R){k=pe?k:new we(this);var le=s.apply(k,C);return le.__actions__.push({func:zs,args:[B],thisArg:t}),new Jt(le,q)}return oe&&pe?s.apply(this,C):(le=this.thru(B),oe?h?le.value()[0]:le.value():le)})}),Ht(["pop","push","shift","sort","splice","unshift"],function(s){var l=hs[s],c=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",h=/^(?:pop|shift)$/.test(s);w.prototype[s]=function(){var g=arguments;if(h&&!this.__chain__){var _=this.value();return l.apply(fe(_)?_:[],g)}return this[c](function(k){return l.apply(fe(k)?k:[],g)})}}),cn(we.prototype,function(s,l){var c=w[l];if(c){var h=c.name+"";Ee.call(zr,h)||(zr[h]=[]),zr[h].push({name:l,func:c})}}),zr[Rs(t,E).name]=[{name:"wrapper",func:t}],we.prototype.clone=ay,we.prototype.reverse=uy,we.prototype.value=cy,w.prototype.at=$1,w.prototype.chain=V1,w.prototype.commit=z1,w.prototype.next=W1,w.prototype.plant=H1,w.prototype.reverse=U1,w.prototype.toJSON=w.prototype.valueOf=w.prototype.value=J1,w.prototype.first=w.prototype.head,yi&&(w.prototype[yi]=q1),w},Fr=zg();ar?((ar.exports=Fr)._=Fr,tl._=Fr):it._=Fr}).call(Di)})(_o,_o.exports);var lA=_o.exports;const aA={class:"text-white"},uA={key:0,class:"text-white mb-0"},cA=D("a",{href:"#",class:"text-white"},[D("u",null,'"Before you create a course"')],-1),fA={class:"text-center"},dA=D("option",{value:""},"Select a draft",-1),hA=["value"],pA=D("div",{class:"bs-stepper-header",role:"tablist"},[D("div",{class:"step","data-target":"#step-1"},[D("div",{class:"d-grid text-center align-items-center"},[D("button",{type:"button",class:"btn btn-link step-trigger mb-0",role:"tab",id:"steppertrigger1","aria-controls":"step-1"},[D("span",{class:"bs-stepper-circle"},"1")]),D("h6",{class:"bs-stepper-label d-none d-md-block"},"Course Details")])]),D("div",{class:"line"}),D("div",{class:"step","data-target":"#step-2"},[D("div",{class:"d-grid text-center align-items-center"},[D("button",{type:"button",class:"btn btn-link step-trigger mb-0",role:"tab",id:"steppertrigger2","aria-controls":"step-2"},[D("span",{class:"bs-stepper-circle"},"2")]),D("h6",{class:"bs-stepper-label d-none d-md-block"},"Course Media")])]),D("div",{class:"line"}),D("div",{class:"step","data-target":"#step-3"},[D("div",{class:"d-grid text-center align-items-center"},[D("button",{type:"button",class:"btn btn-link step-trigger mb-0",role:"tab",id:"steppertrigger3","aria-controls":"step-3"},[D("span",{class:"bs-stepper-circle"},"3")]),D("h6",{class:"bs-stepper-label d-none d-md-block"},"Curriculum")])]),D("div",{class:"line"}),D("div",{class:"step","data-target":"#step-4"},[D("div",{class:"d-grid text-center align-items-center"},[D("button",{type:"button",class:"btn btn-link step-trigger mb-0",role:"tab",id:"steppertrigger4","aria-controls":"step-4"},[D("span",{class:"bs-stepper-circle"},"4")]),D("h6",{class:"bs-stepper-label d-none d-md-block"},"Additional Information")])])],-1),mA={class:"bs-stepper-content"},WA=ci({__name:"index",setup(r){const e=Co.useToast(),t=xh(),n=lx(),i=Pe(null),o=Pe(null),a=Pe(0),u=Pe(!1),f=Pe([]),d=Pe(""),p=Pe(null),m=Pe(null),y=Pe(null),v=nd(()=>!!n.params.slug),x=nd(()=>n.params.slug),b=Pe({title:"",short_description:"",category:"",level:"",languages:[],is_featured:!1,course_time:"",total_lecture:"",price:null,discount_price:null,enable_discount:!1,description:"",cover:null,video_url:"",video_file:null,modules:[],faqs:[],tags:[],reviewer_message:"",assets_licensed:!1}),S=Pe({title:"",short_description:"",category:"",level:"",languages:"",is_featured:"",course_time:"",total_lecture:"",price:"",discount_price:"",enable_discount:"",description:"",cover:"",video_url:"",video_file:"",modules:[],faqs:[],tags:"",reviewer_message:"",assets_licensed:""}),E=lA.debounce(()=>{const W=JSON.parse(JSON.stringify(b.value));W.cover=null,W.video_file=null,W.modules.forEach(ne=>{ne.videos.forEach(J=>{delete J.id,delete J.tempId})}),localStorage.setItem("courseFormData",JSON.stringify(W)),localStorage.setItem("courseFormStep",a.value.toString())},300),Z=()=>{const W=localStorage.getItem("courseFormData"),ne=localStorage.getItem("courseFormStep");if(W){const J=JSON.parse(W);J.cover=null,J.video_file=null,b.value={...b.value,...J,category:J.category??"",level:J.level??"",languages:J.languages??[]}}ne&&(a.value=parseInt(ne),o.value&&a.value>=0&&a.value<=3&&o.value.to(a.value+1))},te=()=>{localStorage.removeItem("courseFormData"),localStorage.removeItem("courseFormStep")},ve=W=>{b.value={...b.value,...W},E()},ue=W=>{b.value.cover=W,E()};ax(async()=>{if(i.value)try{o.value=new xx(i.value,{linear:!1,animation:!0}),i.value.addEventListener("show.bs.stepper",W=>{a.value=W.detail.indexStep,E()})}catch(W){console.error("Failed to initialize stepper:",W),e.error("Failed to initialize form stepper")}v.value?await G(x.value):(Z(),await K())});const K=async()=>{try{const W=await Me.get("/course/courses/drafts/");f.value=W.data,console.log("Drafts fetched:",W.data)}catch(W){console.error("Error fetching drafts:",W),e.error("Failed to fetch drafts")}},G=async W=>{var ne,J,xe,F,V;try{const L=(await Me.get(`course/courses/${W}/`)).data;console.log("Course data received:",L);const z=L.description||"",H=z.match(/Short Description: (.*?)(?=\n\n|$)/),me=z.match(/Category: (.*?)(?=\n\n|$)/),Ae=z.match(/Level: (.*?)(?=\n\n|$)/),rt=z.match(/Languages: (.*?)(?=\n\n|$)/),In=z.match(/Course Time: (.*?)(?=\n\n|$)/),rs=z.match(/Total Lectures: (.*?)(?=\n\n|$)/),lr=z.match(/Reviewer Message: (.*?)(?=\n\n|$)/);b.value={title:L.title||"",short_description:H?H[1]:"",category:me?me[1]:"",level:Ae?Ae[1]:"",languages:rt?rt[1].split(", ").filter(Je=>Je):[],is_featured:L.is_featured||!1,course_time:In?In[1]:"",total_lecture:rs?rs[1]:"",price:parseFloat(L.final_price)||null,discount_price:L.discount_percentage?Number((parseFloat(L.final_price)*(1-parseFloat(L.discount_percentage)/100)).toFixed(2)):null,enable_discount:!!L.discount_percentage,description:z.split(`

`).filter(Je=>!Je.match(/^(Short Description|Category|Level|Languages|Course Time|Total Lectures|Reviewer Message):/)).join(`

`),cover:null,video_url:"",video_file:null,modules:((ne=L.modules)==null?void 0:ne.map((Je,is)=>{var Ct;return{id:Je.id,title:Je.title||"",order:Je.order||is+1,description:Je.description||"",videos:((Ct=Je.videos)==null?void 0:Ct.map(un=>({id:un.id,tempId:`temp-video-${Date.now()}-${un.id}`,title:un.title,video_url:un.video_url,description:"",is_free:!0})))||[]}}))||[],faqs:((J=L.faqs)==null?void 0:J.map(Je=>({question:Je.question||"",answer:Je.answer||""})))||[],tags:((xe=L.tags)==null?void 0:xe.map(Je=>Je.tag))||[],reviewer_message:lr?lr[1]:"",assets_licensed:!1},p.value=L.id,m.value=L.slug,y.value=L.id,E(),e.success("Course loaded for editing")}catch(ie){console.error("Error loading course:",{message:ie.message,response:(F=ie.response)==null?void 0:F.data,status:(V=ie.response)==null?void 0:V.status}),e.error("Failed to load course for editing"),t.push({name:"instructor.courses"})}},ee=async()=>{if(!d.value){mt(),p.value=null,m.value=null;return}await G(d.value)},j=()=>{if(He(a.value,!1))try{o.value&&a.value<3&&(o.value.next(),a.value+=1,E())}catch(W){console.error("Error navigating to next step:",W),e.error("Failed to navigate to the next step")}},ke=()=>{try{o.value&&a.value>0&&(o.value.previous(),a.value-=1,E())}catch(W){console.error("Error navigating to previous step:",W),e.error("Failed to navigate to the previous step")}},He=(W,ne=!0)=>{u.value=!0;let J=!0;return S.value={title:"",short_description:"",category:"",level:"",languages:"",is_featured:"",course_time:"",total_lecture:"",price:"",discount_price:"",enable_discount:"",description:"",cover:"",video_url:"",video_file:"",modules:[],faqs:[],tags:"",reviewer_message:"",assets_licensed:""},W===0&&ne?(b.value.title||(S.value.title="Course title is required",J=!1),b.value.description||(S.value.description="Description is required",J=!1),(b.value.price===null||b.value.price<=0)&&(S.value.price="Valid price is required",J=!1),b.value.enable_discount&&(!b.value.discount_price||b.value.discount_price>=b.value.price)&&(S.value.discount_price="Discount price must be less than the original price",J=!1)):W===1&&ne&&!v.value?b.value.cover||(S.value.cover="Course image is required",J=!1):W===2&&ne?(b.value.modules.forEach((xe,F)=>{let V={title:"",order:"",description:"",videos:[]};xe.title||(V.title="Module title is required",J=!1),xe.order<1&&(V.order="Order must be positive",J=!1),xe.description||(V.description="Module description is required",J=!1),xe.videos.forEach((ie,L)=>{let z={title:"",video_url:""};ie.title||(z.title="Video title is required",J=!1),ie.video_url||(z.video_url="Video URL is required",J=!1),V.videos[L]=z}),S.value.modules[F]=V}),b.value.modules.length||(S.value.modules.push({title:"At least one module is required",order:"",description:"",videos:[]}),J=!1)):W===3&&ne&&(b.value.faqs.forEach((xe,F)=>{let V={question:"",answer:""};xe.question||(V.question="Question is required",J=!1),xe.answer||(V.answer="Answer is required",J=!1),S.value.faqs[F]=V}),b.value.assets_licensed||(S.value.assets_licensed="You must confirm that assets are licensed",J=!1)),!J&&ne&&e.error("Please fill in all required fields"),J},nt=async()=>{var J,xe;if(u.value=!0,!b.value.title){e.error("Please provide a title before saving as draft");return}const W=new FormData;W.append("title",b.value.title);const ne=[b.value.description];if(b.value.short_description&&ne.push(`Short Description: ${b.value.short_description}`),b.value.category&&ne.push(`Category: ${b.value.category}`),b.value.level&&ne.push(`Level: ${b.value.level}`),b.value.languages.length&&ne.push(`Languages: ${b.value.languages.join(", ")}`),b.value.course_time&&ne.push(`Course Time: ${b.value.course_time}`),b.value.total_lecture&&ne.push(`Total Lectures: ${b.value.total_lecture}`),b.value.reviewer_message&&ne.push(`Reviewer Message: ${b.value.reviewer_message}`),W.append("description",ne.join(`

`)),b.value.price!==null&&b.value.price>0&&W.append("final_price",b.value.price.toFixed(2)),b.value.cover&&W.append("cover",b.value.cover),b.value.enable_discount&&b.value.discount_price&&b.value.price){const F=((b.value.price-b.value.discount_price)/b.value.price*100).toFixed(2);W.append("discount_percentage",F),W.append("discount_deadline",new Date(Date.now()+30*24*60*60*1e3).toISOString())}W.append("is_featured",b.value.is_featured.toString()),b.value.faqs.length&&W.append("faqs",JSON.stringify(b.value.faqs)),b.value.tags.length&&W.append("tags",JSON.stringify(b.value.tags.map(F=>({tag:F})))),W.append("ispublished","false");try{console.log("Saving draft with payload:",[...W.entries()]);let F;if(p.value&&m.value?F=await Me.put(`course/courses/${m.value}/`,W,{headers:{"Content-Type":"multipart/form-data"}}):(F=await Me.post("course/courses/",W,{headers:{"Content-Type":"multipart/form-data"}}),p.value=F.data.id,m.value=F.data.slug,y.value=F.data.id),console.log("Draft save response:",F.data),b.value.modules.length){const V=b.value.modules.filter(L=>!L.id),ie=b.value.modules.filter(L=>L.id);if(V.length){const L={course:F.data.id,modules:V.map(H=>({title:H.title,description:H.description,order:H.order}))};console.log("New module payload:",L);const z=await Me.post("modules/bulk_create/",L);console.log("New module creation response:",z.data),z.data.forEach((H,me)=>{V[me].id=H.id})}for(const L of ie){const z={title:L.title,description:L.description,order:L.order};await Me.put(`modules/${L.id}/`,z)}for(const L of b.value.modules)if(L.id)for(const z of L.videos){const H={module:L.id,title:z.title,video_url:z.video_url};if(z.id)await Me.put(`videos/${z.id}/`,H);else{const me=await Me.post("videos/",H);z.id=me.data.id}}}if(b.value.video_url){const V=b.value.modules[0]||{id:null,title:"Default Module",order:1,description:"Default module for video",videos:[]};if(!V.id){const z={course:F.data.id,modules:[{title:V.title,order:V.order,description:V.description}]},H=await Me.post("modules/bulk_create/",z);V.id=H.data[0].id,b.value.modules.push(V)}const ie={module:V.id,title:"Course Intro Video",video_url:b.value.video_url},L=await Me.post("videos/",ie);console.log("Video creation response:",L.data)}if(b.value.video_file){const V=b.value.modules[0]||{id:null,title:"Default Module",order:1,description:"Default module for video",videos:[]};if(!V.id){const z={course:F.data.id,modules:[{title:V.title,order:V.order,description:V.description}]},H=await Me.post("modules/bulk_create/",z);V.id=H.data[0].id,b.value.modules.push(V)}const ie=new FormData;ie.append("module",V.id.toString()),ie.append("title","Course Video"),ie.append("document_file",b.value.video_file);const L=await Me.post("documents/",ie,{headers:{"Content-Type":"multipart/form-data"}});console.log("Document creation response:",L.data)}e.success("Draft saved successfully!"),await K(),v.value||mt()}catch(F){console.error("Error saving draft:",{message:F.message,response:(J=F.response)==null?void 0:J.data,status:(xe=F.response)==null?void 0:xe.status});let V="Failed to save draft";if(F.response&&F.response.data){const ie=F.response.data;for(const[L,z]of Object.entries(ie))L==="faqs"?S.value.faqs=z.map(H=>{var me,Ae;return{question:((me=H.question)==null?void 0:me[0])||"",answer:((Ae=H.answer)==null?void 0:Ae[0])||""}}):L==="tags"?S.value.tags=Array.isArray(z)?z[0]:z:L==="modules"?S.value.modules=z.map(H=>{var me,Ae,rt;return{title:((me=H.title)==null?void 0:me[0])||"",order:((Ae=H.order)==null?void 0:Ae[0])||"",description:((rt=H.description)==null?void 0:rt[0])||"",videos:[]}}):L in S.value&&(S.value[L]=Array.isArray(z)?z[0]:z,V+=`: ${L} - ${Array.isArray(z)?z[0]:z}`)}e.error(V)}},St=async()=>{var J,xe;if(u.value=!0,!He(3,!0))return;const W=new FormData;W.append("title",b.value.title);const ne=[b.value.description];if(b.value.short_description&&ne.push(`Short Description: ${b.value.short_description}`),b.value.category&&ne.push(`Category: ${b.value.category}`),b.value.level&&ne.push(`Level: ${b.value.level}`),b.value.languages.length&&ne.push(`Languages: ${b.value.languages.join(", ")}`),b.value.course_time&&ne.push(`Course Time: ${b.value.course_time}`),b.value.total_lecture&&ne.push(`Total Lectures: ${b.value.total_lecture}`),b.value.reviewer_message&&ne.push(`Reviewer Message: ${b.value.reviewer_message}`),W.append("description",ne.join(`

`)),b.value.price!==null&&b.value.price>0&&W.append("final_price",b.value.price.toFixed(2)),b.value.cover&&W.append("cover",b.value.cover),b.value.enable_discount&&b.value.discount_price&&b.value.price){const F=((b.value.price-b.value.discount_price)/b.value.price*100).toFixed(2);W.append("discount_percentage",F),W.append("discount_deadline",new Date(Date.now()+30*24*60*60*1e3).toISOString())}W.append("is_featured",b.value.is_featured.toString()),b.value.faqs.length&&W.append("faqs",JSON.stringify(b.value.faqs)),b.value.tags.length&&W.append("tags",JSON.stringify(b.value.tags.map(F=>({tag:F})))),W.append("ispublished","true");try{console.log("Publishing course with payload:",[...W.entries()]);let F;if(p.value&&m.value?F=await Me.put(`course/courses/${m.value}/`,W,{headers:{"Content-Type":"multipart/form-data"}}):F=await Me.post("course/courses/",W,{headers:{"Content-Type":"multipart/form-data"}}),console.log("Publish response:",F.data),b.value.modules.length){const V=b.value.modules.filter(L=>!L.id),ie=b.value.modules.filter(L=>L.id);if(V.length){const L={course:F.data.id,modules:V.map(H=>({title:H.title,description:H.description,order:H.order}))};console.log("New module payload:",L);const z=await Me.post("modules/bulk_create/",L);console.log("New module creation response:",z.data),z.data.forEach((H,me)=>{V[me].id=H.id})}for(const L of ie){const z={title:L.title,description:L.description,order:L.order};await Me.put(`modules/${L.id}/`,z)}for(const L of b.value.modules)if(L.id)for(const z of L.videos){const H={module:L.id,title:z.title,video_url:z.video_url};if(z.id)await Me.put(`videos/${z.id}/`,H);else{const me=await Me.post("videos/",H);z.id=me.data.id}}}if(b.value.video_url){const V=b.value.modules[0]||{id:null,title:"Default Module",order:1,description:"Default module for video",videos:[]};if(!V.id){const z={course:F.data.id,modules:[{title:V.title,order:V.order,description:V.description}]},H=await Me.post("modules/bulk_create/",z);V.id=H.data[0].id,b.value.modules.push(V)}const ie={module:V.id,title:"Course Intro Video",video_url:b.value.video_url},L=await Me.post("videos/",ie);console.log("Video creation response:",L.data)}if(b.value.video_file){const V=b.value.modules[0]||{id:null,title:"Default Module",order:1,description:"Default module for video",videos:[]};if(!V.id){const z={course:F.data.id,modules:[{title:V.title,order:V.order,description:V.description}]},H=await Me.post("modules/bulk_create/",z);V.id=H.data[0].id,b.value.modules.push(V)}const ie=new FormData;ie.append("module",V.id.toString()),ie.append("title","Course Video"),ie.append("document_file",b.value.video_file);const L=await Me.post("documents/",ie,{headers:{"Content-Type":"multipart/form-data"}});console.log("Document creation response:",L.data)}e.success("Course published successfully!"),te(),t.push({name:"instructor.course.added"}),mt()}catch(F){console.error("Error publishing course:",{message:F.message,response:(J=F.response)==null?void 0:J.data,status:(xe=F.response)==null?void 0:xe.status});let V="Failed to publish course";if(F.response&&F.response.data){const ie=F.response.data;for(const[L,z]of Object.entries(ie))L==="faqs"?S.value.faqs=z.map(H=>{var me,Ae;return{question:((me=H.question)==null?void 0:me[0])||"",answer:((Ae=H.answer)==null?void 0:Ae[0])||""}}):L==="tags"?S.value.tags=Array.isArray(z)?z[0]:z:L==="modules"?S.value.modules=z.map(H=>{var me,Ae,rt;return{title:((me=H.title)==null?void 0:me[0])||"",order:((Ae=H.order)==null?void 0:Ae[0])||"",description:((rt=H.description)==null?void 0:rt[0])||"",videos:[]}}):L in S.value&&(S.value[L]=Array.isArray(z)?z[0]:z,V+=`: ${L} - ${Array.isArray(z)?z[0]:z}`)}e.error(V)}},Wt=async()=>{var J,xe;if(u.value=!0,!He(3,!0))return;const W=new FormData;W.append("title",b.value.title);const ne=[b.value.description];if(b.value.short_description&&ne.push(`Short Description: ${b.value.short_description}`),b.value.category&&ne.push(`Category: ${b.value.category}`),b.value.level&&ne.push(`Level: ${b.value.level}`),b.value.languages.length&&ne.push(`Languages: ${b.value.languages.join(", ")}`),b.value.course_time&&ne.push(`Course Time: ${b.value.course_time}`),b.value.total_lecture&&ne.push(`Total Lectures: ${b.value.total_lecture}`),b.value.reviewer_message&&ne.push(`Reviewer Message: ${b.value.reviewer_message}`),W.append("description",ne.join(`

`)),b.value.price!==null&&b.value.price>0&&W.append("final_price",b.value.price.toFixed(2)),b.value.cover&&W.append("cover",b.value.cover),b.value.enable_discount&&b.value.discount_price&&b.value.price){const F=((b.value.price-b.value.discount_price)/b.value.price*100).toFixed(2);W.append("discount_percentage",F),W.append("discount_deadline",new Date(Date.now()+30*24*60*60*1e3).toISOString())}W.append("is_featured",b.value.is_featured.toString()),b.value.faqs.length&&W.append("faqs",JSON.stringify(b.value.faqs)),b.value.tags.length&&W.append("tags",JSON.stringify(b.value.tags.map(F=>({tag:F})))),W.append("ispublished",b.value.ispublished?"true":"false");try{console.log("Updating course with payload:",[...W.entries()]);const F=await Me.put(`course/courses/${x.value}/`,W,{headers:{"Content-Type":"multipart/form-data"}});if(console.log("Update response:",F.data),b.value.modules.length){const V=b.value.modules.filter(L=>!L.id),ie=b.value.modules.filter(L=>L.id);if(V.length){const L={course:F.data.id,modules:V.map(H=>({title:H.title,description:H.description,order:H.order}))};console.log("New module payload:",L);const z=await Me.post("modules/bulk_create/",L);console.log("New module creation response:",z.data),z.data.forEach((H,me)=>{V[me].id=H.id})}for(const L of ie){const z={title:L.title,description:L.description,order:L.order};await Me.put(`modules/${L.id}/`,z)}for(const L of b.value.modules)if(L.id)for(const z of L.videos){const H={module:L.id,title:z.title,video_url:z.video_url};if(z.id)await Me.put(`videos/${z.id}/`,H);else{const me=await Me.post("videos/",H);z.id=me.data.id}}}if(b.value.video_url){const V=b.value.modules[0]||{id:null,title:"Default Module",order:1,description:"Default module for video",videos:[]};if(!V.id){const z={course:F.data.id,modules:[{title:V.title,order:V.order,description:V.description}]},H=await Me.post("modules/bulk_create/",z);V.id=H.data[0].id,b.value.modules.push(V)}const ie={module:V.id,title:"Course Intro Video",video_url:b.value.video_url},L=await Me.post("videos/",ie);console.log("Video creation response:",L.data)}if(b.value.video_file){const V=b.value.modules[0]||{id:null,title:"Default Module",order:1,description:"Default module for video",videos:[]};if(!V.id){const z={course:F.data.id,modules:[{title:V.title,order:V.order,description:V.description}]},H=await Me.post("modules/bulk_create/",z);V.id=H.data[0].id,b.value.modules.push(V)}const ie=new FormData;ie.append("module",V.id.toString()),ie.append("title","Course Video"),ie.append("document_file",b.value.video_file);const L=await Me.post("documents/",ie,{headers:{"Content-Type":"multipart/form-data"}});console.log("Document creation response:",L.data)}e.success("Course updated successfully!"),te(),t.push({name:"instructor.courses"}),mt()}catch(F){console.error("Error updating course:",{message:F.message,response:(J=F.response)==null?void 0:J.data,status:(xe=F.response)==null?void 0:xe.status});let V="Failed to update course";if(F.response&&F.response.data){const ie=F.response.data;for(const[L,z]of Object.entries(ie))L==="faqs"?S.value.faqs=z.map(H=>{var me,Ae;return{question:((me=H.question)==null?void 0:me[0])||"",answer:((Ae=H.answer)==null?void 0:Ae[0])||""}}):L==="tags"?S.value.tags=Array.isArray(z)?z[0]:z:L==="modules"?S.value.modules=z.map(H=>{var me,Ae,rt;return{title:((me=H.title)==null?void 0:me[0])||"",order:((Ae=H.order)==null?void 0:Ae[0])||"",description:((rt=H.description)==null?void 0:rt[0])||"",videos:[]}}):L in S.value&&(S.value[L]=Array.isArray(z)?z[0]:z,V+=`: ${L} - ${Array.isArray(z)?z[0]:z}`)}e.error(V)}},mt=()=>{if(b.value={title:"",short_description:"",category:"",level:"",languages:[],is_featured:!1,course_time:"",total_lecture:"",price:null,discount_price:null,enable_discount:!1,description:"",cover:null,video_url:"",video_file:null,modules:[],faqs:[],tags:[],reviewer_message:"",assets_licensed:!1},u.value=!1,p.value=null,m.value=null,d.value="",y.value=null,S.value={title:"",short_description:"",category:"",level:"",languages:"",is_featured:"",course_time:"",total_lecture:"",price:"",discount_price:"",enable_discount:"",description:"",cover:"",video_url:"",video_file:"",modules:[],faqs:[],tags:"",reviewer_message:"",assets_licensed:""},a.value=0,te(),o.value)try{o.value.to(1)}catch(W){console.error("Error resetting stepper:",W)}};return(W,ne)=>{const J=Qi,xe=Zi,F=cx,V=dx,ie=Xi,L=hx,z=Za,H=px,me=fx;return Te(),ri(gx,null,{default:P(()=>[D("main",null,[D("section",{class:"py-0 bg-blue h-100px align-items-center d-flex h-200px rounded-0",style:ux(`background:url(${Et(wx)}) no-repeat center center; background-size:cover;`)},[A(F,null,{default:P(()=>[A(xe,null,{default:P(()=>[A(J,{cols:"12",class:"text-center"},{default:P(()=>[D("h1",aA,Be(v.value?"Edit Course":"Submit a New Course"),1),v.value?dt("",!0):(Te(),Le("p",uA,[Se("Read our "),cA,Se(" article before submitting!")]))]),_:1})]),_:1})]),_:1})],4),D("section",null,[A(F,null,{default:P(()=>[A(xe,null,{default:P(()=>[A(J,{md:"8",class:"mx-auto text-center"},{default:P(()=>[D("p",fA,Be(v.value?"Update the course details below. Changes will be reviewed before being published.":"Use this interface to add a new Course to the portal. Once you are done adding the item it will be reviewed for quality."),1)]),_:1})]),_:1}),A(me,{"no-body":"",class:"bg-transparent border rounded-3 mb-5"},{default:P(()=>[v.value?dt("",!0):(Te(),ri(xe,{key:0,class:"mb-4"},{default:P(()=>[A(J,{md:"6"},{default:P(()=>[A(ie,{label:"Load Draft"},{default:P(()=>[A(V,{modelValue:d.value,"onUpdate:modelValue":ne[0]||(ne[0]=Ae=>d.value=Ae),onChange:ee},{default:P(()=>[dA,(Te(!0),Le(Vi,null,zi(f.value,Ae=>(Te(),Le("option",{key:Ae.slug,value:Ae.slug},Be(Ae.title||"Untitled Draft"),9,hA))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})),D("div",{id:"stepper",ref_key:"stepperRef",ref:i,class:"bs-stepper stepper-outline"},[A(L,{class:"bg-light border-bottom px-lg-5"},{default:P(()=>[pA]),_:1}),A(H,null,{default:P(()=>[D("div",mA,[A(z,{onSubmit:ne[1]||(ne[1]=mx(Ae=>v.value?Wt:St,["prevent"]))},{default:P(()=>[A(HT,{"form-data":b.value,"next-page":j,errors:S.value,"save-draft":nt},null,8,["form-data","errors"]),A(uO,{"form-data":b.value,"next-page":j,"previous-page":ke,errors:S.value,"save-draft":nt,"onUpdate:cover":ue},null,8,["form-data","errors"]),A(DO,{"form-data":b.value,"next-page":j,"previous-page":ke,errors:S.value,"save-draft":nt,"course-id":y.value,"onUpdate:formData":ve},null,8,["form-data","errors","course-id"]),A(oA,{"form-data":b.value,"previous-page":ke,errors:S.value,"save-draft":nt},null,8,["form-data","errors"])]),_:1})])]),_:1})],512)]),_:1})]),_:1})])])]),_:1})}}});export{WA as default};
